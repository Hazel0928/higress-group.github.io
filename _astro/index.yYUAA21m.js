import{r as U,g as ki}from"./index.BCx1StL1.js";const at=function(e){return typeof e<"u"&&e!==null},Ri=function(e){return typeof e=="object"},Ii=function(e){return Object.prototype.toString.call(e)==="[object Object]"},ji=function(e){return typeof e=="function"},Ai=function(e){return typeof e=="boolean"},$i=function(e){return e instanceof Buffer},Li=function(e){if(at(e))switch(e.constructor){case Uint8Array:case Uint8ClampedArray:case Int8Array:case Uint16Array:case Int16Array:case Uint32Array:case Int32Array:case Float32Array:case Float64Array:return!0}return!1},Si=function(e){return e instanceof ArrayBuffer},Mi=function(e){return typeof e=="string"&&e.length>0},Ni=function(e){return typeof e=="number"&&!Number.isNaN(e)},Ti=function(e){return Number.isInteger(e)},Ci=function(e,t,i){return e>=t&&e<=i},Bi=function(e,t){return t.includes(e)},_i=function(e,t,i){return new Error(`Expected ${t} for ${e} but received ${i} of type ${typeof i}`)},Fi=function(e,t){return t.message=e.message,t};var W={defined:at,object:Ri,plainObject:Ii,fn:ji,bool:Ai,buffer:$i,typedArray:Li,arrayBuffer:Si,string:Mi,number:Ni,integer:Ti,inRange:Ci,inArray:Bi,invalidParameterError:_i,nativeError:Fi};function ee(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var st={exports:{}};const lt=()=>process.platform==="linux";let ye=null;const Di=()=>{if(!ye)if(lt()&&process.report){const e=process.report.excludeNetwork;process.report.excludeNetwork=!0,ye=process.report.getReport(),process.report.excludeNetwork=e}else ye={};return ye};var zi={isLinux:lt,getReport:Di};const ht=U,qi="/usr/bin/ldd",Gi=e=>ht.readFileSync(e,"utf-8"),Ui=e=>new Promise((t,i)=>{ht.readFile(e,"utf-8",(r,o)=>{r?i(r):t(o)})});var Wi={LDD_PATH:qi,readFileSync:Gi,readFile:Ui};const ct=U,{isLinux:ae,getReport:pt}=zi,{LDD_PATH:xe,readFile:ut,readFileSync:dt}=Wi;let D,z;const ft="getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true";let te="";const gt=()=>te||new Promise(e=>{ct.exec(ft,(t,i)=>{te=t?" ":i,e(te)})}),mt=()=>{if(!te)try{te=ct.execSync(ft,{encoding:"utf8"})}catch{te=" "}return te},Q="glibc",bt=/LIBC[a-z0-9 \-).]*?(\d+\.\d+)/i,se="musl",Hi=e=>e.includes("libc.musl-")||e.includes("ld-musl-"),vt=()=>{const e=pt();return e.header&&e.header.glibcVersionRuntime?Q:Array.isArray(e.sharedObjects)&&e.sharedObjects.some(Hi)?se:null},wt=e=>{const[t,i]=e.split(/[\r\n]+/);return t&&t.includes(Q)?Q:i&&i.includes(se)?se:null},Et=e=>e.includes("musl")?se:e.includes("GNU C Library")?Q:null,Xi=async()=>{if(D!==void 0)return D;D=null;try{const e=await ut(xe);D=Et(e)}catch{}return D},Vi=()=>{if(D!==void 0)return D;D=null;try{const e=dt(xe);D=Et(e)}catch{}return D},yt=async()=>{let e=null;if(ae()&&(e=await Xi(),e||(e=vt()),!e)){const t=await gt();e=wt(t)}return e},xt=()=>{let e=null;if(ae()&&(e=Vi(),e||(e=vt()),!e)){const t=mt();e=wt(t)}return e},Qi=async()=>ae()&&await yt()!==Q,Ji=()=>ae()&&xt()!==Q,Yi=async()=>{if(z!==void 0)return z;z=null;try{const e=(await ut(xe)).match(bt);e&&(z=e[1])}catch{}return z},Ki=()=>{if(z!==void 0)return z;z=null;try{const e=dt(xe).match(bt);e&&(z=e[1])}catch{}return z},Pt=()=>{const e=pt();return e.header&&e.header.glibcVersionRuntime?e.header.glibcVersionRuntime:null},Ot=e=>e.trim().split(/\s+/)[1],kt=e=>{const[t,i,r]=e.split(/[\r\n]+/);return t&&t.includes(Q)?Ot(t):i&&r&&i.includes(se)?Ot(r):null},Zi=async()=>{let e=null;if(ae()&&(e=await Yi(),e||(e=Pt()),!e)){const t=await gt();e=kt(t)}return e},er=()=>{let e=null;if(ae()&&(e=Ki(),e||(e=Pt()),!e)){const t=mt();e=kt(t)}return e};var _e={GLIBC:Q,MUSL:se,family:yt,familySync:xt,isNonGlibcLinux:Qi,isNonGlibcLinuxSync:Ji,version:Zi,versionSync:er},Fe={};const tr=typeof process=="object"&&Fe&&Fe.NODE_DEBUG&&/\bsemver\b/i.test(Fe.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var Pe=tr;const ir="2.0.0",Rt=256,rr=Number.MAX_SAFE_INTEGER||9007199254740991,nr=16,or=Rt-6,ar=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var De={MAX_LENGTH:Rt,MAX_SAFE_COMPONENT_LENGTH:nr,MAX_SAFE_BUILD_LENGTH:or,MAX_SAFE_INTEGER:rr,RELEASE_TYPES:ar,SEMVER_SPEC_VERSION:ir,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},ze={exports:{}};(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:o}=De,a=Pe;t=e.exports={};const l=t.re=[],p=t.safeRe=[],s=t.src=[],u=t.t={};let b=0;const O="[a-zA-Z0-9-]",T=[["\\s",1],["\\d",o],[O,r]],Be=V=>{for(const[_,K]of T)V=V.split(`${_}*`).join(`${_}{0,${K}}`).split(`${_}+`).join(`${_}{1,${K}}`);return V},y=(V,_,K)=>{const M=Be(_),Z=b++;a(V,Z,_),u[V]=Z,s[Z]=_,l[Z]=new RegExp(_,K?"g":void 0),p[Z]=new RegExp(M,K?"g":void 0)};y("NUMERICIDENTIFIER","0|[1-9]\\d*"),y("NUMERICIDENTIFIERLOOSE","\\d+"),y("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${O}*`),y("MAINVERSION",`(${s[u.NUMERICIDENTIFIER]})\\.(${s[u.NUMERICIDENTIFIER]})\\.(${s[u.NUMERICIDENTIFIER]})`),y("MAINVERSIONLOOSE",`(${s[u.NUMERICIDENTIFIERLOOSE]})\\.(${s[u.NUMERICIDENTIFIERLOOSE]})\\.(${s[u.NUMERICIDENTIFIERLOOSE]})`),y("PRERELEASEIDENTIFIER",`(?:${s[u.NUMERICIDENTIFIER]}|${s[u.NONNUMERICIDENTIFIER]})`),y("PRERELEASEIDENTIFIERLOOSE",`(?:${s[u.NUMERICIDENTIFIERLOOSE]}|${s[u.NONNUMERICIDENTIFIER]})`),y("PRERELEASE",`(?:-(${s[u.PRERELEASEIDENTIFIER]}(?:\\.${s[u.PRERELEASEIDENTIFIER]})*))`),y("PRERELEASELOOSE",`(?:-?(${s[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[u.PRERELEASEIDENTIFIERLOOSE]})*))`),y("BUILDIDENTIFIER",`${O}+`),y("BUILD",`(?:\\+(${s[u.BUILDIDENTIFIER]}(?:\\.${s[u.BUILDIDENTIFIER]})*))`),y("FULLPLAIN",`v?${s[u.MAINVERSION]}${s[u.PRERELEASE]}?${s[u.BUILD]}?`),y("FULL",`^${s[u.FULLPLAIN]}$`),y("LOOSEPLAIN",`[v=\\s]*${s[u.MAINVERSIONLOOSE]}${s[u.PRERELEASELOOSE]}?${s[u.BUILD]}?`),y("LOOSE",`^${s[u.LOOSEPLAIN]}$`),y("GTLT","((?:<|>)?=?)"),y("XRANGEIDENTIFIERLOOSE",`${s[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),y("XRANGEIDENTIFIER",`${s[u.NUMERICIDENTIFIER]}|x|X|\\*`),y("XRANGEPLAIN",`[v=\\s]*(${s[u.XRANGEIDENTIFIER]})(?:\\.(${s[u.XRANGEIDENTIFIER]})(?:\\.(${s[u.XRANGEIDENTIFIER]})(?:${s[u.PRERELEASE]})?${s[u.BUILD]}?)?)?`),y("XRANGEPLAINLOOSE",`[v=\\s]*(${s[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[u.XRANGEIDENTIFIERLOOSE]})(?:${s[u.PRERELEASELOOSE]})?${s[u.BUILD]}?)?)?`),y("XRANGE",`^${s[u.GTLT]}\\s*${s[u.XRANGEPLAIN]}$`),y("XRANGELOOSE",`^${s[u.GTLT]}\\s*${s[u.XRANGEPLAINLOOSE]}$`),y("COERCEPLAIN",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?`),y("COERCE",`${s[u.COERCEPLAIN]}(?:$|[^\\d])`),y("COERCEFULL",s[u.COERCEPLAIN]+`(?:${s[u.PRERELEASE]})?(?:${s[u.BUILD]})?(?:$|[^\\d])`),y("COERCERTL",s[u.COERCE],!0),y("COERCERTLFULL",s[u.COERCEFULL],!0),y("LONETILDE","(?:~>?)"),y("TILDETRIM",`(\\s*)${s[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",y("TILDE",`^${s[u.LONETILDE]}${s[u.XRANGEPLAIN]}$`),y("TILDELOOSE",`^${s[u.LONETILDE]}${s[u.XRANGEPLAINLOOSE]}$`),y("LONECARET","(?:\\^)"),y("CARETTRIM",`(\\s*)${s[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",y("CARET",`^${s[u.LONECARET]}${s[u.XRANGEPLAIN]}$`),y("CARETLOOSE",`^${s[u.LONECARET]}${s[u.XRANGEPLAINLOOSE]}$`),y("COMPARATORLOOSE",`^${s[u.GTLT]}\\s*(${s[u.LOOSEPLAIN]})$|^$`),y("COMPARATOR",`^${s[u.GTLT]}\\s*(${s[u.FULLPLAIN]})$|^$`),y("COMPARATORTRIM",`(\\s*)${s[u.GTLT]}\\s*(${s[u.LOOSEPLAIN]}|${s[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",y("HYPHENRANGE",`^\\s*(${s[u.XRANGEPLAIN]})\\s+-\\s+(${s[u.XRANGEPLAIN]})\\s*$`),y("HYPHENRANGELOOSE",`^\\s*(${s[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[u.XRANGEPLAINLOOSE]})\\s*$`),y("STAR","(<|>)?=?\\s*\\*"),y("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),y("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(ze,ze.exports);var Oe=ze.exports;const sr=Object.freeze({loose:!0}),lr=Object.freeze({}),hr=e=>e?typeof e!="object"?sr:e:lr;var qe=hr;const It=/^[0-9]+$/,jt=(e,t)=>{const i=It.test(e),r=It.test(t);return i&&r&&(e=+e,t=+t),e===t?0:i&&!r?-1:r&&!i?1:e<t?-1:1},cr=(e,t)=>jt(t,e);var pr={compareIdentifiers:jt,rcompareIdentifiers:cr};const ke=Pe,{MAX_LENGTH:At,MAX_SAFE_INTEGER:Re}=De,{safeRe:$t,t:Lt}=Oe,ur=qe,{compareIdentifiers:le}=pr;let dr=class G{constructor(t,i){if(i=ur(i),t instanceof G){if(t.loose===!!i.loose&&t.includePrerelease===!!i.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>At)throw new TypeError(`version is longer than ${At} characters`);ke("SemVer",t,i),this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease;const r=t.trim().match(i.loose?$t[Lt.LOOSE]:$t[Lt.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Re||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Re||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Re||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){const a=+o;if(a>=0&&a<Re)return a}return o}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(ke("SemVer.compare",this.version,this.options,t),!(t instanceof G)){if(typeof t=="string"&&t===this.version)return 0;t=new G(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof G||(t=new G(t,this.options)),le(this.major,t.major)||le(this.minor,t.minor)||le(this.patch,t.patch)}comparePre(t){if(t instanceof G||(t=new G(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let i=0;do{const r=this.prerelease[i],o=t.prerelease[i];if(ke("prerelease compare",i,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r!==o)return le(r,o)}while(++i)}compareBuild(t){t instanceof G||(t=new G(t,this.options));let i=0;do{const r=this.build[i],o=t.build[i];if(ke("build compare",i,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r!==o)return le(r,o)}while(++i)}inc(t,i,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",i,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",i,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",i,r),this.inc("pre",i,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",i,r),this.inc("pre",i,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const o=Number(r)?1:0;if(!i&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[o];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);if(a===-1){if(i===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(i){let a=[i,o];r===!1&&(a=[i]),le(this.prerelease[0],i)===0?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var ge=dr;const St=ge,fr=(e,t,i=!1)=>{if(e instanceof St)return e;try{return new St(e,t)}catch(r){if(!i)return null;throw r}};var gr=fr;const mr=ge,br=gr,{safeRe:Ie,t:je}=Oe,vr=(e,t)=>{if(e instanceof mr)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let i=null;if(!t.rtl)i=e.match(t.includePrerelease?Ie[je.COERCEFULL]:Ie[je.COERCE]);else{const s=t.includePrerelease?Ie[je.COERCERTLFULL]:Ie[je.COERCERTL];let u;for(;(u=s.exec(e))&&(!i||i.index+i[0].length!==e.length);)(!i||u.index+u[0].length!==i.index+i[0].length)&&(i=u),s.lastIndex=u.index+u[1].length+u[2].length;s.lastIndex=-1}if(i===null)return null;const r=i[2],o=i[3]||"0",a=i[4]||"0",l=t.includePrerelease&&i[5]?`-${i[5]}`:"",p=t.includePrerelease&&i[6]?`+${i[6]}`:"";return br(`${r}.${o}.${a}${l}${p}`,t)};var wr=vr;const Mt=ge,Er=(e,t,i)=>new Mt(e,i).compare(new Mt(t,i));var he=Er;const yr=he,xr=(e,t,i)=>yr(e,t,i)>=0;var Nt=xr;class Pr{constructor(){this.max=1e3,this.map=new Map}get(t){const i=this.map.get(t);if(i!==void 0)return this.map.delete(t),this.map.set(t,i),i}delete(t){return this.map.delete(t)}set(t,i){if(!this.delete(t)&&i!==void 0){if(this.map.size>=this.max){const r=this.map.keys().next().value;this.delete(r)}this.map.set(t,i)}return this}}var Or=Pr;const kr=he,Rr=(e,t,i)=>kr(e,t,i)===0;var Ir=Rr;const jr=he,Ar=(e,t,i)=>jr(e,t,i)!==0;var $r=Ar;const Lr=he,Sr=(e,t,i)=>Lr(e,t,i)>0;var Mr=Sr;const Nr=he,Tr=(e,t,i)=>Nr(e,t,i)<0;var Cr=Tr;const Br=he,_r=(e,t,i)=>Br(e,t,i)<=0;var Fr=_r;const Dr=Ir,zr=$r,qr=Mr,Gr=Nt,Ur=Cr,Wr=Fr,Hr=(e,t,i,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof i=="object"&&(i=i.version),e===i;case"!==":return typeof e=="object"&&(e=e.version),typeof i=="object"&&(i=i.version),e!==i;case"":case"=":case"==":return Dr(e,i,r);case"!=":return zr(e,i,r);case">":return qr(e,i,r);case">=":return Gr(e,i,r);case"<":return Ur(e,i,r);case"<=":return Wr(e,i,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var Xr=Hr,Ge,Tt;function Vr(){if(Tt)return Ge;Tt=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(b,O){if(O=i(O),b instanceof t){if(b.loose===!!O.loose)return b;b=b.value}b=b.trim().split(/\s+/).join(" "),l("comparator",b,O),this.options=O,this.loose=!!O.loose,this.parse(b),this.semver===e?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(b){const O=this.options.loose?r[o.COMPARATORLOOSE]:r[o.COMPARATOR],T=b.match(O);if(!T)throw new TypeError(`Invalid comparator: ${b}`);this.operator=T[1]!==void 0?T[1]:"",this.operator==="="&&(this.operator=""),T[2]?this.semver=new p(T[2],this.options.loose):this.semver=e}toString(){return this.value}test(b){if(l("Comparator.test",b,this.options.loose),this.semver===e||b===e)return!0;if(typeof b=="string")try{b=new p(b,this.options)}catch{return!1}return a(b,this.operator,this.semver,this.options)}intersects(b,O){if(!(b instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new s(b.value,O).test(this.value):b.operator===""?b.value===""?!0:new s(this.value,O).test(b.semver):(O=i(O),O.includePrerelease&&(this.value==="<0.0.0-0"||b.value==="<0.0.0-0")||!O.includePrerelease&&(this.value.startsWith("<0.0.0")||b.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&b.operator.startsWith(">")||this.operator.startsWith("<")&&b.operator.startsWith("<")||this.semver.version===b.semver.version&&this.operator.includes("=")&&b.operator.includes("=")||a(this.semver,"<",b.semver,O)&&this.operator.startsWith(">")&&b.operator.startsWith("<")||a(this.semver,">",b.semver,O)&&this.operator.startsWith("<")&&b.operator.startsWith(">")))}}Ge=t;const i=qe,{safeRe:r,t:o}=Oe,a=Xr,l=Pe,p=ge,s=Bt();return Ge}var Ue,Ct;function Bt(){if(Ct)return Ue;Ct=1;class e{constructor(d,x){if(x=r(x),d instanceof e)return d.loose===!!x.loose&&d.includePrerelease===!!x.includePrerelease?d:new e(d.raw,x);if(d instanceof o)return this.raw=d.value,this.set=[[d]],this.format(),this;if(this.options=x,this.loose=!!x.loose,this.includePrerelease=!!x.includePrerelease,this.raw=d.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(w=>this.parseRange(w.trim())).filter(w=>w.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const w=this.set[0];if(this.set=this.set.filter(E=>!y(E[0])),this.set.length===0)this.set=[w];else if(this.set.length>1){for(const E of this.set)if(E.length===1&&V(E[0])){this.set=[E];break}}}this.format()}format(){return this.range=this.set.map(d=>d.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(d){const x=((this.options.includePrerelease&&T)|(this.options.loose&&Be))+":"+d,w=i.get(x);if(w)return w;const E=this.options.loose,v=E?p[s.HYPHENRANGELOOSE]:p[s.HYPHENRANGE];d=d.replace(v,Pi(this.options.includePrerelease)),a("hyphen replace",d),d=d.replace(p[s.COMPARATORTRIM],u),a("comparator trim",d),d=d.replace(p[s.TILDETRIM],b),a("tilde trim",d),d=d.replace(p[s.CARETTRIM],O),a("caret trim",d);let P=d.split(" ").map(A=>K(A,this.options)).join(" ").split(/\s+/).map(A=>xi(A,this.options));E&&(P=P.filter(A=>(a("loose invalid filter",A,this.options),!!A.match(p[s.COMPARATORLOOSE])))),a("range list",P);const R=new Map,k=P.map(A=>new o(A,this.options));for(const A of k){if(y(A))return[A];R.set(A.value,A)}R.size>1&&R.has("")&&R.delete("");const j=[...R.values()];return i.set(x,j),j}intersects(d,x){if(!(d instanceof e))throw new TypeError("a Range is required");return this.set.some(w=>_(w,x)&&d.set.some(E=>_(E,x)&&w.every(v=>E.every(P=>v.intersects(P,x)))))}test(d){if(!d)return!1;if(typeof d=="string")try{d=new l(d,this.options)}catch{return!1}for(let x=0;x<this.set.length;x++)if(Oi(this.set[x],d,this.options))return!0;return!1}}Ue=e;const t=Or,i=new t,r=qe,o=Vr(),a=Pe,l=ge,{safeRe:p,t:s,comparatorTrimReplace:u,tildeTrimReplace:b,caretTrimReplace:O}=Oe,{FLAG_INCLUDE_PRERELEASE:T,FLAG_LOOSE:Be}=De,y=f=>f.value==="<0.0.0-0",V=f=>f.value==="",_=(f,d)=>{let x=!0;const w=f.slice();let E=w.pop();for(;x&&w.length;)x=w.every(v=>E.intersects(v,d)),E=w.pop();return x},K=(f,d)=>(a("comp",f,d),f=bi(f,d),a("caret",f),f=Z(f,d),a("tildes",f),f=wi(f,d),a("xrange",f),f=yi(f,d),a("stars",f),f),M=f=>!f||f.toLowerCase()==="x"||f==="*",Z=(f,d)=>f.trim().split(/\s+/).map(x=>mi(x,d)).join(" "),mi=(f,d)=>{const x=d.loose?p[s.TILDELOOSE]:p[s.TILDE];return f.replace(x,(w,E,v,P,R)=>{a("tilde",f,w,E,v,P,R);let k;return M(E)?k="":M(v)?k=`>=${E}.0.0 <${+E+1}.0.0-0`:M(P)?k=`>=${E}.${v}.0 <${E}.${+v+1}.0-0`:R?(a("replaceTilde pr",R),k=`>=${E}.${v}.${P}-${R} <${E}.${+v+1}.0-0`):k=`>=${E}.${v}.${P} <${E}.${+v+1}.0-0`,a("tilde return",k),k})},bi=(f,d)=>f.trim().split(/\s+/).map(x=>vi(x,d)).join(" "),vi=(f,d)=>{a("caret",f,d);const x=d.loose?p[s.CARETLOOSE]:p[s.CARET],w=d.includePrerelease?"-0":"";return f.replace(x,(E,v,P,R,k)=>{a("caret",f,E,v,P,R,k);let j;return M(v)?j="":M(P)?j=`>=${v}.0.0${w} <${+v+1}.0.0-0`:M(R)?v==="0"?j=`>=${v}.${P}.0${w} <${v}.${+P+1}.0-0`:j=`>=${v}.${P}.0${w} <${+v+1}.0.0-0`:k?(a("replaceCaret pr",k),v==="0"?P==="0"?j=`>=${v}.${P}.${R}-${k} <${v}.${P}.${+R+1}-0`:j=`>=${v}.${P}.${R}-${k} <${v}.${+P+1}.0-0`:j=`>=${v}.${P}.${R}-${k} <${+v+1}.0.0-0`):(a("no pr"),v==="0"?P==="0"?j=`>=${v}.${P}.${R}${w} <${v}.${P}.${+R+1}-0`:j=`>=${v}.${P}.${R}${w} <${v}.${+P+1}.0-0`:j=`>=${v}.${P}.${R} <${+v+1}.0.0-0`),a("caret return",j),j})},wi=(f,d)=>(a("replaceXRanges",f,d),f.split(/\s+/).map(x=>Ei(x,d)).join(" ")),Ei=(f,d)=>{f=f.trim();const x=d.loose?p[s.XRANGELOOSE]:p[s.XRANGE];return f.replace(x,(w,E,v,P,R,k)=>{a("xRange",f,w,E,v,P,R,k);const j=M(v),A=j||M(P),oe=A||M(R),fe=oe;return E==="="&&fe&&(E=""),k=d.includePrerelease?"-0":"",j?E===">"||E==="<"?w="<0.0.0-0":w="*":E&&fe?(A&&(P=0),R=0,E===">"?(E=">=",A?(v=+v+1,P=0,R=0):(P=+P+1,R=0)):E==="<="&&(E="<",A?v=+v+1:P=+P+1),E==="<"&&(k="-0"),w=`${E+v}.${P}.${R}${k}`):A?w=`>=${v}.0.0${k} <${+v+1}.0.0-0`:oe&&(w=`>=${v}.${P}.0${k} <${v}.${+P+1}.0-0`),a("xRange return",w),w})},yi=(f,d)=>(a("replaceStars",f,d),f.trim().replace(p[s.STAR],"")),xi=(f,d)=>(a("replaceGTE0",f,d),f.trim().replace(p[d.includePrerelease?s.GTE0PRE:s.GTE0],"")),Pi=f=>(d,x,w,E,v,P,R,k,j,A,oe,fe)=>(M(w)?x="":M(E)?x=`>=${w}.0.0${f?"-0":""}`:M(v)?x=`>=${w}.${E}.0${f?"-0":""}`:P?x=`>=${x}`:x=`>=${x}${f?"-0":""}`,M(j)?k="":M(A)?k=`<${+j+1}.0.0-0`:M(oe)?k=`<${j}.${+A+1}.0-0`:fe?k=`<=${j}.${A}.${oe}-${fe}`:f?k=`<${j}.${A}.${+oe+1}-0`:k=`<=${k}`,`${x} ${k}`.trim()),Oi=(f,d,x)=>{for(let w=0;w<f.length;w++)if(!f[w].test(d))return!1;if(d.prerelease.length&&!x.includePrerelease){for(let w=0;w<f.length;w++)if(a(f[w].semver),f[w].semver!==o.ANY&&f[w].semver.prerelease.length>0){const E=f[w].semver;if(E.major===d.major&&E.minor===d.minor&&E.patch===d.patch)return!0}return!1}return!0};return Ue}const Qr=Bt(),Jr=(e,t,i)=>{try{t=new Qr(t,i)}catch{return!1}return t.test(e)};var Yr=Jr;const Kr="sharp",Zr="High performance Node.js image processing, the fastest module to resize JPEG, PNG, WebP, GIF, AVIF and TIFF images",en="0.33.4",tn="Lovell Fuller <npm@lovell.info>",rn="https://sharp.pixelplumbing.com",nn=["Pierre Inglebert <pierre.inglebert@gmail.com>","Jonathan Ong <jonathanrichardong@gmail.com>","Chanon Sajjamanochai <chanon.s@gmail.com>","Juliano Julio <julianojulio@gmail.com>","Daniel Gasienica <daniel@gasienica.ch>","Julian Walker <julian@fiftythree.com>","Amit Pitaru <pitaru.amit@gmail.com>","Brandon Aaron <hello.brandon@aaron.sh>","Andreas Lind <andreas@one.com>","Maurus Cuelenaere <mcuelenaere@gmail.com>","Linus Unneb\xE4ck <linus@folkdatorn.se>","Victor Mateevitsi <mvictoras@gmail.com>","Alaric Holloway <alaric.holloway@gmail.com>","Bernhard K. Weisshuhn <bkw@codingforce.com>","Chris Riley <criley@primedia.com>","David Carley <dacarley@gmail.com>","John Tobin <john@limelightmobileinc.com>","Kenton Gray <kentongray@gmail.com>","Felix B\xFCnemann <Felix.Buenemann@gmail.com>","Samy Al Zahrani <samyalzahrany@gmail.com>","Chintan Thakkar <lemnisk8@gmail.com>","F. Orlando Galashan <frulo@gmx.de>","Kleis Auke Wolthuizen <info@kleisauke.nl>","Matt Hirsch <mhirsch@media.mit.edu>","Matthias Thoemmes <thoemmes@gmail.com>","Patrick Paskaris <patrick@paskaris.gr>","J\xE9r\xE9my Lal <kapouer@melix.org>","Rahul Nanwani <r.nanwani@gmail.com>","Alice Monday <alice0meta@gmail.com>","Kristo Jorgenson <kristo.jorgenson@gmail.com>","YvesBos <yves_bos@outlook.com>","Guy Maliar <guy@tailorbrands.com>","Nicolas Coden <nicolas@ncoden.fr>","Matt Parrish <matt.r.parrish@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Matthew McEachen <matthew+github@mceachen.org>","Jarda Kot\u011B\u0161ovec <jarda.kotesovec@gmail.com>","Kenric D'Souza <kenric.dsouza@gmail.com>","Oleh Aleinyk <oleg.aleynik@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Andrea Bianco <andrea.bianco@unibas.ch>","Rik Heywood <rik@rik.org>","Thomas Parisot <hi@oncletom.io>","Nathan Graves <nathanrgraves+github@gmail.com>","Tom Lokhorst <tom@lokhorst.eu>","Espen Hovlandsdal <espen@hovlandsdal.com>","Sylvain Dumont <sylvain.dumont35@gmail.com>","Alun Davies <alun.owain.davies@googlemail.com>","Aidan Hoolachan <ajhoolachan21@gmail.com>","Axel Eirola <axel.eirola@iki.fi>","Freezy <freezy@xbmc.org>","Daiz <taneli.vatanen@gmail.com>","Julian Aubourg <j@ubourg.net>","Keith Belovay <keith@picthrive.com>","Michael B. Klein <mbklein@gmail.com>","Jordan Prudhomme <jordan@raboland.fr>","Ilya Ovdin <iovdin@gmail.com>","Andargor <andargor@yahoo.com>","Paul Neave <paul.neave@gmail.com>","Brendan Kennedy <brenwken@gmail.com>","Brychan Bennett-Odlum <git@brychan.io>","Edward Silverton <e.silverton@gmail.com>","Roman Malieiev <aromaleev@gmail.com>","Tomas Szabo <tomas.szabo@deftomat.com>","Robert O'Rourke <robert@o-rourke.org>","Guillermo Alfonso Varela Chouci\xF1o <guillevch@gmail.com>","Christian Flintrup <chr@gigahost.dk>","Manan Jadhav <manan@motionden.com>","Leon Radley <leon@radley.se>","alza54 <alza54@thiocod.in>","Jacob Smith <jacob@frende.me>","Michael Nutt <michael@nutt.im>","Brad Parham <baparham@gmail.com>","Taneli Vatanen <taneli.vatanen@gmail.com>","Joris Dugu\xE9 <zaruike10@gmail.com>","Chris Banks <christopher.bradley.banks@gmail.com>","Ompal Singh <ompal.hitm09@gmail.com>","Brodan <christopher.hranj@gmail.com>","Ankur Parihar <ankur.github@gmail.com>","Brahim Ait elhaj <brahima@gmail.com>","Mart Jansink <m.jansink@gmail.com>","Lachlan Newman <lachnewman007@gmail.com>","Dennis Beatty <dennis@dcbeatty.com>","Ingvar Stepanyan <me@rreverser.com>"],on={install:"node install/check",clean:"rm -rf src/build/ .nyc_output/ coverage/ test/fixtures/output.*",test:"npm run test-lint && npm run test-unit && npm run test-licensing && npm run test-types","test-lint":"semistandard && cpplint","test-unit":"nyc --reporter=lcov --reporter=text --check-coverage --branches=100 mocha","test-licensing":'license-checker --production --summary --onlyAllow="Apache-2.0;BSD;ISC;LGPL-3.0-or-later;MIT"',"test-leak":"./test/leak/leak.sh","test-types":"tsd","package-from-local-build":"node npm/from-local-build","package-from-github-release":"node npm/from-github-release","docs-build":"node docs/build && node docs/search-index/build","docs-serve":"cd docs && npx serve","docs-publish":"cd docs && npx firebase-tools deploy --project pixelplumbing --only hosting:pixelplumbing-sharp"},an="commonjs",sn="lib/index.js",ln="lib/index.d.ts",hn=["install","lib","src/*.{cc,h,gyp}"],cn={type:"git",url:"git://github.com/lovell/sharp.git"},pn=["jpeg","png","webp","avif","tiff","gif","svg","jp2","dzi","image","resize","thumbnail","crop","embed","libvips","vips"],un={color:"^4.2.3","detect-libc":"^2.0.3",semver:"^7.6.0"},dn={"@img/sharp-darwin-arm64":"0.33.4","@img/sharp-darwin-x64":"0.33.4","@img/sharp-libvips-darwin-arm64":"1.0.2","@img/sharp-libvips-darwin-x64":"1.0.2","@img/sharp-libvips-linux-arm":"1.0.2","@img/sharp-libvips-linux-arm64":"1.0.2","@img/sharp-libvips-linux-s390x":"1.0.2","@img/sharp-libvips-linux-x64":"1.0.2","@img/sharp-libvips-linuxmusl-arm64":"1.0.2","@img/sharp-libvips-linuxmusl-x64":"1.0.2","@img/sharp-linux-arm":"0.33.4","@img/sharp-linux-arm64":"0.33.4","@img/sharp-linux-s390x":"0.33.4","@img/sharp-linux-x64":"0.33.4","@img/sharp-linuxmusl-arm64":"0.33.4","@img/sharp-linuxmusl-x64":"0.33.4","@img/sharp-wasm32":"0.33.4","@img/sharp-win32-ia32":"0.33.4","@img/sharp-win32-x64":"0.33.4"},fn={"@emnapi/runtime":"^1.1.1","@img/sharp-libvips-dev":"1.0.2","@img/sharp-libvips-dev-wasm32":"1.0.3","@img/sharp-libvips-win32-ia32":"1.0.2","@img/sharp-libvips-win32-x64":"1.0.2","@types/node":"*",async:"^3.2.5",cc:"^3.0.1",emnapi:"^1.1.1","exif-reader":"^2.0.1","extract-zip":"^2.0.1",icc:"^3.0.0","jsdoc-to-markdown":"^8.0.1","license-checker":"^25.0.1",mocha:"^10.4.0","node-addon-api":"^8.0.0",nyc:"^15.1.0",prebuild:"^13.0.1",semistandard:"^17.0.0","tar-fs":"^3.0.6",tsd:"^0.31.0"},gn="Apache-2.0",mn={node:"^18.17.0 || ^20.3.0 || >=21.0.0",libvips:">=8.15.2"},bn={url:"https://opencollective.com/libvips"},vn={napi_versions:[9]},wn={env:["mocha"]},En={linelength:"120",filter:["build/include"]},yn={include:["lib"]},xn={directory:"test/types/"},_t={name:Kr,description:Zr,version:en,author:tn,homepage:rn,contributors:nn,scripts:on,type:an,main:sn,types:ln,files:hn,repository:cn,keywords:pn,dependencies:un,optionalDependencies:dn,devDependencies:fn,license:gn,engines:mn,funding:bn,binary:vn,semistandard:wn,cc:En,nyc:yn,tsd:xn};var ie={};const{spawnSync:Ae}=U,{createHash:Pn}=U,Ft=wr,On=Nt,kn=Yr,Dt=_e,{engines:We,optionalDependencies:Rn}=_t,In=ie.npm_package_config_libvips||We.libvips,zt=Ft(In).version,jn=["darwin-arm64","darwin-x64","linux-arm","linux-arm64","linux-s390x","linux-x64","linuxmusl-arm64","linuxmusl-x64","win32-ia32","win32-x64"],$e={encoding:"utf8",shell:!0},qt=e=>{e instanceof Error?console.error(`sharp: Installation error: ${e.message}`):console.log(`sharp: ${e}`)},Gt=()=>Dt.isNonGlibcLinuxSync()?Dt.familySync():"",An=()=>`${process.platform}${Gt()}-${process.arch}`,ce=()=>{if(Ut())return"wasm32";const{npm_config_arch:e,npm_config_platform:t,npm_config_libc:i}=ie,r=typeof i=="string"?i:Gt();return`${t||process.platform}${r}-${e||process.arch}`},$n=()=>{try{return ee(`@img/sharp-libvips-dev-${ce()}/include`)}catch{try{return require("@img/sharp-libvips-dev/include")}catch{}}return""},Ln=()=>{try{return require("@img/sharp-libvips-dev/cplusplus")}catch{}return""},Sn=()=>{try{return ee(`@img/sharp-libvips-dev-${ce()}/lib`)}catch{try{return ee(`@img/sharp-libvips-${ce()}/lib`)}catch{}}return""},Mn=()=>{var e;if(((e=process.release)==null?void 0:e.name)==="node"&&process.versions&&!kn(process.versions.node,We.node))return{found:process.versions.node,expected:We.node}},Ut=()=>{const{CC:e}=ie;return!!(e&&e.endsWith("/emcc"))},Nn=()=>process.platform==="darwin"&&process.arch==="x64"?(Ae("sysctl sysctl.proc_translated",$e).stdout||"").trim()==="sysctl.proc_translated: 1":!1,Wt=e=>Pn("sha512").update(e).digest("hex"),Tn=()=>{try{const e=Wt(`imgsharp-libvips-${ce()}`),t=Ft(Rn[`@img/sharp-libvips-${ce()}`]).version;return Wt(`${e}npm:${t}`).slice(0,10)}catch{}return""},Cn=()=>Ae(`node-gyp rebuild --directory=src ${Ut()?"--nodedir=emscripten":""}`,{...$e,stdio:"inherit"}).status,Ht=()=>process.platform!=="win32"?(Ae("pkg-config --modversion vips-cpp",{...$e,env:{...ie,PKG_CONFIG_PATH:Xt()}}).stdout||"").trim():"",Xt=()=>process.platform!=="win32"?[(Ae('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d" " -f2',$e).stdout||"").trim(),ie.PKG_CONFIG_PATH,"/usr/local/lib/pkgconfig","/usr/lib/pkgconfig","/usr/local/libdata/pkgconfig","/usr/libdata/pkgconfig"].filter(Boolean).join(":"):"",He=(e,t)=>(qt(`Detected ${t}, skipping search for globally-installed libvips`),e),Bn=()=>{if(ie.SHARP_IGNORE_GLOBAL_LIBVIPS)return He(!1,"SHARP_IGNORE_GLOBAL_LIBVIPS");if(ie.SHARP_FORCE_GLOBAL_LIBVIPS)return He(!0,"SHARP_FORCE_GLOBAL_LIBVIPS");if(Nn())return He(!1,"Rosetta");const e=Ht();return!!e&&On(e,zt)};var Vt={minimumLibvipsVersion:zt,prebuiltPlatforms:jn,buildPlatformArch:ce,buildSharpLibvipsIncludeDir:$n,buildSharpLibvipsCPlusPlusDir:Ln,buildSharpLibvipsLibDir:Sn,isUnsupportedNodeRuntime:Mn,runtimePlatformArch:An,log:qt,yarnLocator:Tn,spawnRebuild:Cn,globalLibvipsVersion:Ht,pkgConfigPath:Xt,useGlobalLibvips:Bn};const{familySync:_n,versionSync:Fn}=_e,{runtimePlatformArch:Dn,isUnsupportedNodeRuntime:Qt,prebuiltPlatforms:zn,minimumLibvipsVersion:qn}=Vt,re=Dn(),Gn=[`../src/build/Release/sharp-${re}.node`,"../src/build/Release/sharp-wasm32.node",`@img/sharp-${re}/sharp.node`,"@img/sharp-wasm32/sharp.node"];let Xe;const Le=[];for(const e of Gn)try{Xe=ee(e);break}catch(t){Le.push(t)}if(Xe)st.exports=Xe;else{const[e,t,i]=["linux","darwin","win32"].map(a=>re.startsWith(a)),r=[`Could not load the "sharp" module using the ${re} runtime`];Le.forEach(a=>{a.code!=="MODULE_NOT_FOUND"&&r.push(`${a.code}: ${a.message}`)});const o=Le.map(a=>a.message).join(" ");if(r.push("Possible solutions:"),Qt()){const{found:a,expected:l}=Qt();r.push("- Please upgrade Node.js:",`    Found ${a}`,`    Requires ${l}`)}else if(zn.includes(re)){const[a,l]=re.split("-"),p=a.endsWith("musl")?" --libc=musl":"";r.push("- Ensure optional dependencies can be installed:","    npm install --include=optional sharp","    yarn add sharp --ignore-engines","- Ensure your package manager supports multi-platform installation:","    See https://sharp.pixelplumbing.com/install#cross-platform","- Add platform-specific dependencies:",`    npm install --os=${a.replace("musl","")}${p} --cpu=${l} sharp`)}else r.push(`- Manually install libvips >= ${qn}`,"- Add experimental WebAssembly-based dependencies:","    npm install --cpu=wasm32 sharp","    npm install @img/sharp-wasm32");if(e&&/(symbol not found|CXXABI_)/i.test(o))try{const{engines:a}=ee(`@img/sharp-libvips-${re}/package`),l=`${_n()} ${Fn()}`,p=`${a.musl?"musl":"glibc"} ${a.musl||a.glibc}`;r.push("- Update your OS:",`    Found ${l}`,`    Requires ${p}`)}catch{}throw e&&/\/snap\/core[0-9]{2}/.test(o)&&r.push("- Remove the Node.js Snap, which does not support native modules","    snap remove node"),t&&/Incompatible library version/.test(o)&&r.push("- Update Homebrew:","    brew update && brew upgrade vips"),Le.some(a=>a.code==="ERR_DLOPEN_DISABLED")&&r.push("- Run Node.js without using the --no-addons flag"),i&&/The specified procedure could not be found/.test(o)&&r.push("- Using the canvas package on Windows?","    See https://sharp.pixelplumbing.com/install#canvas-and-windows","- Check for outdated versions of sharp in the dependency tree:","    npm ls sharp"),r.push("- Consult the installation documentation:","    See https://sharp.pixelplumbing.com/install"),new Error(r.join(`
`))}var Ve=st.exports;const Un=U,Qe=U,Wn=W,Hn=Un.debuglog("sharp"),ne=function(e,t){if(arguments.length===1&&!Wn.defined(e))throw new Error("Invalid input");return this instanceof ne?(Qe.Duplex.call(this),this.options={topOffsetPre:-1,leftOffsetPre:-1,widthPre:-1,heightPre:-1,topOffsetPost:-1,leftOffsetPost:-1,widthPost:-1,heightPost:-1,width:-1,height:-1,canvas:"crop",position:0,resizeBackground:[0,0,0,255],useExifOrientation:!1,angle:0,rotationAngle:0,rotationBackground:[0,0,0,255],rotateBeforePreExtract:!1,flip:!1,flop:!1,extendTop:0,extendBottom:0,extendLeft:0,extendRight:0,extendBackground:[0,0,0,255],extendWith:"background",withoutEnlargement:!1,withoutReduction:!1,affineMatrix:[],affineBackground:[0,0,0,255],affineIdx:0,affineIdy:0,affineOdx:0,affineOdy:0,affineInterpolator:this.constructor.interpolators.bilinear,kernel:"lanczos3",fastShrinkOnLoad:!0,tint:[-1,0,0,0],flatten:!1,flattenBackground:[0,0,0],unflatten:!1,negate:!1,negateAlpha:!0,medianSize:0,blurSigma:0,sharpenSigma:0,sharpenM1:1,sharpenM2:2,sharpenX1:2,sharpenY2:10,sharpenY3:20,threshold:0,thresholdGrayscale:!0,trimBackground:[],trimThreshold:-1,trimLineArt:!1,gamma:0,gammaOut:0,greyscale:!1,normalise:!1,normaliseLower:1,normaliseUpper:99,claheWidth:0,claheHeight:0,claheMaxSlope:3,brightness:1,saturation:1,hue:0,lightness:0,booleanBufferIn:null,booleanFileIn:"",joinChannelIn:[],extractChannel:-1,removeAlpha:!1,ensureAlpha:-1,colourspace:"srgb",colourspacePipeline:"last",composite:[],fileOut:"",formatOut:"input",streamOut:!1,keepMetadata:0,withMetadataOrientation:-1,withMetadataDensity:0,withIccProfile:"",withExif:{},withExifMerge:!0,resolveWithObject:!1,jpegQuality:80,jpegProgressive:!1,jpegChromaSubsampling:"4:2:0",jpegTrellisQuantisation:!1,jpegOvershootDeringing:!1,jpegOptimiseScans:!1,jpegOptimiseCoding:!0,jpegQuantisationTable:0,pngProgressive:!1,pngCompressionLevel:6,pngAdaptiveFiltering:!1,pngPalette:!1,pngQuality:100,pngEffort:7,pngBitdepth:8,pngDither:1,jp2Quality:80,jp2TileHeight:512,jp2TileWidth:512,jp2Lossless:!1,jp2ChromaSubsampling:"4:4:4",webpQuality:80,webpAlphaQuality:100,webpLossless:!1,webpNearLossless:!1,webpSmartSubsample:!1,webpPreset:"default",webpEffort:4,webpMinSize:!1,webpMixed:!1,gifBitdepth:8,gifEffort:7,gifDither:1,gifInterFrameMaxError:0,gifInterPaletteMaxError:3,gifReuse:!0,gifProgressive:!1,tiffQuality:80,tiffCompression:"jpeg",tiffPredictor:"horizontal",tiffPyramid:!1,tiffMiniswhite:!1,tiffBitdepth:8,tiffTile:!1,tiffTileHeight:256,tiffTileWidth:256,tiffXres:1,tiffYres:1,tiffResolutionUnit:"inch",heifQuality:50,heifLossless:!1,heifCompression:"av1",heifEffort:4,heifChromaSubsampling:"4:4:4",heifBitdepth:8,jxlDistance:1,jxlDecodingTier:0,jxlEffort:7,jxlLossless:!1,rawDepth:"uchar",tileSize:256,tileOverlap:0,tileContainer:"fs",tileLayout:"dz",tileFormat:"last",tileDepth:"last",tileAngle:0,tileSkipBlanks:-1,tileBackground:[255,255,255,255],tileCentre:!1,tileId:"https://example.com/iiif",tileBasename:"",timeoutSeconds:0,linearA:[],linearB:[],debuglog:i=>{this.emit("warning",i),Hn(i)},queueListener:function(i){ne.queue.emit("change",i)}},this.options.input=this._createInputDescriptor(e,t,{allowStream:!0}),this):new ne(e,t)};Object.setPrototypeOf(ne.prototype,Qe.Duplex.prototype),Object.setPrototypeOf(ne,Qe.Duplex);function Xn(){const e=this.constructor.call(),{debuglog:t,queueListener:i,...r}=this.options;return e.options=structuredClone(r),e.options.debuglog=t,e.options.queueListener=i,this._isStreamInput()&&this.on("finish",()=>{this._flattenBufferIn(),e.options.input.buffer=this.options.input.buffer,e.emit("finish")}),e}Object.assign(ne.prototype,{clone:Xn});var Vn=ne,Jt={exports:{}},Qn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Yt={exports:{}},Jn=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")},Yn=Jn,Kn=Array.prototype.concat,Zn=Array.prototype.slice,Kt=Yt.exports=function(e){for(var t=[],i=0,r=e.length;i<r;i++){var o=e[i];Yn(o)?t=Kn.call(t,Zn.call(o)):t.push(o)}return t};Kt.wrap=function(e){return function(){return e(Kt(arguments))}};var eo=Yt.exports,me=Qn,be=eo,Zt=Object.hasOwnProperty,ei=Object.create(null);for(var Je in me)Zt.call(me,Je)&&(ei[me[Je]]=Je);var C=Jt.exports={to:{},get:{}};C.get=function(e){var t=e.substring(0,3).toLowerCase(),i,r;switch(t){case"hsl":i=C.get.hsl(e),r="hsl";break;case"hwb":i=C.get.hwb(e),r="hwb";break;default:i=C.get.rgb(e),r="rgb";break}return i?{model:r,value:i}:null},C.get.rgb=function(e){if(!e)return null;var t=/^#([a-f0-9]{3,4})$/i,i=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,r=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,o=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,a=/^(\w+)$/,l=[0,0,0,1],p,s,u;if(p=e.match(i)){for(u=p[2],p=p[1],s=0;s<3;s++){var b=s*2;l[s]=parseInt(p.slice(b,b+2),16)}u&&(l[3]=parseInt(u,16)/255)}else if(p=e.match(t)){for(p=p[1],u=p[3],s=0;s<3;s++)l[s]=parseInt(p[s]+p[s],16);u&&(l[3]=parseInt(u+u,16)/255)}else if(p=e.match(r)){for(s=0;s<3;s++)l[s]=parseInt(p[s+1],0);p[4]&&(p[5]?l[3]=parseFloat(p[4])*.01:l[3]=parseFloat(p[4]))}else if(p=e.match(o)){for(s=0;s<3;s++)l[s]=Math.round(parseFloat(p[s+1])*2.55);p[4]&&(p[5]?l[3]=parseFloat(p[4])*.01:l[3]=parseFloat(p[4]))}else return(p=e.match(a))?p[1]==="transparent"?[0,0,0,0]:Zt.call(me,p[1])?(l=me[p[1]],l[3]=1,l):null:null;for(s=0;s<3;s++)l[s]=J(l[s],0,255);return l[3]=J(l[3],0,1),l},C.get.hsl=function(e){if(!e)return null;var t=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,i=e.match(t);if(i){var r=parseFloat(i[4]),o=(parseFloat(i[1])%360+360)%360,a=J(parseFloat(i[2]),0,100),l=J(parseFloat(i[3]),0,100),p=J(isNaN(r)?1:r,0,1);return[o,a,l,p]}return null},C.get.hwb=function(e){if(!e)return null;var t=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,i=e.match(t);if(i){var r=parseFloat(i[4]),o=(parseFloat(i[1])%360+360)%360,a=J(parseFloat(i[2]),0,100),l=J(parseFloat(i[3]),0,100),p=J(isNaN(r)?1:r,0,1);return[o,a,l,p]}return null},C.to.hex=function(){var e=be(arguments);return"#"+Se(e[0])+Se(e[1])+Se(e[2])+(e[3]<1?Se(Math.round(e[3]*255)):"")},C.to.rgb=function(){var e=be(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},C.to.rgb.percent=function(){var e=be(arguments),t=Math.round(e[0]/255*100),i=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+t+"%, "+i+"%, "+r+"%)":"rgba("+t+"%, "+i+"%, "+r+"%, "+e[3]+")"},C.to.hsl=function(){var e=be(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},C.to.hwb=function(){var e=be(arguments),t="";return e.length>=4&&e[3]!==1&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},C.to.keyword=function(e){return ei[e.slice(0,3)]};function J(e,t,i){return Math.min(Math.max(t,e),i)}function Se(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}var to=Jt.exports,io={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const ve=io,ti={};for(const e of Object.keys(ve))ti[ve[e]]=e;const g={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var ii=g;for(const e of Object.keys(g)){if(!("channels"in g[e]))throw new Error("missing channels property: "+e);if(!("labels"in g[e]))throw new Error("missing channel labels property: "+e);if(g[e].labels.length!==g[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:i}=g[e];delete g[e].channels,delete g[e].labels,Object.defineProperty(g[e],"channels",{value:t}),Object.defineProperty(g[e],"labels",{value:i})}g.rgb.hsl=function(e){const t=e[0]/255,i=e[1]/255,r=e[2]/255,o=Math.min(t,i,r),a=Math.max(t,i,r),l=a-o;let p,s;a===o?p=0:t===a?p=(i-r)/l:i===a?p=2+(r-t)/l:r===a&&(p=4+(t-i)/l),p=Math.min(p*60,360),p<0&&(p+=360);const u=(o+a)/2;return a===o?s=0:u<=.5?s=l/(a+o):s=l/(2-a-o),[p,s*100,u*100]},g.rgb.hsv=function(e){let t,i,r,o,a;const l=e[0]/255,p=e[1]/255,s=e[2]/255,u=Math.max(l,p,s),b=u-Math.min(l,p,s),O=function(T){return(u-T)/6/b+1/2};return b===0?(o=0,a=0):(a=b/u,t=O(l),i=O(p),r=O(s),l===u?o=r-i:p===u?o=1/3+t-r:s===u&&(o=2/3+i-t),o<0?o+=1:o>1&&(o-=1)),[o*360,a*100,u*100]},g.rgb.hwb=function(e){const t=e[0],i=e[1];let r=e[2];const o=g.rgb.hsl(e)[0],a=1/255*Math.min(t,Math.min(i,r));return r=1-1/255*Math.max(t,Math.max(i,r)),[o,a*100,r*100]},g.rgb.cmyk=function(e){const t=e[0]/255,i=e[1]/255,r=e[2]/255,o=Math.min(1-t,1-i,1-r),a=(1-t-o)/(1-o)||0,l=(1-i-o)/(1-o)||0,p=(1-r-o)/(1-o)||0;return[a*100,l*100,p*100,o*100]};function ro(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}g.rgb.keyword=function(e){const t=ti[e];if(t)return t;let i=1/0,r;for(const o of Object.keys(ve)){const a=ve[o],l=ro(e,a);l<i&&(i=l,r=o)}return r},g.keyword.rgb=function(e){return ve[e]},g.rgb.xyz=function(e){let t=e[0]/255,i=e[1]/255,r=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,i=i>.04045?((i+.055)/1.055)**2.4:i/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92;const o=t*.4124+i*.3576+r*.1805,a=t*.2126+i*.7152+r*.0722,l=t*.0193+i*.1192+r*.9505;return[o*100,a*100,l*100]},g.rgb.lab=function(e){const t=g.rgb.xyz(e);let i=t[0],r=t[1],o=t[2];i/=95.047,r/=100,o/=108.883,i=i>.008856?i**(1/3):7.787*i+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116;const a=116*r-16,l=500*(i-r),p=200*(r-o);return[a,l,p]},g.hsl.rgb=function(e){const t=e[0]/360,i=e[1]/100,r=e[2]/100;let o,a,l;if(i===0)return l=r*255,[l,l,l];r<.5?o=r*(1+i):o=r+i-r*i;const p=2*r-o,s=[0,0,0];for(let u=0;u<3;u++)a=t+1/3*-(u-1),a<0&&a++,a>1&&a--,6*a<1?l=p+(o-p)*6*a:2*a<1?l=o:3*a<2?l=p+(o-p)*(2/3-a)*6:l=p,s[u]=l*255;return s},g.hsl.hsv=function(e){const t=e[0];let i=e[1]/100,r=e[2]/100,o=i;const a=Math.max(r,.01);r*=2,i*=r<=1?r:2-r,o*=a<=1?a:2-a;const l=(r+i)/2,p=r===0?2*o/(a+o):2*i/(r+i);return[t,p*100,l*100]},g.hsv.rgb=function(e){const t=e[0]/60,i=e[1]/100;let r=e[2]/100;const o=Math.floor(t)%6,a=t-Math.floor(t),l=255*r*(1-i),p=255*r*(1-i*a),s=255*r*(1-i*(1-a));switch(r*=255,o){case 0:return[r,s,l];case 1:return[p,r,l];case 2:return[l,r,s];case 3:return[l,p,r];case 4:return[s,l,r];case 5:return[r,l,p]}},g.hsv.hsl=function(e){const t=e[0],i=e[1]/100,r=e[2]/100,o=Math.max(r,.01);let a,l;l=(2-i)*r;const p=(2-i)*o;return a=i*o,a/=p<=1?p:2-p,a=a||0,l/=2,[t,a*100,l*100]},g.hwb.rgb=function(e){const t=e[0]/360;let i=e[1]/100,r=e[2]/100;const o=i+r;let a;o>1&&(i/=o,r/=o);const l=Math.floor(6*t),p=1-r;a=6*t-l,l&1&&(a=1-a);const s=i+a*(p-i);let u,b,O;switch(l){default:case 6:case 0:u=p,b=s,O=i;break;case 1:u=s,b=p,O=i;break;case 2:u=i,b=p,O=s;break;case 3:u=i,b=s,O=p;break;case 4:u=s,b=i,O=p;break;case 5:u=p,b=i,O=s;break}return[u*255,b*255,O*255]},g.cmyk.rgb=function(e){const t=e[0]/100,i=e[1]/100,r=e[2]/100,o=e[3]/100,a=1-Math.min(1,t*(1-o)+o),l=1-Math.min(1,i*(1-o)+o),p=1-Math.min(1,r*(1-o)+o);return[a*255,l*255,p*255]},g.xyz.rgb=function(e){const t=e[0]/100,i=e[1]/100,r=e[2]/100;let o,a,l;return o=t*3.2406+i*-1.5372+r*-.4986,a=t*-.9689+i*1.8758+r*.0415,l=t*.0557+i*-.204+r*1.057,o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,l=l>.0031308?1.055*l**(1/2.4)-.055:l*12.92,o=Math.min(Math.max(0,o),1),a=Math.min(Math.max(0,a),1),l=Math.min(Math.max(0,l),1),[o*255,a*255,l*255]},g.xyz.lab=function(e){let t=e[0],i=e[1],r=e[2];t/=95.047,i/=100,r/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,i=i>.008856?i**(1/3):7.787*i+16/116,r=r>.008856?r**(1/3):7.787*r+16/116;const o=116*i-16,a=500*(t-i),l=200*(i-r);return[o,a,l]},g.lab.xyz=function(e){const t=e[0],i=e[1],r=e[2];let o,a,l;a=(t+16)/116,o=i/500+a,l=a-r/200;const p=a**3,s=o**3,u=l**3;return a=p>.008856?p:(a-16/116)/7.787,o=s>.008856?s:(o-16/116)/7.787,l=u>.008856?u:(l-16/116)/7.787,o*=95.047,a*=100,l*=108.883,[o,a,l]},g.lab.lch=function(e){const t=e[0],i=e[1],r=e[2];let o;o=Math.atan2(r,i)*360/2/Math.PI,o<0&&(o+=360);const a=Math.sqrt(i*i+r*r);return[t,a,o]},g.lch.lab=function(e){const t=e[0],i=e[1],r=e[2]/360*2*Math.PI,o=i*Math.cos(r),a=i*Math.sin(r);return[t,o,a]},g.rgb.ansi16=function(e,t=null){const[i,r,o]=e;let a=t===null?g.rgb.hsv(e)[2]:t;if(a=Math.round(a/50),a===0)return 30;let l=30+(Math.round(o/255)<<2|Math.round(r/255)<<1|Math.round(i/255));return a===2&&(l+=60),l},g.hsv.ansi16=function(e){return g.rgb.ansi16(g.hsv.rgb(e),e[2])},g.rgb.ansi256=function(e){const t=e[0],i=e[1],r=e[2];return t===i&&i===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(i/255*5)+Math.round(r/255*5)},g.ansi16.rgb=function(e){let t=e%10;if(t===0||t===7)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const i=(~~(e>50)+1)*.5,r=(t&1)*i*255,o=(t>>1&1)*i*255,a=(t>>2&1)*i*255;return[r,o,a]},g.ansi256.rgb=function(e){if(e>=232){const a=(e-232)*10+8;return[a,a,a]}e-=16;let t;const i=Math.floor(e/36)/5*255,r=Math.floor((t=e%36)/6)/5*255,o=t%6/5*255;return[i,r,o]},g.rgb.hex=function(e){const t=(((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255)).toString(16).toUpperCase();return"000000".substring(t.length)+t},g.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let i=t[0];t[0].length===3&&(i=i.split("").map(p=>p+p).join(""));const r=parseInt(i,16),o=r>>16&255,a=r>>8&255,l=r&255;return[o,a,l]},g.rgb.hcg=function(e){const t=e[0]/255,i=e[1]/255,r=e[2]/255,o=Math.max(Math.max(t,i),r),a=Math.min(Math.min(t,i),r),l=o-a;let p,s;return l<1?p=a/(1-l):p=0,l<=0?s=0:o===t?s=(i-r)/l%6:o===i?s=2+(r-t)/l:s=4+(t-i)/l,s/=6,s%=1,[s*360,l*100,p*100]},g.hsl.hcg=function(e){const t=e[1]/100,i=e[2]/100,r=i<.5?2*t*i:2*t*(1-i);let o=0;return r<1&&(o=(i-.5*r)/(1-r)),[e[0],r*100,o*100]},g.hsv.hcg=function(e){const t=e[1]/100,i=e[2]/100,r=t*i;let o=0;return r<1&&(o=(i-r)/(1-r)),[e[0],r*100,o*100]},g.hcg.rgb=function(e){const t=e[0]/360,i=e[1]/100,r=e[2]/100;if(i===0)return[r*255,r*255,r*255];const o=[0,0,0],a=t%1*6,l=a%1,p=1-l;let s=0;switch(Math.floor(a)){case 0:o[0]=1,o[1]=l,o[2]=0;break;case 1:o[0]=p,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=l;break;case 3:o[0]=0,o[1]=p,o[2]=1;break;case 4:o[0]=l,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=p}return s=(1-i)*r,[(i*o[0]+s)*255,(i*o[1]+s)*255,(i*o[2]+s)*255]},g.hcg.hsv=function(e){const t=e[1]/100,i=e[2]/100,r=t+i*(1-t);let o=0;return r>0&&(o=t/r),[e[0],o*100,r*100]},g.hcg.hsl=function(e){const t=e[1]/100,i=e[2]/100*(1-t)+.5*t;let r=0;return i>0&&i<.5?r=t/(2*i):i>=.5&&i<1&&(r=t/(2*(1-i))),[e[0],r*100,i*100]},g.hcg.hwb=function(e){const t=e[1]/100,i=e[2]/100,r=t+i*(1-t);return[e[0],(r-t)*100,(1-r)*100]},g.hwb.hcg=function(e){const t=e[1]/100,i=1-e[2]/100,r=i-t;let o=0;return r<1&&(o=(i-r)/(1-r)),[e[0],r*100,o*100]},g.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},g.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},g.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},g.gray.hsl=function(e){return[0,0,e[0]]},g.gray.hsv=g.gray.hsl,g.gray.hwb=function(e){return[0,100,e[0]]},g.gray.cmyk=function(e){return[0,0,0,e[0]]},g.gray.lab=function(e){return[e[0],0,0]},g.gray.hex=function(e){const t=Math.round(e[0]/100*255)&255,i=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(i.length)+i},g.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};const Me=ii;function no(){const e={},t=Object.keys(Me);for(let i=t.length,r=0;r<i;r++)e[t[r]]={distance:-1,parent:null};return e}function oo(e){const t=no(),i=[e];for(t[e].distance=0;i.length;){const r=i.pop(),o=Object.keys(Me[r]);for(let a=o.length,l=0;l<a;l++){const p=o[l],s=t[p];s.distance===-1&&(s.distance=t[r].distance+1,s.parent=r,i.unshift(p))}}return t}function ao(e,t){return function(i){return t(e(i))}}function so(e,t){const i=[t[e].parent,e];let r=Me[t[e].parent][e],o=t[e].parent;for(;t[o].parent;)i.unshift(t[o].parent),r=ao(Me[t[o].parent][o],r),o=t[o].parent;return r.conversion=i,r}var lo=function(e){const t=oo(e),i={},r=Object.keys(t);for(let o=r.length,a=0;a<o;a++){const l=r[a];t[l].parent!==null&&(i[l]=so(l,t))}return i};const Ye=ii,ho=lo,pe={},co=Object.keys(Ye);function po(e){const t=function(...i){const r=i[0];return r==null?r:(r.length>1&&(i=r),e(i))};return"conversion"in e&&(t.conversion=e.conversion),t}function uo(e){const t=function(...i){const r=i[0];if(r==null)return r;r.length>1&&(i=r);const o=e(i);if(typeof o=="object")for(let a=o.length,l=0;l<a;l++)o[l]=Math.round(o[l]);return o};return"conversion"in e&&(t.conversion=e.conversion),t}co.forEach(e=>{pe[e]={},Object.defineProperty(pe[e],"channels",{value:Ye[e].channels}),Object.defineProperty(pe[e],"labels",{value:Ye[e].labels});const t=ho(e);Object.keys(t).forEach(i=>{const r=t[i];pe[e][i]=uo(r),pe[e][i].raw=po(r)})});var fo=pe;const ue=to,B=fo,ri=["keyword","gray","hex"],Ke={};for(const e of Object.keys(B))Ke[[...B[e].labels].sort().join("")]=e;const Ne={};function S(e,t){if(!(this instanceof S))return new S(e,t);if(t&&t in ri&&(t=null),t&&!(t in B))throw new Error("Unknown model: "+t);let i,r;if(e==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof S)this.model=e.model,this.color=[...e.color],this.valpha=e.valpha;else if(typeof e=="string"){const o=ue.get(e);if(o===null)throw new Error("Unable to parse color from string: "+e);this.model=o.model,r=B[this.model].channels,this.color=o.value.slice(0,r),this.valpha=typeof o.value[r]=="number"?o.value[r]:1}else if(e.length>0){this.model=t||"rgb",r=B[this.model].channels;const o=Array.prototype.slice.call(e,0,r);this.color=Ze(o,r),this.valpha=typeof e[r]=="number"?e[r]:1}else if(typeof e=="number")this.model="rgb",this.color=[e>>16&255,e>>8&255,e&255],this.valpha=1;else{this.valpha=1;const o=Object.keys(e);"alpha"in e&&(o.splice(o.indexOf("alpha"),1),this.valpha=typeof e.alpha=="number"?e.alpha:0);const a=o.sort().join("");if(!(a in Ke))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=Ke[a];const{labels:l}=B[this.model],p=[];for(i=0;i<l.length;i++)p.push(e[l[i]]);this.color=Ze(p)}if(Ne[this.model])for(r=B[this.model].channels,i=0;i<r;i++){const o=Ne[this.model][i];o&&(this.color[i]=o(this.color[i]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}S.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let t=this.model in ue.to?this:this.rgb();t=t.round(typeof e=="number"?e:1);const i=t.valpha===1?t.color:[...t.color,this.valpha];return ue.to[t.model](i)},percentString(e){const t=this.rgb().round(typeof e=="number"?e:1),i=t.valpha===1?t.color:[...t.color,this.valpha];return ue.to.rgb.percent(i)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const e={},{channels:t}=B[this.model],{labels:i}=B[this.model];for(let r=0;r<t;r++)e[i[r]]=this.color[r];return this.valpha!==1&&(e.alpha=this.valpha),e},unitArray(){const e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,this.valpha!==1&&e.push(this.valpha),e},unitObject(){const e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,this.valpha!==1&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new S([...this.color.map(mo(e)),this.valpha],this.model)},alpha(e){return e!==void 0?new S([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:$("rgb",0,L(255)),green:$("rgb",1,L(255)),blue:$("rgb",2,L(255)),hue:$(["hsl","hsv","hsl","hwb","hcg"],0,e=>(e%360+360)%360),saturationl:$("hsl",1,L(100)),lightness:$("hsl",2,L(100)),saturationv:$("hsv",1,L(100)),value:$("hsv",2,L(100)),chroma:$("hcg",1,L(100)),gray:$("hcg",2,L(100)),white:$("hwb",1,L(100)),wblack:$("hwb",2,L(100)),cyan:$("cmyk",0,L(100)),magenta:$("cmyk",1,L(100)),yellow:$("cmyk",2,L(100)),black:$("cmyk",3,L(100)),x:$("xyz",0,L(95.047)),y:$("xyz",1,L(100)),z:$("xyz",2,L(108.833)),l:$("lab",0,L(100)),a:$("lab",1),b:$("lab",2),keyword(e){return e!==void 0?new S(e):B[this.model].keyword(this.color)},hex(e){return e!==void 0?new S(e):ue.to.hex(this.rgb().round().color)},hexa(e){if(e!==void 0)return new S(e);const t=this.rgb().round().color;let i=Math.round(this.valpha*255).toString(16).toUpperCase();return i.length===1&&(i="0"+i),ue.to.hex(t)+i},rgbNumber(){const e=this.rgb().color;return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255},luminosity(){const e=this.rgb().color,t=[];for(const[i,r]of e.entries()){const o=r/255;t[i]=o<=.04045?o/12.92:((o+.055)/1.055)**2.4}return .2126*t[0]+.7152*t[1]+.0722*t[2]},contrast(e){const t=this.luminosity(),i=e.luminosity();return t>i?(t+.05)/(i+.05):(i+.05)/(t+.05)},level(e){const t=this.contrast(e);return t>=7?"AAA":t>=4.5?"AA":""},isDark(){const e=this.rgb().color;return(e[0]*2126+e[1]*7152+e[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const e=this.rgb();for(let t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten(e){const t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken(e){const t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate(e){const t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate(e){const t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten(e){const t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken(e){const t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale(){const e=this.rgb().color,t=e[0]*.3+e[1]*.59+e[2]*.11;return S.rgb(t,t,t)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){const t=this.hsl();let i=t.color[0];return i=(i+e)%360,i=i<0?360+i:i,t.color[0]=i,t},mix(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);const i=e.rgb(),r=this.rgb(),o=t===void 0?.5:t,a=2*o-1,l=i.alpha()-r.alpha(),p=((a*l===-1?a:(a+l)/(1+a*l))+1)/2,s=1-p;return S.rgb(p*i.red()+s*r.red(),p*i.green()+s*r.green(),p*i.blue()+s*r.blue(),i.alpha()*o+r.alpha()*(1-o))}};for(const e of Object.keys(B)){if(ri.includes(e))continue;const{channels:t}=B[e];S.prototype[e]=function(...i){return this.model===e?new S(this):i.length>0?new S(i,e):new S([...bo(B[this.model][e].raw(this.color)),this.valpha],e)},S[e]=function(...i){let r=i[0];return typeof r=="number"&&(r=Ze(i,t)),new S(r,e)}}function go(e,t){return Number(e.toFixed(t))}function mo(e){return function(t){return go(t,e)}}function $(e,t,i){e=Array.isArray(e)?e:[e];for(const r of e)(Ne[r]||(Ne[r]=[]))[t]=i;return e=e[0],function(r){let o;return r!==void 0?(i&&(r=i(r)),o=this[e](),o.color[t]=r,o):(o=this[e]().color[t],i&&(o=i(o)),o)}}function L(e){return function(t){return Math.max(0,Math.min(e,t))}}function bo(e){return Array.isArray(e)?e:[e]}function Ze(e,t){for(let i=0;i<t;i++)typeof e[i]!="number"&&(e[i]=0);return e}var et=S;const vo=et,c=W,Y=Ve,wo={left:"low",center:"centre",centre:"centre",right:"high"};function ni(e){const{raw:t,density:i,limitInputPixels:r,ignoreIcc:o,unlimited:a,sequentialRead:l,failOn:p,failOnError:s,animated:u,page:b,pages:O,subifd:T}=e;return[t,i,r,o,a,l,p,s,u,b,O,T].some(c.defined)?{raw:t,density:i,limitInputPixels:r,ignoreIcc:o,unlimited:a,sequentialRead:l,failOn:p,failOnError:s,animated:u,page:b,pages:O,subifd:T}:void 0}function Eo(e,t,i){const r={failOn:"warning",limitInputPixels:Math.pow(16383,2),ignoreIcc:!1,unlimited:!1,sequentialRead:!0};if(c.string(e))r.file=e;else if(c.buffer(e)){if(e.length===0)throw Error("Input Buffer is empty");r.buffer=e}else if(c.arrayBuffer(e)){if(e.byteLength===0)throw Error("Input bit Array is empty");r.buffer=Buffer.from(e,0,e.byteLength)}else if(c.typedArray(e)){if(e.length===0)throw Error("Input Bit Array is empty");r.buffer=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}else if(c.plainObject(e)&&!c.defined(t))t=e,ni(t)&&(r.buffer=[]);else if(!c.defined(e)&&!c.defined(t)&&c.object(i)&&i.allowStream)r.buffer=[];else throw new Error(`Unsupported input '${e}' of type ${typeof e}${c.defined(t)?` when also providing options of type ${typeof t}`:""}`);if(c.object(t)){if(c.defined(t.failOnError))if(c.bool(t.failOnError))r.failOn=t.failOnError?"warning":"none";else throw c.invalidParameterError("failOnError","boolean",t.failOnError);if(c.defined(t.failOn))if(c.string(t.failOn)&&c.inArray(t.failOn,["none","truncated","error","warning"]))r.failOn=t.failOn;else throw c.invalidParameterError("failOn","one of: none, truncated, error, warning",t.failOn);if(c.defined(t.density))if(c.inRange(t.density,1,1e5))r.density=t.density;else throw c.invalidParameterError("density","number between 1 and 100000",t.density);if(c.defined(t.ignoreIcc))if(c.bool(t.ignoreIcc))r.ignoreIcc=t.ignoreIcc;else throw c.invalidParameterError("ignoreIcc","boolean",t.ignoreIcc);if(c.defined(t.limitInputPixels))if(c.bool(t.limitInputPixels))r.limitInputPixels=t.limitInputPixels?Math.pow(16383,2):0;else if(c.integer(t.limitInputPixels)&&c.inRange(t.limitInputPixels,0,Number.MAX_SAFE_INTEGER))r.limitInputPixels=t.limitInputPixels;else throw c.invalidParameterError("limitInputPixels","positive integer",t.limitInputPixels);if(c.defined(t.unlimited))if(c.bool(t.unlimited))r.unlimited=t.unlimited;else throw c.invalidParameterError("unlimited","boolean",t.unlimited);if(c.defined(t.sequentialRead))if(c.bool(t.sequentialRead))r.sequentialRead=t.sequentialRead;else throw c.invalidParameterError("sequentialRead","boolean",t.sequentialRead);if(c.defined(t.raw))if(c.object(t.raw)&&c.integer(t.raw.width)&&t.raw.width>0&&c.integer(t.raw.height)&&t.raw.height>0&&c.integer(t.raw.channels)&&c.inRange(t.raw.channels,1,4))switch(r.rawWidth=t.raw.width,r.rawHeight=t.raw.height,r.rawChannels=t.raw.channels,r.rawPremultiplied=!!t.raw.premultiplied,e.constructor){case Uint8Array:case Uint8ClampedArray:r.rawDepth="uchar";break;case Int8Array:r.rawDepth="char";break;case Uint16Array:r.rawDepth="ushort";break;case Int16Array:r.rawDepth="short";break;case Uint32Array:r.rawDepth="uint";break;case Int32Array:r.rawDepth="int";break;case Float32Array:r.rawDepth="float";break;case Float64Array:r.rawDepth="double";break;default:r.rawDepth="uchar";break}else throw new Error("Expected width, height and channels for raw pixel input");if(c.defined(t.animated))if(c.bool(t.animated))r.pages=t.animated?-1:1;else throw c.invalidParameterError("animated","boolean",t.animated);if(c.defined(t.pages))if(c.integer(t.pages)&&c.inRange(t.pages,-1,1e5))r.pages=t.pages;else throw c.invalidParameterError("pages","integer between -1 and 100000",t.pages);if(c.defined(t.page))if(c.integer(t.page)&&c.inRange(t.page,0,1e5))r.page=t.page;else throw c.invalidParameterError("page","integer between 0 and 100000",t.page);if(c.defined(t.level))if(c.integer(t.level)&&c.inRange(t.level,0,256))r.level=t.level;else throw c.invalidParameterError("level","integer between 0 and 256",t.level);if(c.defined(t.subifd))if(c.integer(t.subifd)&&c.inRange(t.subifd,-1,1e5))r.subifd=t.subifd;else throw c.invalidParameterError("subifd","integer between -1 and 100000",t.subifd);if(c.defined(t.create))if(c.object(t.create)&&c.integer(t.create.width)&&t.create.width>0&&c.integer(t.create.height)&&t.create.height>0&&c.integer(t.create.channels)){if(r.createWidth=t.create.width,r.createHeight=t.create.height,r.createChannels=t.create.channels,c.defined(t.create.noise)){if(!c.object(t.create.noise))throw new Error("Expected noise to be an object");if(!c.inArray(t.create.noise.type,["gaussian"]))throw new Error("Only gaussian noise is supported at the moment");if(!c.inRange(t.create.channels,1,4))throw c.invalidParameterError("create.channels","number between 1 and 4",t.create.channels);if(r.createNoiseType=t.create.noise.type,c.number(t.create.noise.mean)&&c.inRange(t.create.noise.mean,0,1e4))r.createNoiseMean=t.create.noise.mean;else throw c.invalidParameterError("create.noise.mean","number between 0 and 10000",t.create.noise.mean);if(c.number(t.create.noise.sigma)&&c.inRange(t.create.noise.sigma,0,1e4))r.createNoiseSigma=t.create.noise.sigma;else throw c.invalidParameterError("create.noise.sigma","number between 0 and 10000",t.create.noise.sigma)}else if(c.defined(t.create.background)){if(!c.inRange(t.create.channels,3,4))throw c.invalidParameterError("create.channels","number between 3 and 4",t.create.channels);const o=vo(t.create.background);r.createBackground=[o.red(),o.green(),o.blue(),Math.round(o.alpha()*255)]}else throw new Error("Expected valid noise or background to create a new input image");delete r.buffer}else throw new Error("Expected valid width, height and channels to create a new input image");if(c.defined(t.text))if(c.object(t.text)&&c.string(t.text.text)){if(r.textValue=t.text.text,c.defined(t.text.height)&&c.defined(t.text.dpi))throw new Error("Expected only one of dpi or height");if(c.defined(t.text.font))if(c.string(t.text.font))r.textFont=t.text.font;else throw c.invalidParameterError("text.font","string",t.text.font);if(c.defined(t.text.fontfile))if(c.string(t.text.fontfile))r.textFontfile=t.text.fontfile;else throw c.invalidParameterError("text.fontfile","string",t.text.fontfile);if(c.defined(t.text.width))if(c.integer(t.text.width)&&t.text.width>0)r.textWidth=t.text.width;else throw c.invalidParameterError("text.width","positive integer",t.text.width);if(c.defined(t.text.height))if(c.integer(t.text.height)&&t.text.height>0)r.textHeight=t.text.height;else throw c.invalidParameterError("text.height","positive integer",t.text.height);if(c.defined(t.text.align))if(c.string(t.text.align)&&c.string(this.constructor.align[t.text.align]))r.textAlign=this.constructor.align[t.text.align];else throw c.invalidParameterError("text.align","valid alignment",t.text.align);if(c.defined(t.text.justify))if(c.bool(t.text.justify))r.textJustify=t.text.justify;else throw c.invalidParameterError("text.justify","boolean",t.text.justify);if(c.defined(t.text.dpi))if(c.integer(t.text.dpi)&&c.inRange(t.text.dpi,1,1e6))r.textDpi=t.text.dpi;else throw c.invalidParameterError("text.dpi","integer between 1 and 1000000",t.text.dpi);if(c.defined(t.text.rgba))if(c.bool(t.text.rgba))r.textRgba=t.text.rgba;else throw c.invalidParameterError("text.rgba","bool",t.text.rgba);if(c.defined(t.text.spacing))if(c.integer(t.text.spacing)&&c.inRange(t.text.spacing,-1e6,1e6))r.textSpacing=t.text.spacing;else throw c.invalidParameterError("text.spacing","integer between -1000000 and 1000000",t.text.spacing);if(c.defined(t.text.wrap))if(c.string(t.text.wrap)&&c.inArray(t.text.wrap,["word","char","word-char","none"]))r.textWrap=t.text.wrap;else throw c.invalidParameterError("text.wrap","one of: word, char, word-char, none",t.text.wrap);delete r.buffer}else throw new Error("Expected a valid string to create an image with text.")}else if(c.defined(t))throw new Error("Invalid input options "+t);return r}function yo(e,t,i){Array.isArray(this.options.input.buffer)?c.buffer(e)?(this.options.input.buffer.length===0&&this.on("finish",()=>{this.streamInFinished=!0}),this.options.input.buffer.push(e),i()):i(new Error("Non-Buffer data on Writable Stream")):i(new Error("Unexpected data on Writable Stream"))}function xo(){this._isStreamInput()&&(this.options.input.buffer=Buffer.concat(this.options.input.buffer))}function Po(){return Array.isArray(this.options.input.buffer)}function Oo(e){const t=Error();return c.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),Y.metadata(this.options,(i,r)=>{i?e(c.nativeError(i,t)):e(null,r)})}):Y.metadata(this.options,(i,r)=>{i?e(c.nativeError(i,t)):e(null,r)}),this):this._isStreamInput()?new Promise((i,r)=>{const o=()=>{this._flattenBufferIn(),Y.metadata(this.options,(a,l)=>{a?r(c.nativeError(a,t)):i(l)})};this.writableFinished?o():this.once("finish",o)}):new Promise((i,r)=>{Y.metadata(this.options,(o,a)=>{o?r(c.nativeError(o,t)):i(a)})})}function ko(e){const t=Error();return c.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),Y.stats(this.options,(i,r)=>{i?e(c.nativeError(i,t)):e(null,r)})}):Y.stats(this.options,(i,r)=>{i?e(c.nativeError(i,t)):e(null,r)}),this):this._isStreamInput()?new Promise((i,r)=>{this.on("finish",function(){this._flattenBufferIn(),Y.stats(this.options,(o,a)=>{o?r(c.nativeError(o,t)):i(a)})})}):new Promise((i,r)=>{Y.stats(this.options,(o,a)=>{o?r(c.nativeError(o,t)):i(a)})})}var Ro=function(e){Object.assign(e.prototype,{_inputOptionsFromObject:ni,_createInputDescriptor:Eo,_write:yo,_flattenBufferIn:xo,_isStreamInput:Po,metadata:Oo,stats:ko}),e.align=wo};const m=W,oi={center:0,centre:0,north:1,east:2,south:3,west:4,northeast:5,southeast:6,southwest:7,northwest:8},ai={top:1,right:2,bottom:3,left:4,"right top":5,"right bottom":6,"left bottom":7,"left top":8},si={background:"background",copy:"copy",repeat:"repeat",mirror:"mirror"},li={entropy:16,attention:17},tt={nearest:"nearest",linear:"linear",cubic:"cubic",mitchell:"mitchell",lanczos2:"lanczos2",lanczos3:"lanczos3"},Io={contain:"contain",cover:"cover",fill:"fill",inside:"inside",outside:"outside"},jo={contain:"embed",cover:"crop",fill:"ignore_aspect",inside:"max",outside:"min"};function it(e){return e.angle%360!==0||e.useExifOrientation===!0||e.rotationAngle!==0}function Te(e){return e.width!==-1||e.height!==-1}function Ao(e,t,i){if(Te(this.options)&&this.options.debuglog("ignoring previous resize options"),this.options.widthPost!==-1&&this.options.debuglog("operation order will be: extract, resize, extract"),m.defined(e))if(m.object(e)&&!m.defined(i))i=e;else if(m.integer(e)&&e>0)this.options.width=e;else throw m.invalidParameterError("width","positive integer",e);else this.options.width=-1;if(m.defined(t))if(m.integer(t)&&t>0)this.options.height=t;else throw m.invalidParameterError("height","positive integer",t);else this.options.height=-1;if(m.object(i)){if(m.defined(i.width))if(m.integer(i.width)&&i.width>0)this.options.width=i.width;else throw m.invalidParameterError("width","positive integer",i.width);if(m.defined(i.height))if(m.integer(i.height)&&i.height>0)this.options.height=i.height;else throw m.invalidParameterError("height","positive integer",i.height);if(m.defined(i.fit)){const r=jo[i.fit];if(m.string(r))this.options.canvas=r;else throw m.invalidParameterError("fit","valid fit",i.fit)}if(m.defined(i.position)){const r=m.integer(i.position)?i.position:li[i.position]||ai[i.position]||oi[i.position];if(m.integer(r)&&(m.inRange(r,0,8)||m.inRange(r,16,17)))this.options.position=r;else throw m.invalidParameterError("position","valid position/gravity/strategy",i.position)}if(this._setBackgroundColourOption("resizeBackground",i.background),m.defined(i.kernel))if(m.string(tt[i.kernel]))this.options.kernel=tt[i.kernel];else throw m.invalidParameterError("kernel","valid kernel name",i.kernel);m.defined(i.withoutEnlargement)&&this._setBooleanOption("withoutEnlargement",i.withoutEnlargement),m.defined(i.withoutReduction)&&this._setBooleanOption("withoutReduction",i.withoutReduction),m.defined(i.fastShrinkOnLoad)&&this._setBooleanOption("fastShrinkOnLoad",i.fastShrinkOnLoad)}return it(this.options)&&Te(this.options)&&(this.options.rotateBeforePreExtract=!0),this}function $o(e){if(m.integer(e)&&e>0)this.options.extendTop=e,this.options.extendBottom=e,this.options.extendLeft=e,this.options.extendRight=e;else if(m.object(e)){if(m.defined(e.top))if(m.integer(e.top)&&e.top>=0)this.options.extendTop=e.top;else throw m.invalidParameterError("top","positive integer",e.top);if(m.defined(e.bottom))if(m.integer(e.bottom)&&e.bottom>=0)this.options.extendBottom=e.bottom;else throw m.invalidParameterError("bottom","positive integer",e.bottom);if(m.defined(e.left))if(m.integer(e.left)&&e.left>=0)this.options.extendLeft=e.left;else throw m.invalidParameterError("left","positive integer",e.left);if(m.defined(e.right))if(m.integer(e.right)&&e.right>=0)this.options.extendRight=e.right;else throw m.invalidParameterError("right","positive integer",e.right);if(this._setBackgroundColourOption("extendBackground",e.background),m.defined(e.extendWith))if(m.string(si[e.extendWith]))this.options.extendWith=si[e.extendWith];else throw m.invalidParameterError("extendWith","one of: background, copy, repeat, mirror",e.extendWith)}else throw m.invalidParameterError("extend","integer or object",e);return this}function Lo(e){const t=Te(this.options)||this.options.widthPre!==-1?"Post":"Pre";return this.options[`width${t}`]!==-1&&this.options.debuglog("ignoring previous extract options"),["left","top","width","height"].forEach(function(i){const r=e[i];if(m.integer(r)&&r>=0)this.options[i+(i==="left"||i==="top"?"Offset":"")+t]=r;else throw m.invalidParameterError(i,"integer",r)},this),it(this.options)&&!Te(this.options)&&(this.options.widthPre===-1||this.options.widthPost===-1)&&(this.options.rotateBeforePreExtract=!0),this}function So(e){if(this.options.trimThreshold=10,m.defined(e))if(m.object(e)){if(m.defined(e.background)&&this._setBackgroundColourOption("trimBackground",e.background),m.defined(e.threshold))if(m.number(e.threshold)&&e.threshold>=0)this.options.trimThreshold=e.threshold;else throw m.invalidParameterError("threshold","positive number",e.threshold);m.defined(e.lineArt)&&this._setBooleanOption("trimLineArt",e.lineArt)}else throw m.invalidParameterError("trim","object",e);return it(this.options)&&(this.options.rotateBeforePreExtract=!0),this}var Mo=function(e){Object.assign(e.prototype,{resize:Ao,extend:$o,extract:Lo,trim:So}),e.gravity=oi,e.strategy=li,e.kernel=tt,e.fit=Io,e.position=ai};const I=W,rt={clear:"clear",source:"source",over:"over",in:"in",out:"out",atop:"atop",dest:"dest","dest-over":"dest-over","dest-in":"dest-in","dest-out":"dest-out","dest-atop":"dest-atop",xor:"xor",add:"add",saturate:"saturate",multiply:"multiply",screen:"screen",overlay:"overlay",darken:"darken",lighten:"lighten","colour-dodge":"colour-dodge","color-dodge":"colour-dodge","colour-burn":"colour-burn","color-burn":"colour-burn","hard-light":"hard-light","soft-light":"soft-light",difference:"difference",exclusion:"exclusion"};function No(e){if(!Array.isArray(e))throw I.invalidParameterError("images to composite","array",e);return this.options.composite=e.map(t=>{if(!I.object(t))throw I.invalidParameterError("image to composite","object",t);const i=this._inputOptionsFromObject(t),r={input:this._createInputDescriptor(t.input,i,{allowStream:!1}),blend:"over",tile:!1,left:0,top:0,hasOffset:!1,gravity:0,premultiplied:!1};if(I.defined(t.blend))if(I.string(rt[t.blend]))r.blend=rt[t.blend];else throw I.invalidParameterError("blend","valid blend name",t.blend);if(I.defined(t.tile))if(I.bool(t.tile))r.tile=t.tile;else throw I.invalidParameterError("tile","boolean",t.tile);if(I.defined(t.left))if(I.integer(t.left))r.left=t.left;else throw I.invalidParameterError("left","integer",t.left);if(I.defined(t.top))if(I.integer(t.top))r.top=t.top;else throw I.invalidParameterError("top","integer",t.top);if(I.defined(t.top)!==I.defined(t.left))throw new Error("Expected both left and top to be set");if(r.hasOffset=I.integer(t.top)&&I.integer(t.left),I.defined(t.gravity))if(I.integer(t.gravity)&&I.inRange(t.gravity,0,8))r.gravity=t.gravity;else if(I.string(t.gravity)&&I.integer(this.constructor.gravity[t.gravity]))r.gravity=this.constructor.gravity[t.gravity];else throw I.invalidParameterError("gravity","valid gravity",t.gravity);if(I.defined(t.premultiplied))if(I.bool(t.premultiplied))r.premultiplied=t.premultiplied;else throw I.invalidParameterError("premultiplied","boolean",t.premultiplied);return r}),this}var To=function(e){e.prototype.composite=No,e.blend=rt};const Co=et,h=W;function Bo(e,t){if((this.options.useExifOrientation||this.options.angle||this.options.rotationAngle)&&this.options.debuglog("ignoring previous rotate options"),!h.defined(e))this.options.useExifOrientation=!0;else if(h.integer(e)&&!(e%90))this.options.angle=e;else if(h.number(e)){if(this.options.rotationAngle=e,h.object(t)&&t.background){const i=Co(t.background);this.options.rotationBackground=[i.red(),i.green(),i.blue(),Math.round(i.alpha()*255)]}}else throw h.invalidParameterError("angle","numeric",e);return this}function _o(e){return this.options.flip=h.bool(e)?e:!0,this}function Fo(e){return this.options.flop=h.bool(e)?e:!0,this}function Do(e,t){const i=[].concat(...e);if(i.length===4&&i.every(h.number))this.options.affineMatrix=i;else throw h.invalidParameterError("matrix","1x4 or 2x2 array",e);if(h.defined(t))if(h.object(t)){if(this._setBackgroundColourOption("affineBackground",t.background),h.defined(t.idx))if(h.number(t.idx))this.options.affineIdx=t.idx;else throw h.invalidParameterError("options.idx","number",t.idx);if(h.defined(t.idy))if(h.number(t.idy))this.options.affineIdy=t.idy;else throw h.invalidParameterError("options.idy","number",t.idy);if(h.defined(t.odx))if(h.number(t.odx))this.options.affineOdx=t.odx;else throw h.invalidParameterError("options.odx","number",t.odx);if(h.defined(t.ody))if(h.number(t.ody))this.options.affineOdy=t.ody;else throw h.invalidParameterError("options.ody","number",t.ody);if(h.defined(t.interpolator))if(h.inArray(t.interpolator,Object.values(this.constructor.interpolators)))this.options.affineInterpolator=t.interpolator;else throw h.invalidParameterError("options.interpolator","valid interpolator name",t.interpolator)}else throw h.invalidParameterError("options","object",t);return this}function zo(e,t,i){if(!h.defined(e))this.options.sharpenSigma=-1;else if(h.bool(e))this.options.sharpenSigma=e?-1:0;else if(h.number(e)&&h.inRange(e,.01,1e4)){if(this.options.sharpenSigma=e,h.defined(t))if(h.number(t)&&h.inRange(t,0,1e4))this.options.sharpenM1=t;else throw h.invalidParameterError("flat","number between 0 and 10000",t);if(h.defined(i))if(h.number(i)&&h.inRange(i,0,1e4))this.options.sharpenM2=i;else throw h.invalidParameterError("jagged","number between 0 and 10000",i)}else if(h.plainObject(e)){if(h.number(e.sigma)&&h.inRange(e.sigma,1e-6,10))this.options.sharpenSigma=e.sigma;else throw h.invalidParameterError("options.sigma","number between 0.000001 and 10",e.sigma);if(h.defined(e.m1))if(h.number(e.m1)&&h.inRange(e.m1,0,1e6))this.options.sharpenM1=e.m1;else throw h.invalidParameterError("options.m1","number between 0 and 1000000",e.m1);if(h.defined(e.m2))if(h.number(e.m2)&&h.inRange(e.m2,0,1e6))this.options.sharpenM2=e.m2;else throw h.invalidParameterError("options.m2","number between 0 and 1000000",e.m2);if(h.defined(e.x1))if(h.number(e.x1)&&h.inRange(e.x1,0,1e6))this.options.sharpenX1=e.x1;else throw h.invalidParameterError("options.x1","number between 0 and 1000000",e.x1);if(h.defined(e.y2))if(h.number(e.y2)&&h.inRange(e.y2,0,1e6))this.options.sharpenY2=e.y2;else throw h.invalidParameterError("options.y2","number between 0 and 1000000",e.y2);if(h.defined(e.y3))if(h.number(e.y3)&&h.inRange(e.y3,0,1e6))this.options.sharpenY3=e.y3;else throw h.invalidParameterError("options.y3","number between 0 and 1000000",e.y3)}else throw h.invalidParameterError("sigma","number between 0.01 and 10000",e);return this}function qo(e){if(!h.defined(e))this.options.medianSize=3;else if(h.integer(e)&&h.inRange(e,1,1e3))this.options.medianSize=e;else throw h.invalidParameterError("size","integer between 1 and 1000",e);return this}function Go(e){if(!h.defined(e))this.options.blurSigma=-1;else if(h.bool(e))this.options.blurSigma=e?-1:0;else if(h.number(e)&&h.inRange(e,.3,1e3))this.options.blurSigma=e;else throw h.invalidParameterError("sigma","number between 0.3 and 1000",e);return this}function Uo(e){return this.options.flatten=h.bool(e)?e:!0,h.object(e)&&this._setBackgroundColourOption("flattenBackground",e.background),this}function Wo(){return this.options.unflatten=!0,this}function Ho(e,t){if(!h.defined(e))this.options.gamma=2.2;else if(h.number(e)&&h.inRange(e,1,3))this.options.gamma=e;else throw h.invalidParameterError("gamma","number between 1.0 and 3.0",e);if(!h.defined(t))this.options.gammaOut=this.options.gamma;else if(h.number(t)&&h.inRange(t,1,3))this.options.gammaOut=t;else throw h.invalidParameterError("gammaOut","number between 1.0 and 3.0",t);return this}function Xo(e){if(this.options.negate=h.bool(e)?e:!0,h.plainObject(e)&&"alpha"in e)if(h.bool(e.alpha))this.options.negateAlpha=e.alpha;else throw h.invalidParameterError("alpha","should be boolean value",e.alpha);return this}function Vo(e){if(h.plainObject(e)){if(h.defined(e.lower))if(h.number(e.lower)&&h.inRange(e.lower,0,99))this.options.normaliseLower=e.lower;else throw h.invalidParameterError("lower","number between 0 and 99",e.lower);if(h.defined(e.upper))if(h.number(e.upper)&&h.inRange(e.upper,1,100))this.options.normaliseUpper=e.upper;else throw h.invalidParameterError("upper","number between 1 and 100",e.upper)}if(this.options.normaliseLower>=this.options.normaliseUpper)throw h.invalidParameterError("range","lower to be less than upper",`${this.options.normaliseLower} >= ${this.options.normaliseUpper}`);return this.options.normalise=!0,this}function Qo(e){return this.normalise(e)}function Jo(e){if(h.plainObject(e)){if(h.integer(e.width)&&e.width>0)this.options.claheWidth=e.width;else throw h.invalidParameterError("width","integer greater than zero",e.width);if(h.integer(e.height)&&e.height>0)this.options.claheHeight=e.height;else throw h.invalidParameterError("height","integer greater than zero",e.height);if(h.defined(e.maxSlope))if(h.integer(e.maxSlope)&&h.inRange(e.maxSlope,0,100))this.options.claheMaxSlope=e.maxSlope;else throw h.invalidParameterError("maxSlope","integer between 0 and 100",e.maxSlope)}else throw h.invalidParameterError("options","plain object",e);return this}function Yo(e){if(!h.object(e)||!Array.isArray(e.kernel)||!h.integer(e.width)||!h.integer(e.height)||!h.inRange(e.width,3,1001)||!h.inRange(e.height,3,1001)||e.height*e.width!==e.kernel.length)throw new Error("Invalid convolution kernel");return h.integer(e.scale)||(e.scale=e.kernel.reduce(function(t,i){return t+i},0)),e.scale<1&&(e.scale=1),h.integer(e.offset)||(e.offset=0),this.options.convKernel=e,this}function Ko(e,t){if(!h.defined(e))this.options.threshold=128;else if(h.bool(e))this.options.threshold=e?128:0;else if(h.integer(e)&&h.inRange(e,0,255))this.options.threshold=e;else throw h.invalidParameterError("threshold","integer between 0 and 255",e);return!h.object(t)||t.greyscale===!0||t.grayscale===!0?this.options.thresholdGrayscale=!0:this.options.thresholdGrayscale=!1,this}function Zo(e,t,i){if(this.options.boolean=this._createInputDescriptor(e,i),h.string(t)&&h.inArray(t,["and","or","eor"]))this.options.booleanOp=t;else throw h.invalidParameterError("operator","one of: and, or, eor",t);return this}function ea(e,t){if(!h.defined(e)&&h.number(t)?e=1:h.number(e)&&!h.defined(t)&&(t=0),!h.defined(e))this.options.linearA=[];else if(h.number(e))this.options.linearA=[e];else if(Array.isArray(e)&&e.length&&e.every(h.number))this.options.linearA=e;else throw h.invalidParameterError("a","number or array of numbers",e);if(!h.defined(t))this.options.linearB=[];else if(h.number(t))this.options.linearB=[t];else if(Array.isArray(t)&&t.length&&t.every(h.number))this.options.linearB=t;else throw h.invalidParameterError("b","number or array of numbers",t);if(this.options.linearA.length!==this.options.linearB.length)throw new Error("Expected a and b to be arrays of the same length");return this}function ta(e){if(!Array.isArray(e)||e.length!==3||e[0].length!==3||e[1].length!==3||e[2].length!==3)throw new Error("Invalid recombination matrix");return this.options.recombMatrix=[e[0][0],e[0][1],e[0][2],e[1][0],e[1][1],e[1][2],e[2][0],e[2][1],e[2][2]].map(Number),this}function ia(e){if(!h.plainObject(e))throw h.invalidParameterError("options","plain object",e);if("brightness"in e)if(h.number(e.brightness)&&e.brightness>=0)this.options.brightness=e.brightness;else throw h.invalidParameterError("brightness","number above zero",e.brightness);if("saturation"in e)if(h.number(e.saturation)&&e.saturation>=0)this.options.saturation=e.saturation;else throw h.invalidParameterError("saturation","number above zero",e.saturation);if("hue"in e)if(h.integer(e.hue))this.options.hue=e.hue%360;else throw h.invalidParameterError("hue","number",e.hue);if("lightness"in e)if(h.number(e.lightness))this.options.lightness=e.lightness;else throw h.invalidParameterError("lightness","number",e.lightness);return this}var ra=function(e){Object.assign(e.prototype,{rotate:Bo,flip:_o,flop:Fo,affine:Do,sharpen:zo,median:qo,blur:Go,flatten:Uo,unflatten:Wo,gamma:Ho,negate:Xo,normalise:Vo,normalize:Qo,clahe:Jo,convolve:Yo,threshold:Ko,boolean:Zo,linear:ea,recomb:ta,modulate:ia})};const na=et,H=W,hi={multiband:"multiband","b-w":"b-w",bw:"b-w",cmyk:"cmyk",srgb:"srgb"};function oa(e){return this._setBackgroundColourOption("tint",e),this}function aa(e){return this.options.greyscale=H.bool(e)?e:!0,this}function sa(e){return this.greyscale(e)}function la(e){if(!H.string(e))throw H.invalidParameterError("colourspace","string",e);return this.options.colourspacePipeline=e,this}function ha(e){return this.pipelineColourspace(e)}function ca(e){if(!H.string(e))throw H.invalidParameterError("colourspace","string",e);return this.options.colourspace=e,this}function pa(e){return this.toColourspace(e)}function ua(e,t){if(H.defined(t))if(H.object(t)||H.string(t)){const i=na(t);this.options[e]=[i.red(),i.green(),i.blue(),Math.round(i.alpha()*255)]}else throw H.invalidParameterError("background","object or string",t)}var da=function(e){Object.assign(e.prototype,{tint:oa,greyscale:aa,grayscale:sa,pipelineColourspace:la,pipelineColorspace:ha,toColourspace:ca,toColorspace:pa,_setBackgroundColourOption:ua}),e.colourspace=hi,e.colorspace=hi};const q=W,fa={and:"and",or:"or",eor:"eor"};function ga(){return this.options.removeAlpha=!0,this}function ma(e){if(q.defined(e))if(q.number(e)&&q.inRange(e,0,1))this.options.ensureAlpha=e;else throw q.invalidParameterError("alpha","number between 0 and 1",e);else this.options.ensureAlpha=1;return this}function ba(e){const t={red:0,green:1,blue:2,alpha:3};if(Object.keys(t).includes(e)&&(e=t[e]),q.integer(e)&&q.inRange(e,0,4))this.options.extractChannel=e;else throw q.invalidParameterError("channel","integer or one of: red, green, blue, alpha",e);return this}function va(e,t){return Array.isArray(e)?e.forEach(function(i){this.options.joinChannelIn.push(this._createInputDescriptor(i,t))},this):this.options.joinChannelIn.push(this._createInputDescriptor(e,t)),this}function wa(e){if(q.string(e)&&q.inArray(e,["and","or","eor"]))this.options.bandBoolOp=e;else throw q.invalidParameterError("boolOp","one of: and, or, eor",e);return this}var Ea=function(e){Object.assign(e.prototype,{removeAlpha:ga,ensureAlpha:ma,extractChannel:ba,joinChannel:va,bandbool:wa}),e.bool=fa};const nt=U,n=W,de=Ve,ci=new Map([["heic","heif"],["heif","heif"],["avif","avif"],["jpeg","jpeg"],["jpg","jpeg"],["jpe","jpeg"],["tile","tile"],["dz","tile"],["png","png"],["raw","raw"],["tiff","tiff"],["tif","tiff"],["webp","webp"],["gif","gif"],["jp2","jp2"],["jpx","jp2"],["j2k","jp2"],["j2c","jp2"],["jxl","jxl"]]),ya=/\.(jp[2x]|j2[kc])$/i,pi=()=>new Error("JP2 output requires libvips with support for OpenJPEG"),ui=e=>1<<31-Math.clz32(Math.ceil(Math.log2(e)));function xa(e,t){let i;if(n.string(e)?n.string(this.options.input.file)&&nt.resolve(this.options.input.file)===nt.resolve(e)?i=new Error("Cannot use same file for input and output"):ya.test(nt.extname(e))&&!this.constructor.format.jp2k.output.file&&(i=pi()):i=new Error("Missing output file path"),i)if(n.fn(t))t(i);else return Promise.reject(i);else{this.options.fileOut=e;const r=Error();return this._pipeline(t,r)}return this}function Pa(e,t){n.object(e)?this._setBooleanOption("resolveWithObject",e.resolveWithObject):this.options.resolveWithObject&&(this.options.resolveWithObject=!1),this.options.fileOut="";const i=Error();return this._pipeline(n.fn(e)?e:t,i)}function Oa(){return this.options.keepMetadata|=1,this}function ka(e){if(n.object(e))for(const[t,i]of Object.entries(e))if(n.object(i))for(const[r,o]of Object.entries(i))if(n.string(o))this.options.withExif[`exif-${t.toLowerCase()}-${r}`]=o;else throw n.invalidParameterError(`${t}.${r}`,"string",o);else throw n.invalidParameterError(t,"object",i);else throw n.invalidParameterError("exif","object",e);return this.options.withExifMerge=!1,this.keepExif()}function Ra(e){return this.withExif(e),this.options.withExifMerge=!0,this}function Ia(){return this.options.keepMetadata|=8,this}function ja(e,t){if(n.string(e))this.options.withIccProfile=e;else throw n.invalidParameterError("icc","string",e);if(this.keepIccProfile(),n.object(t)&&n.defined(t.attach))if(n.bool(t.attach))t.attach||(this.options.keepMetadata&=-9);else throw n.invalidParameterError("attach","boolean",t.attach);return this}function Aa(){return this.options.keepMetadata=31,this}function $a(e){if(this.keepMetadata(),this.withIccProfile("srgb"),n.object(e)){if(n.defined(e.orientation))if(n.integer(e.orientation)&&n.inRange(e.orientation,1,8))this.options.withMetadataOrientation=e.orientation;else throw n.invalidParameterError("orientation","integer between 1 and 8",e.orientation);if(n.defined(e.density))if(n.number(e.density)&&e.density>0)this.options.withMetadataDensity=e.density;else throw n.invalidParameterError("density","positive number",e.density);n.defined(e.icc)&&this.withIccProfile(e.icc),n.defined(e.exif)&&this.withExifMerge(e.exif)}return this}function La(e,t){const i=ci.get((n.object(e)&&n.string(e.id)?e.id:e).toLowerCase());if(!i)throw n.invalidParameterError("format",`one of: ${[...ci.keys()].join(", ")}`,e);return this[i](t)}function Sa(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.jpegQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.progressive)&&this._setBooleanOption("jpegProgressive",e.progressive),n.defined(e.chromaSubsampling))if(n.string(e.chromaSubsampling)&&n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jpegChromaSubsampling=e.chromaSubsampling;else throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);const t=n.bool(e.optimizeCoding)?e.optimizeCoding:e.optimiseCoding;if(n.defined(t)&&this._setBooleanOption("jpegOptimiseCoding",t),n.defined(e.mozjpeg))if(n.bool(e.mozjpeg))e.mozjpeg&&(this.options.jpegTrellisQuantisation=!0,this.options.jpegOvershootDeringing=!0,this.options.jpegOptimiseScans=!0,this.options.jpegProgressive=!0,this.options.jpegQuantisationTable=3);else throw n.invalidParameterError("mozjpeg","boolean",e.mozjpeg);const i=n.bool(e.trellisQuantization)?e.trellisQuantization:e.trellisQuantisation;n.defined(i)&&this._setBooleanOption("jpegTrellisQuantisation",i),n.defined(e.overshootDeringing)&&this._setBooleanOption("jpegOvershootDeringing",e.overshootDeringing);const r=n.bool(e.optimizeScans)?e.optimizeScans:e.optimiseScans;n.defined(r)&&(this._setBooleanOption("jpegOptimiseScans",r),r&&(this.options.jpegProgressive=!0));const o=n.number(e.quantizationTable)?e.quantizationTable:e.quantisationTable;if(n.defined(o))if(n.integer(o)&&n.inRange(o,0,8))this.options.jpegQuantisationTable=o;else throw n.invalidParameterError("quantisationTable","integer between 0 and 8",o)}return this._updateFormatOut("jpeg",e)}function Ma(e){if(n.object(e)){if(n.defined(e.progressive)&&this._setBooleanOption("pngProgressive",e.progressive),n.defined(e.compressionLevel))if(n.integer(e.compressionLevel)&&n.inRange(e.compressionLevel,0,9))this.options.pngCompressionLevel=e.compressionLevel;else throw n.invalidParameterError("compressionLevel","integer between 0 and 9",e.compressionLevel);n.defined(e.adaptiveFiltering)&&this._setBooleanOption("pngAdaptiveFiltering",e.adaptiveFiltering);const t=e.colours||e.colors;if(n.defined(t))if(n.integer(t)&&n.inRange(t,2,256))this.options.pngBitdepth=ui(t);else throw n.invalidParameterError("colours","integer between 2 and 256",t);if(n.defined(e.palette)?this._setBooleanOption("pngPalette",e.palette):[e.quality,e.effort,e.colours,e.colors,e.dither].some(n.defined)&&this._setBooleanOption("pngPalette",!0),this.options.pngPalette){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,0,100))this.options.pngQuality=e.quality;else throw n.invalidParameterError("quality","integer between 0 and 100",e.quality);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,1,10))this.options.pngEffort=e.effort;else throw n.invalidParameterError("effort","integer between 1 and 10",e.effort);if(n.defined(e.dither))if(n.number(e.dither)&&n.inRange(e.dither,0,1))this.options.pngDither=e.dither;else throw n.invalidParameterError("dither","number between 0.0 and 1.0",e.dither)}}return this._updateFormatOut("png",e)}function Na(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.webpQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.alphaQuality))if(n.integer(e.alphaQuality)&&n.inRange(e.alphaQuality,0,100))this.options.webpAlphaQuality=e.alphaQuality;else throw n.invalidParameterError("alphaQuality","integer between 0 and 100",e.alphaQuality);if(n.defined(e.lossless)&&this._setBooleanOption("webpLossless",e.lossless),n.defined(e.nearLossless)&&this._setBooleanOption("webpNearLossless",e.nearLossless),n.defined(e.smartSubsample)&&this._setBooleanOption("webpSmartSubsample",e.smartSubsample),n.defined(e.preset))if(n.string(e.preset)&&n.inArray(e.preset,["default","photo","picture","drawing","icon","text"]))this.options.webpPreset=e.preset;else throw n.invalidParameterError("preset","one of: default, photo, picture, drawing, icon, text",e.preset);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,0,6))this.options.webpEffort=e.effort;else throw n.invalidParameterError("effort","integer between 0 and 6",e.effort);n.defined(e.minSize)&&this._setBooleanOption("webpMinSize",e.minSize),n.defined(e.mixed)&&this._setBooleanOption("webpMixed",e.mixed)}return di(e,this.options),this._updateFormatOut("webp",e)}function Ta(e){if(n.object(e)){n.defined(e.reuse)&&this._setBooleanOption("gifReuse",e.reuse),n.defined(e.progressive)&&this._setBooleanOption("gifProgressive",e.progressive);const t=e.colours||e.colors;if(n.defined(t))if(n.integer(t)&&n.inRange(t,2,256))this.options.gifBitdepth=ui(t);else throw n.invalidParameterError("colours","integer between 2 and 256",t);if(n.defined(e.effort))if(n.number(e.effort)&&n.inRange(e.effort,1,10))this.options.gifEffort=e.effort;else throw n.invalidParameterError("effort","integer between 1 and 10",e.effort);if(n.defined(e.dither))if(n.number(e.dither)&&n.inRange(e.dither,0,1))this.options.gifDither=e.dither;else throw n.invalidParameterError("dither","number between 0.0 and 1.0",e.dither);if(n.defined(e.interFrameMaxError))if(n.number(e.interFrameMaxError)&&n.inRange(e.interFrameMaxError,0,32))this.options.gifInterFrameMaxError=e.interFrameMaxError;else throw n.invalidParameterError("interFrameMaxError","number between 0.0 and 32.0",e.interFrameMaxError);if(n.defined(e.interPaletteMaxError))if(n.number(e.interPaletteMaxError)&&n.inRange(e.interPaletteMaxError,0,256))this.options.gifInterPaletteMaxError=e.interPaletteMaxError;else throw n.invalidParameterError("interPaletteMaxError","number between 0.0 and 256.0",e.interPaletteMaxError)}return di(e,this.options),this._updateFormatOut("gif",e)}function Ca(e){if(!this.constructor.format.jp2k.output.buffer)throw pi();if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.jp2Quality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.lossless))if(n.bool(e.lossless))this.options.jp2Lossless=e.lossless;else throw n.invalidParameterError("lossless","boolean",e.lossless);if(n.defined(e.tileWidth))if(n.integer(e.tileWidth)&&n.inRange(e.tileWidth,1,32768))this.options.jp2TileWidth=e.tileWidth;else throw n.invalidParameterError("tileWidth","integer between 1 and 32768",e.tileWidth);if(n.defined(e.tileHeight))if(n.integer(e.tileHeight)&&n.inRange(e.tileHeight,1,32768))this.options.jp2TileHeight=e.tileHeight;else throw n.invalidParameterError("tileHeight","integer between 1 and 32768",e.tileHeight);if(n.defined(e.chromaSubsampling))if(n.string(e.chromaSubsampling)&&n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jp2ChromaSubsampling=e.chromaSubsampling;else throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling)}return this._updateFormatOut("jp2",e)}function di(e,t){if(n.object(e)&&n.defined(e.loop))if(n.integer(e.loop)&&n.inRange(e.loop,0,65535))t.loop=e.loop;else throw n.invalidParameterError("loop","integer between 0 and 65535",e.loop);if(n.object(e)&&n.defined(e.delay))if(n.integer(e.delay)&&n.inRange(e.delay,0,65535))t.delay=[e.delay];else if(Array.isArray(e.delay)&&e.delay.every(n.integer)&&e.delay.every(i=>n.inRange(i,0,65535)))t.delay=e.delay;else throw n.invalidParameterError("delay","integer or an array of integers between 0 and 65535",e.delay)}function Ba(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.tiffQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.bitdepth))if(n.integer(e.bitdepth)&&n.inArray(e.bitdepth,[1,2,4,8]))this.options.tiffBitdepth=e.bitdepth;else throw n.invalidParameterError("bitdepth","1, 2, 4 or 8",e.bitdepth);if(n.defined(e.tile)&&this._setBooleanOption("tiffTile",e.tile),n.defined(e.tileWidth))if(n.integer(e.tileWidth)&&e.tileWidth>0)this.options.tiffTileWidth=e.tileWidth;else throw n.invalidParameterError("tileWidth","integer greater than zero",e.tileWidth);if(n.defined(e.tileHeight))if(n.integer(e.tileHeight)&&e.tileHeight>0)this.options.tiffTileHeight=e.tileHeight;else throw n.invalidParameterError("tileHeight","integer greater than zero",e.tileHeight);if(n.defined(e.miniswhite)&&this._setBooleanOption("tiffMiniswhite",e.miniswhite),n.defined(e.pyramid)&&this._setBooleanOption("tiffPyramid",e.pyramid),n.defined(e.xres))if(n.number(e.xres)&&e.xres>0)this.options.tiffXres=e.xres;else throw n.invalidParameterError("xres","number greater than zero",e.xres);if(n.defined(e.yres))if(n.number(e.yres)&&e.yres>0)this.options.tiffYres=e.yres;else throw n.invalidParameterError("yres","number greater than zero",e.yres);if(n.defined(e.compression))if(n.string(e.compression)&&n.inArray(e.compression,["none","jpeg","deflate","packbits","ccittfax4","lzw","webp","zstd","jp2k"]))this.options.tiffCompression=e.compression;else throw n.invalidParameterError("compression","one of: none, jpeg, deflate, packbits, ccittfax4, lzw, webp, zstd, jp2k",e.compression);if(n.defined(e.predictor))if(n.string(e.predictor)&&n.inArray(e.predictor,["none","horizontal","float"]))this.options.tiffPredictor=e.predictor;else throw n.invalidParameterError("predictor","one of: none, horizontal, float",e.predictor);if(n.defined(e.resolutionUnit))if(n.string(e.resolutionUnit)&&n.inArray(e.resolutionUnit,["inch","cm"]))this.options.tiffResolutionUnit=e.resolutionUnit;else throw n.invalidParameterError("resolutionUnit","one of: inch, cm",e.resolutionUnit)}return this._updateFormatOut("tiff",e)}function _a(e){return this.heif({...e,compression:"av1"})}function Fa(e){if(n.object(e)){if(n.string(e.compression)&&n.inArray(e.compression,["av1","hevc"]))this.options.heifCompression=e.compression;else throw n.invalidParameterError("compression","one of: av1, hevc",e.compression);if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.heifQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.lossless))if(n.bool(e.lossless))this.options.heifLossless=e.lossless;else throw n.invalidParameterError("lossless","boolean",e.lossless);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,0,9))this.options.heifEffort=e.effort;else throw n.invalidParameterError("effort","integer between 0 and 9",e.effort);if(n.defined(e.chromaSubsampling))if(n.string(e.chromaSubsampling)&&n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.heifChromaSubsampling=e.chromaSubsampling;else throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);if(n.defined(e.bitdepth))if(n.integer(e.bitdepth)&&n.inArray(e.bitdepth,[8,10,12])){if(e.bitdepth!==8&&this.constructor.versions.heif)throw n.invalidParameterError("bitdepth when using prebuilt binaries",8,e.bitdepth);this.options.heifBitdepth=e.bitdepth}else throw n.invalidParameterError("bitdepth","8, 10 or 12",e.bitdepth)}else throw n.invalidParameterError("options","Object",e);return this._updateFormatOut("heif",e)}function Da(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.jxlDistance=e.quality>=30?.1+(100-e.quality)*.09:53/3e3*e.quality*e.quality-23/20*e.quality+25;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);else if(n.defined(e.distance))if(n.number(e.distance)&&n.inRange(e.distance,0,15))this.options.jxlDistance=e.distance;else throw n.invalidParameterError("distance","number between 0.0 and 15.0",e.distance);if(n.defined(e.decodingTier))if(n.integer(e.decodingTier)&&n.inRange(e.decodingTier,0,4))this.options.jxlDecodingTier=e.decodingTier;else throw n.invalidParameterError("decodingTier","integer between 0 and 4",e.decodingTier);if(n.defined(e.lossless))if(n.bool(e.lossless))this.options.jxlLossless=e.lossless;else throw n.invalidParameterError("lossless","boolean",e.lossless);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,3,9))this.options.jxlEffort=e.effort;else throw n.invalidParameterError("effort","integer between 3 and 9",e.effort)}return this._updateFormatOut("jxl",e)}function za(e){if(n.object(e)&&n.defined(e.depth))if(n.string(e.depth)&&n.inArray(e.depth,["char","uchar","short","ushort","int","uint","float","complex","double","dpcomplex"]))this.options.rawDepth=e.depth;else throw n.invalidParameterError("depth","one of: char, uchar, short, ushort, int, uint, float, complex, double, dpcomplex",e.depth);return this._updateFormatOut("raw")}function qa(e){if(n.object(e)){if(n.defined(e.size))if(n.integer(e.size)&&n.inRange(e.size,1,8192))this.options.tileSize=e.size;else throw n.invalidParameterError("size","integer between 1 and 8192",e.size);if(n.defined(e.overlap))if(n.integer(e.overlap)&&n.inRange(e.overlap,0,8192)){if(e.overlap>this.options.tileSize)throw n.invalidParameterError("overlap",`<= size (${this.options.tileSize})`,e.overlap);this.options.tileOverlap=e.overlap}else throw n.invalidParameterError("overlap","integer between 0 and 8192",e.overlap);if(n.defined(e.container))if(n.string(e.container)&&n.inArray(e.container,["fs","zip"]))this.options.tileContainer=e.container;else throw n.invalidParameterError("container","one of: fs, zip",e.container);if(n.defined(e.layout))if(n.string(e.layout)&&n.inArray(e.layout,["dz","google","iiif","iiif3","zoomify"]))this.options.tileLayout=e.layout;else throw n.invalidParameterError("layout","one of: dz, google, iiif, iiif3, zoomify",e.layout);if(n.defined(e.angle))if(n.integer(e.angle)&&!(e.angle%90))this.options.tileAngle=e.angle;else throw n.invalidParameterError("angle","positive/negative multiple of 90",e.angle);if(this._setBackgroundColourOption("tileBackground",e.background),n.defined(e.depth))if(n.string(e.depth)&&n.inArray(e.depth,["onepixel","onetile","one"]))this.options.tileDepth=e.depth;else throw n.invalidParameterError("depth","one of: onepixel, onetile, one",e.depth);if(n.defined(e.skipBlanks))if(n.integer(e.skipBlanks)&&n.inRange(e.skipBlanks,-1,65535))this.options.tileSkipBlanks=e.skipBlanks;else throw n.invalidParameterError("skipBlanks","integer between -1 and 255/65535",e.skipBlanks);else n.defined(e.layout)&&e.layout==="google"&&(this.options.tileSkipBlanks=5);const t=n.bool(e.center)?e.center:e.centre;if(n.defined(t)&&this._setBooleanOption("tileCentre",t),n.defined(e.id))if(n.string(e.id))this.options.tileId=e.id;else throw n.invalidParameterError("id","string",e.id);if(n.defined(e.basename))if(n.string(e.basename))this.options.tileBasename=e.basename;else throw n.invalidParameterError("basename","string",e.basename)}if(n.inArray(this.options.formatOut,["jpeg","png","webp"]))this.options.tileFormat=this.options.formatOut;else if(this.options.formatOut!=="input")throw n.invalidParameterError("format","one of: jpeg, png, webp",this.options.formatOut);return this._updateFormatOut("dz")}function Ga(e){if(!n.plainObject(e))throw n.invalidParameterError("options","object",e);if(n.integer(e.seconds)&&n.inRange(e.seconds,0,3600))this.options.timeoutSeconds=e.seconds;else throw n.invalidParameterError("seconds","integer between 0 and 3600",e.seconds);return this}function Ua(e,t){return n.object(t)&&t.force===!1||(this.options.formatOut=e),this}function Wa(e,t){if(n.bool(t))this.options[e]=t;else throw n.invalidParameterError(e,"boolean",t)}function Ha(){if(!this.options.streamOut){this.options.streamOut=!0;const e=Error();this._pipeline(void 0,e)}}function Xa(e,t){return typeof e=="function"?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),de.pipeline(this.options,(i,r,o)=>{i?e(n.nativeError(i,t)):e(null,r,o)})}):de.pipeline(this.options,(i,r,o)=>{i?e(n.nativeError(i,t)):e(null,r,o)}),this):this.options.streamOut?(this._isStreamInput()?(this.once("finish",()=>{this._flattenBufferIn(),de.pipeline(this.options,(i,r,o)=>{i?this.emit("error",n.nativeError(i,t)):(this.emit("info",o),this.push(r)),this.push(null),this.on("end",()=>this.emit("close"))})}),this.streamInFinished&&this.emit("finish")):de.pipeline(this.options,(i,r,o)=>{i?this.emit("error",n.nativeError(i,t)):(this.emit("info",o),this.push(r)),this.push(null),this.on("end",()=>this.emit("close"))}),this):this._isStreamInput()?new Promise((i,r)=>{this.once("finish",()=>{this._flattenBufferIn(),de.pipeline(this.options,(o,a,l)=>{o?r(n.nativeError(o,t)):this.options.resolveWithObject?i({data:a,info:l}):i(a)})})}):new Promise((i,r)=>{de.pipeline(this.options,(o,a,l)=>{o?r(n.nativeError(o,t)):this.options.resolveWithObject?i({data:a,info:l}):i(a)})})}var Va=function(e){Object.assign(e.prototype,{toFile:xa,toBuffer:Pa,keepExif:Oa,withExif:ka,withExifMerge:Ra,keepIccProfile:Ia,withIccProfile:ja,keepMetadata:Aa,withMetadata:$a,toFormat:La,jpeg:Sa,jp2:Ca,png:Ma,webp:Na,tiff:Ba,avif:_a,heif:Fa,jxl:Da,gif:Ta,raw:za,tile:qa,timeout:Ga,_updateFormatOut:Ua,_setBooleanOption:Wa,_read:Ha,_pipeline:Xa})};const Qa=U,Ce=_e,F=W,{runtimePlatformArch:Ja}=Vt,N=Ve,fi=Ja(),ot=N.libvipsVersion(),we=N.format();we.heif.output.alias=["avif","heic"],we.jpeg.output.alias=["jpe","jpg"],we.tiff.output.alias=["tif"],we.jp2k.output.alias=["j2c","j2k","jp2","jpx"];const Ya={nearest:"nearest",bilinear:"bilinear",bicubic:"bicubic",locallyBoundedBicubic:"lbb",nohalo:"nohalo",vertexSplitQuadraticBasisSpline:"vsqbs"};let Ee={vips:ot.semver};if(!ot.isGlobal)if(ot.isWasm)try{Ee=require("@img/sharp-wasm32/versions")}catch{}else try{Ee=ee(`@img/sharp-${fi}/versions`)}catch{try{Ee=ee(`@img/sharp-libvips-${fi}/versions`)}catch{}}Ee.sharp=_t.version;function gi(e){return F.bool(e)?e?N.cache(50,20,100):N.cache(0,0,0):F.object(e)?N.cache(e.memory,e.files,e.items):N.cache()}gi(!0);function Ka(e){return N.concurrency(F.integer(e)?e:null)}Ce.familySync()===Ce.GLIBC&&!N._isUsingJemalloc()?N.concurrency(1):Ce.familySync()===Ce.MUSL&&N.concurrency()===1024&&N.concurrency(U.availableParallelism());const Za=new Qa.EventEmitter;function es(){return N.counters()}function ts(e){return N.simd(F.bool(e)?e:null)}function is(e){if(F.object(e))if(Array.isArray(e.operation)&&e.operation.every(F.string))N.block(e.operation,!0);else throw F.invalidParameterError("operation","Array<string>",e.operation);else throw F.invalidParameterError("options","object",e)}function rs(e){if(F.object(e))if(Array.isArray(e.operation)&&e.operation.every(F.string))N.block(e.operation,!1);else throw F.invalidParameterError("operation","Array<string>",e.operation);else throw F.invalidParameterError("options","object",e)}var ns=function(e){e.cache=gi,e.concurrency=Ka,e.counters=es,e.simd=ts,e.format=we,e.interpolators=Ya,e.versions=Ee,e.queue=Za,e.block=is,e.unblock=rs};const X=Vn;Ro(X),Mo(X),To(X),ra(X),da(X),Ea(X),Va(X),ns(X);var os=X;const as=ki(os),ss=Object.freeze(Object.defineProperty({__proto__:null,default:as},Symbol.toStringTag,{value:"Module"}));export{ss as i};
