"use strict";(self.webpackChunkhigress_website=self.webpackChunkhigress_website||[]).push([[7426],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>k});var r=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,l=function(e,t){if(null==e)return{};var n,r,l={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=r.createContext({}),c=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,l=e.mdxType,a=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(n),m=l,k=p["".concat(s,".").concat(m)]||p[m]||d[m]||a;return n?r.createElement(k,o(o({ref:t},u),{},{components:n})):r.createElement(k,o({ref:t},u))}));function k(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var a=n.length,o=new Array(a);o[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[p]="string"==typeof e?e:l,o[1]=i;for(var c=2;c<a;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3177:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var r=n(7462),l=(n(7294),n(3905));const a={title:"request blocking",keywords:["higress","request block"],description:"Request blocking plug-in configuration reference"},o=void 0,i={unversionedId:"plugins/traffic/request-block",id:"plugins/traffic/request-block",title:"request blocking",description:"Request blocking plug-in configuration reference",source:"@site/i18n/en-us/docusaurus-plugin-content-docs/current/plugins/traffic/request-block.md",sourceDirName:"plugins/traffic",slug:"/plugins/traffic/request-block",permalink:"/en-us/docs/plugins/traffic/request-block",draft:!1,editUrl:"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/en-us/docusaurus-plugin-content-docs/current/plugins/traffic/request-block.md",tags:[],version:"current",frontMatter:{title:"request blocking",keywords:["higress","request block"],description:"Request blocking plug-in configuration reference"},sidebar:"docs",previous:{title:"de-graphql",permalink:"/en-us/docs/plugins/transformation/de-graphql"},next:{title:"Rate limiting based on Key",permalink:"/en-us/docs/plugins/traffic/key-rate-limit"}},s={},c=[{value:"Description",id:"description",level:2},{value:"Configuration Fields",id:"configuration-fields",level:2},{value:"Configuration Samples",id:"configuration-samples",level:2},{value:"Block Specific Request URLs",id:"block-specific-request-urls",level:3},{value:"Block Specific Request Headers",id:"block-specific-request-headers",level:3},{value:"Block Specific Request Bodies",id:"block-specific-request-bodies",level:3},{value:"Only Enable for Specific Routes or Domains",id:"only-enable-for-specific-routes-or-domains",level:3},{value:"Maximum Request Body Size Limitation",id:"maximum-request-body-size-limitation",level:2}],u={toc:c},p="wrapper";function d(e){let{components:t,...n}=e;return(0,l.kt)(p,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"description"},"Description"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"request-block")," plugin implements a request blocking function based on request characteristics such as URL and request header. It can be used to protect internal resources from unauthorized access."),(0,l.kt)("h2",{id:"configuration-fields"},"Configuration Fields"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Name"),(0,l.kt)("th",{parentName:"tr",align:null},"Type"),(0,l.kt)("th",{parentName:"tr",align:null},"Requirement"),(0,l.kt)("th",{parentName:"tr",align:null},"Default Value"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"block_urls"),(0,l.kt)("td",{parentName:"tr",align:null},"array of string"),(0,l.kt)("td",{parentName:"tr",align:null},"Optional. Choose one from following: ",(0,l.kt)("inlineCode",{parentName:"td"},"block_urls"),", ",(0,l.kt)("inlineCode",{parentName:"td"},"block_headers"),", ",(0,l.kt)("inlineCode",{parentName:"td"},"block_bodies")),(0,l.kt)("td",{parentName:"tr",align:null},"-"),(0,l.kt)("td",{parentName:"tr",align:null},"HTTP URLs to be blocked.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"block_headers"),(0,l.kt)("td",{parentName:"tr",align:null},"array of string"),(0,l.kt)("td",{parentName:"tr",align:null},"Optional. Choose one from following: ",(0,l.kt)("inlineCode",{parentName:"td"},"block_urls"),", ",(0,l.kt)("inlineCode",{parentName:"td"},"block_headers"),", ",(0,l.kt)("inlineCode",{parentName:"td"},"block_bodies")),(0,l.kt)("td",{parentName:"tr",align:null},"-"),(0,l.kt)("td",{parentName:"tr",align:null},"HTTP request headers to be blocked.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"block_bodies"),(0,l.kt)("td",{parentName:"tr",align:null},"array of string"),(0,l.kt)("td",{parentName:"tr",align:null},"Optional. Choose one from following: ",(0,l.kt)("inlineCode",{parentName:"td"},"block_urls")," ,",(0,l.kt)("inlineCode",{parentName:"td"},"block_headers"),", ",(0,l.kt)("inlineCode",{parentName:"td"},"block_bodies")),(0,l.kt)("td",{parentName:"tr",align:null},"-"),(0,l.kt)("td",{parentName:"tr",align:null},"HTTP request bodies to be blocked.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"blocked_code"),(0,l.kt)("td",{parentName:"tr",align:null},"number"),(0,l.kt)("td",{parentName:"tr",align:null},"Optional"),(0,l.kt)("td",{parentName:"tr",align:null},"403"),(0,l.kt)("td",{parentName:"tr",align:null},"HTTP response status code to be sent when corresponding request is blocked.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"blocked_message"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"Optional"),(0,l.kt)("td",{parentName:"tr",align:null},"-"),(0,l.kt)("td",{parentName:"tr",align:null},"HTTP response body to be sent when corresponding request is blocked.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"case_sensitive"),(0,l.kt)("td",{parentName:"tr",align:null},"bool"),(0,l.kt)("td",{parentName:"tr",align:null},"Optional"),(0,l.kt)("td",{parentName:"tr",align:null},"true"),(0,l.kt)("td",{parentName:"tr",align:null},"Whether to use case-senstive comparison when matching. Enabled by default.")))),(0,l.kt)("h2",{id:"configuration-samples"},"Configuration Samples"),(0,l.kt)("h3",{id:"block-specific-request-urls"},"Block Specific Request URLs"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"block_urls:\n- swagger.html\n- foo=bar\ncase_sensitive: false\n")),(0,l.kt)("p",null,"According to the configuration above, following requests will be blocked:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"curl http://example.com?foo=Bar\ncurl http://exmaple.com/Swagger.html\n")),(0,l.kt)("h3",{id:"block-specific-request-headers"},"Block Specific Request Headers"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"block_headers:\n- example-key\n- example-value\n")),(0,l.kt)("p",null,"According to the configuration above, following requests will be blocked:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"curl http://example.com -H 'example-key: 123'\ncurl http://exmaple.com -H 'my-header: example-value'\n")),(0,l.kt)("h3",{id:"block-specific-request-bodies"},"Block Specific Request Bodies"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'block_bodies:\n- "hello world"\ncase_sensitive: false\n')),(0,l.kt)("p",null,"According to the configuration above, following requests will be blocked:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"curl http://example.com -d 'Hello World'\ncurl http://exmaple.com -d 'hello world'\n")),(0,l.kt)("h3",{id:"only-enable-for-specific-routes-or-domains"},"Only Enable for Specific Routes or Domains"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'# Use _rules_ field for fine-grained rule configurations \n_rules_:\n# Rule 1: Match by route name\n- _match_route_:\n  - route-a\n  - route-b\n  block_bodies: \n  - "hello world"\n# Rule 2: Match by domain\n- _match_domain_:\n  - "*.example.com"\n  - test.com\n  block_urls: \n  - "swagger.html"\n  block_bodies:\n  - "hello world"\n')),(0,l.kt)("p",null,"In the rule sample of ",(0,l.kt)("inlineCode",{parentName:"p"},"_match_route_"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"route-a")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"route-b")," are the route names provided when creating a new gateway route. When the current route names matches the configuration, the rule following shall be applied.\nIn the rule sample of ",(0,l.kt)("inlineCode",{parentName:"p"},"_match_domain_"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"*.example.com")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"test.com")," are the domain names used for request matching. When the current domain name matches the configuration, the rule following shall be applied.\nAll rules shall be checked following the order of items in the ",(0,l.kt)("inlineCode",{parentName:"p"},"_rules_")," field, The first matched rule will be applied. All remained will be ignored."),(0,l.kt)("h2",{id:"maximum-request-body-size-limitation"},"Maximum Request Body Size Limitation"),(0,l.kt)("p",null,"When ",(0,l.kt)("inlineCode",{parentName:"p"},"block_bodies")," is configured, body matching shall only be performed when its size is smaller than 32MB. If not, and no ",(0,l.kt)("inlineCode",{parentName:"p"},"block_urls")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"block_headers")," configuration is matched, the request won't be blocked.\nWhen ",(0,l.kt)("inlineCode",{parentName:"p"},"block_bodies")," is configured, if the size of request body exceeds the global configuration of DownstreamConnectionBufferLimits, a ",(0,l.kt)("inlineCode",{parentName:"p"},"413 Payload Too Large")," response will be returned."))}d.isMDXComponent=!0}}]);