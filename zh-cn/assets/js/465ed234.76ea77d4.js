"use strict";(self.webpackChunkhigress_website=self.webpackChunkhigress_website||[]).push([[5299],{7407:n=>{n.exports=JSON.parse('{"blogPosts":[{"id":"/release-1.3","metadata":{"permalink":"/zh-cn/blog/release-1.3","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/release-1.3.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/release-1.3.md","title":"Higress \u5f00\u6e90\u4e00\u5468\u5e74\uff1a\u65b0\u7248\u672c\uff0c\u65b0\u6807\u51c6\uff0c\u65b0\u5de5\u5177\uff0c\u65b0\u5f81\u7a0b","description":"\u652f\u6301\u4e86 Gateway API \u6807\u51c6\uff0c\u8fd8\u6709\u5168\u65b0\u7684\u8fd0\u7ef4/\u5f00\u53d1\u5de5\u5177\uff0c\u4ee5\u53ca\u6211\u4eec\u65b0\u7684\u5f00\u6e90\u5f81\u7a0b","date":"2023-11-04T00:00:00.000Z","formattedDate":"2023\u5e7411\u67084\u65e5","tags":[],"readingTime":18.225,"hasTruncateMarker":false,"authors":[{"name":"\u6f84\u6f6d"}],"frontMatter":{"title":"Higress \u5f00\u6e90\u4e00\u5468\u5e74\uff1a\u65b0\u7248\u672c\uff0c\u65b0\u6807\u51c6\uff0c\u65b0\u5de5\u5177\uff0c\u65b0\u5f81\u7a0b","keywords":["higress","ingress","Gateway API"],"description":"\u652f\u6301\u4e86 Gateway API \u6807\u51c6\uff0c\u8fd8\u6709\u5168\u65b0\u7684\u8fd0\u7ef4/\u5f00\u53d1\u5de5\u5177\uff0c\u4ee5\u53ca\u6211\u4eec\u65b0\u7684\u5f00\u6e90\u5f81\u7a0b","author":"\u6f84\u6f6d","date":"2023-11-04T00:00:00.000Z"},"nextItem":{"title":"\u901a\u8fc7 Higress Wasm \u63d2\u4ef6 3 \u500d\u6027\u80fd\u5b9e\u73b0 Spring-cloud-gateway \u529f\u80fd","permalink":"/zh-cn/blog/plugin-transformer"}},"content":"## \u5386\u7a0b\u56de\u987e\\n![image](https://github.com/johnlanni/higress-group.github.io/assets/6763318/b5f3ee1b-d53a-4fbb-8d4a-82427ebdfe40)\\n\\nHigress \u5f00\u6e90\u4e00\u5e74\u65f6\u95f4\uff0c\u4e00\u5171\u53d1\u5e03\u4e86 18 \u4e2a release \u7248\u672c\uff0c\u6536\u83b7\u4e86 40 \u591a\u4f4d\u793e\u533a\u8d21\u732e\u8005\u548c 1800+ star\uff0c\u4e0a\u56fe\u662f\u8fd9\u4e00\u5e74\u8fc7\u6765\u8fbe\u6210\u7684\u4e00\u4e9b\u5173\u952e\u7684\u91cc\u7a0b\u7891\u3002\\n\\n\u524d\u9762\u534a\u5e74\u901a\u8fc7\u96c6\u6210\u5f00\u6e90\u751f\u6001\uff0c\u6253\u78e8\u5f00\u6e90\u7248\u672c\u7a33\u5b9a\u6027\uff0c\u5e76\u5728\u53d1\u5e03 1.0 GA \u7248\u672c\u540e\uff0c\u793e\u533a\u53c8\u9a6c\u4e0d\u505c\u8e44\u53d1\u5e03\u4e86 1.1 \u548c 1.2 \u4e24\u4e2a\u91cd\u8981\u7248\u672c\uff0c\u5b9e\u73b0\u4e86\u975e K8s \u90e8\u7f72\uff0cKnative \u9002\u914d\u7b49\u6838\u5fc3\u80fd\u529b\u3002\\n\\nHigress 1.3 \u7248\u672c\u5df2\u7ecf\u6b63\u5f0f\u53d1\u5e03\uff0c\u9664\u4e86\u589e\u52a0\u7684\u65b0\u529f\u80fd\uff0c\u5df2\u6709\u80fd\u529b\u4e5f\u5728\u5927\u91cf\u793e\u533a\u7528\u6237\u53cd\u9988\u7684\u8fc7\u7a0b\u4e2d\u4e0d\u65ad\u5b8c\u5584\u6539\u8fdb\uff0c\u8fd9\u4e2a\u7248\u672c\u540c\u65f6\u6807\u5fd7\u7740 1.x \u8fdb\u5165\u53ef\u4ee5\u5927\u89c4\u6a21\u751f\u4ea7\u4f7f\u7528\u7684\u72b6\u6001\u3002\\n\\n## \u65b0\u7248\u672c\uff1a\u529f\u80fd\u901f\u89c8\\n  \\n\u81ea\u53d1\u5e03 1.2 \u7248\u672c\u8fc7\u53bb\u4e86\u4e00\u4e2a\u591a\u6708\u65f6\u95f4\uff0c1.3 \u7248\u672c\u6b63\u5f0f\u53d1\u5e03\uff0c\u5e26\u6765\u4e24\u4e2a\u5168\u65b0\u80fd\u529b\uff1a\\n\\n- \u65b0\u6807\u51c6\uff1a\u652f\u6301\u6700\u65b0\u7248\u672c Gateway API \u6807\u51c6\uff0c\u5e76\u4e14\u5177\u5907\u4ece Ingress \u5e73\u6ed1\u6e10\u8fdb\u6f14\u8fdb\uff0c\u4ee5\u53ca\u5bf9\u63a5\u591a\u79cd\u670d\u52a1\u53d1\u73b0\u673a\u5236\u7684\u80fd\u529b\\n- \u65b0\u5de5\u5177\uff1a\u6b63\u5f0f release \u4e86 hgctl (Higress Crontroller) \u8fd9\u4e2a \\"All in one\\" \u7684\u65b0\u5de5\u5177\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u66ff\u4ee3 Helm \u5b9e\u73b0\u66f4\u7b80\u6613\u7684\u5b89\u88c5\uff0c\u8fd8\u63d0\u4f9b\u4e86 WASM \u63d2\u4ef6\u5f00\u53d1\u5de5\u5177\u5305\uff0c\u4ee5\u53ca\u7f51\u5173\u914d\u7f6e\u68c0\u67e5\u7b49\u4e30\u5bcc\u529f\u80fd\\n  \\n\u9664\u4e86\u8fd9\u4e24\u4e2a\u6838\u5fc3\u529f\u80fd\u5916\uff0c\u8fd8\u6709\u4e00\u4e9b\u5b9e\u7528\u529f\u80fd\uff1a\\n\\n1. \u63d0\u4f9b\u4e86 Higress Admin Java SDK\uff0c\u53ef\u4ee5\u7edf\u4e00\u5bf9\u63a5 K8s \u548c\u975e K8s \u73af\u5883\uff0c\u7ba1\u7406\u57df\u540d/\u8def\u7531\u7b49\u914d\u7f6e\\n2. \u63d0\u4f9b\u4e86 OIDC \u63d2\u4ef6\uff0c\u652f\u6301\u5bf9\u63a5 Keycloak/Okta \u7b49\u7b2c\u4e09\u65b9\u8eab\u4efd\u8ba4\u8bc1\u7cfb\u7edf\\n3. Higress Console \u7684\u6613\u7528\u6027\u548c\u5b89\u5168\u6027\u63d0\u5347\uff0c\u4e0d\u518d\u901a\u8fc7\u8def\u7531\u66b4\u9732\uff0c\u652f\u6301\u754c\u9762\u521d\u59cb\u5316/\u4fee\u6539\u5bc6\u7801\\n   \\n\u4e0e\u6b64\u540c\u65f6\uff0cHigress \u5f00\u6e90\u793e\u533a\u5df2\u7ecf\u5f00\u59cb\u51c6\u5907\u8e0f\u4e0a\u4e00\u6bb5\u5168\u65b0\u7684\u5f00\u6e90\u5f81\u7a0b...\\n\\n## \u65b0\u6807\u51c6\uff1a\u652f\u6301\u6700\u65b0\u7248 Gateway API\\n\\nGateway API \u5728 11 \u6708 1 \u65e5\u6b63\u5f0f\u53d1\u5e03\u4e86 1.0.0 \u7248\u672c\uff0c\u5176\u4e2d GatewayClass, Gateway, HTTPRoute \u8fd9\u4e09\u4e2a API\u6b63\u5f0f\u5ba3\u5e03 GA\uff0c\u53d1\u5e03\u4e86 v1 \u7248\u672c\uff1agateway.networking.k8s.io/v1\u3002\\n\\n\u76ee\u524d Higress \u5df2\u7ecf\u53ef\u4ee5\u652f\u6301\u8fd9\u4e9b\u6700\u65b0\u7248\u672c\u7684 API \u914d\u7f6e\uff0c\u53ea\u9700\u5728\u5b89\u88c5/\u5347\u7ea7 Higress \u65f6\u914d\u7f6e\u5f00\u542f Gateway API\uff1a\\n\\n- \u4f7f\u7528 Helm \uff1a\u901a\u8fc7\u53c2\u6570 `--set global.enableGatewayAPI=true`\\n- \u4f7f\u7528 Hgctl \uff1a\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\u6216\u8005 install.yaml \u4e2d\u914d\u7f6e `global.enableGatewayAPI=true`\\n\\n\u9996\u5148\u521b\u5efa GatewayClass \u8d44\u6e90\uff1a\\n\\n``` yaml\\n  apiVersion: gateway.networking.k8s.io/v1\\n  kind: GatewayClass\\n  metadata:\\n    name: higress-gateway\\n  spec:\\n    controllerName: \\"higress.io/gateway-controller\\"\\n```\\n\\n\u63a5\u7740\u5728\u5b89\u88c5 Higress \u7684\u547d\u540d\u7a7a\u95f4\u4e0b\uff0c\u521b\u5efa Gateway \u8d44\u6e90\uff0c\u901a\u8fc7 gatewayClassName \u5173\u8054\u4e0a\u9762\u521b\u5efa\u7684 GatewayClass \u8d44\u6e90\uff0c\u6307\u5b9a\u7531 Higress \u6765\u7ba1\u7406\u6b64 Gateway \u914d\u7f6e\uff0c\u4e0b\u9762\u4e3a\u57df\u540d\u540c\u65f6\u914d\u7f6e\u4e86 HTTP \u548c HTTPS \u5165\u53e3\uff0c\u5e76\u4e3a HTTPS \u5165\u53e3\u914d\u7f6e\u4e86\u8bc1\u4e66\uff1a\\n\\n``` yaml\\n  apiVersion: gateway.networking.k8s.io/v1\\n  kind: Gateway\\n  metadata:\\n    name: higress-gateway\\n    namespace: higress-system\\n  spec:\\n    gatewayClassName: higress-gateway\\n    listeners:\\n    - name: foobar\\n      hostname: \\"*.foobar.com\\"\\n      port: 80\\n      protocol: HTTP\\n      allowedRoutes:\\n        namespaces:\\n          from: All\\n    - name: foobar-https\\n      hostname: \\"*.foobar.com\\"\\n      port: 443\\n      protocol: HTTPS\\n    \\tallowedRoutes:\\n        namespaces:\\n          from: All\\n      tls:\\n        certificateRefs:\\n        - kind: Secret\\n          name: wildcard-foobar-com\\n        mode: Terminate        \\n```\\n\\n\u56e0\u4e3a\u4e0a\u9762 Gateway \u901a\u8fc7 allowedRoutes \u914d\u7f6e\u4e86\u5141\u8bb8\u6240\u6709\u547d\u540d\u7a7a\u95f4\u7684\u8def\u7531\u6765\u5173\u8054\uff0c\u6240\u4ee5\u8fd9\u91cc\u5728 default \u547d\u540d\u7a7a\u95f4\u4e0b\u521b\u5efa HTTPRoute\uff0c\u5173\u8054\u4e0a\u9762\u521b\u5efa\u7684 Gateway\uff0c\u5373\u53ef\u5b9a\u4e49\u57df\u540d\u4e0b\u7684\u5177\u4f53\u8def\u7531\uff1a\\n\\n``` yaml\\n  apiVersion: gateway.networking.k8s.io/v1\\n  kind: HTTPRoute\\n  metadata:\\n    name: foobar\\n    namespace: default\\n  spec:\\n    parentRefs:\\n    - name: higress-gateway\\n      namespace: higress-system\\n    hostnames: [\\"www.foobar.com\\"]\\n    rules:\\n    - matches:\\n      - path:\\n          type: PathPrefix\\n          value: /foo\\n      backendRefs:\\n      - name: foo-service\\n        port: 5678\\n```\\n\\n\u4ee5\u4e0a\u5c31\u662f Gateway API \u7684\u4e00\u4e2a\u7b80\u5355\u7528\u6cd5\u793a\u4f8b\uff0cGateway API \u8fd8\u6709\u5f88\u591a\u529f\u80fd\u548c\u73a9\u6cd5\uff0c\u540e\u9762 Higress \u516c\u4f17\u53f7/\u535a\u5ba2\u4f1a\u51fa\u4e00\u4e2a\u7cfb\u5217\u8fdb\u884c\u7cfb\u7edf\u5206\u4eab\u548c\u4ecb\u7ecd\u3002\\n\\n\u6b22\u8fce\u7ed3\u5408[\u5b98\u65b9 API \u6587\u6863](https://gateway-api.sigs.k8s.io/reference/spec/)\uff0c\u5e76\u4f7f\u7528 hgctl \uff08\u83b7\u53d6\u65b9\u5f0f\u89c1\u4e0b\u6587\uff09\u5728\u81ea\u5df1\u7535\u8111\u4e0a\u5b89\u88c5\u4e00\u4e2a local-k8s \u6a21\u5f0f\u7684 Higress\uff0c\u6765\u5f00\u542f\u5bf9\u8fd9\u4e00\u65b0\u6807\u51c6\u7684\u63a2\u7d22\uff1a\\n``` bash\\n  # \u4e00\u952e\u5b89\u88c5, \u4ea4\u4e92\u5f0f\u547d\u4ee4\u9009\u62e9\u7b2c\u4e00\u79cd\u5b89\u88c5\u6a21\u5f0f local-k8s\uff0c\u5c06\u9ed8\u8ba4\u5b89\u88c5 Gateway API CRD\\n  hgctl install\\n```\\n\\n### \u591a\u79cd\u670d\u52a1\u53d1\u73b0\u80fd\u529b\\n\\n\u5728 Ingress API \u6807\u51c6\u4e0b\uff0cHigress \u5bf9\u63a5\u591a\u79cd\u670d\u52a1\u53d1\u73b0\u80fd\u529b\u662f\u72ec\u6811\u4e00\u5e1c\u7684\uff0c\u5728 Gateway API \u6807\u51c6\u4e0b\uff0c Higress \u4ecd\u5c31\u4fdd\u6301\u4e86\u8fd9\u4e00\u80fd\u529b\u4f18\u52bf\uff1a\\n\\n\u9996\u5148\u901a\u8fc7 McpBridge \u8d44\u6e90\uff0c\u53ef\u4ee5\u5b9a\u4e49\u591a\u79cd\u670d\u52a1\u53d1\u73b0\u673a\u5236\uff1a\\n\\n``` yaml\\n  apiVersion: networking.higress.io/v1\\n  kind: McpBridge\\n  metadata:\\n    name: default\\n    namespace: higress-system\\n  spec:\\n    registries:\\n    - domain: 127.0.0.1\\n      nacosGroups:\\n      - DEFAULT_GROUP\\n      name: my-local-nacos\\n      port: 8848\\n      type: nacos2\\n    - domain: 127.0.0.1\\n      name: my-local-zk\\n      port: 2181\\n      type: zookeeper      \\n    - domain: 127.0.0.1\\n      name: my-local-eureka\\n      port: 8761\\n      type: eureka\\n    - domain: 127.0.0.1\\n      consulDatacenter: dc1      \\n      name: my-local-consul\\n      port: 8500\\n      type: consul\\n```\\n\\n\u521b\u5efa\u4e00\u4e2a HTTPRoute \u8d44\u6e90\uff0c\u53ef\u4ee5\u540c\u65f6\u5bf9\u63a5 K8s \u670d\u52a1\uff0c\u548c\u6ce8\u518c\u4e2d\u5fc3\u7684\u670d\u52a1\uff0c\u5e76\u5b9e\u73b0\u7070\u5ea6\u8def\u7531\u80fd\u529b\uff1a\\n\\n``` yaml\\n  apiVersion: gateway.networking.k8s.io/v1\\n  kind: HTTPRoute\\n  metadata:\\n    name: http\\n    namespace: default\\n  spec:\\n    parentRefs:\\n    - name: higress-gateway\\n      namespace: higress-system\\n    rules:\\n    - matches:\\n      - path:\\n          type: PathPrefix\\n          value: /\\n      backendRefs:\\n      - name: service-provider.DEFAULT-GROUP.public.nacos\\n        group: networking.higress.io\\n        port: 8080\\n        weight: 90\\n      - name: foo-service\\n        port: 5678\\n        weight: 10\\n```\\n\\n\u548c K8s \u670d\u52a1\u4e0d\u540c\u7684\u662f\uff0c\u8fd9\u91cc group \u4e3a `networking.higress.io` \u7684\u670d\u52a1\u5e76\u4e0d\u9700\u8981\u63d0\u524d\u521b\u5efa CRD \u8d44\u6e90\uff0c\u8fd9\u66f4\u7b26\u5408\u4f20\u7edf\u5fae\u670d\u52a1\u7528\u6237\u7684\u4e60\u60ef\uff0c\u5373\u670d\u52a1\u6a21\u578b\u4e0d\u9700\u8981\u63d0\u524d\u521b\u5efa\uff0c\u662f\u901a\u8fc7\u670d\u52a1\u8282\u70b9\u6ce8\u518c\u81ea\u52a8\u751f\u6210\u3002\\n\\n### Ingress API \u548c Gateway API \u4e4b\u95f4\u5982\u4f55\u9009\u62e9\\n\\n\u6709\u4e86 Gateway API\uff0c\u662f\u5426\u5e94\u8be5\u7acb\u5373\u629b\u5f03 Ingress API\uff1f\\n\\n\u53ea\u6709\u6700\u5408\u9002\u7684\uff0c\u6ca1\u6709\u6700\u597d\u7684\u3002Gateway API \u867d\u7136\u4e3a\u66f4\u591a\u7f51\u5173\u80fd\u529b\u505a\u4e86\u6807\u51c6\u5316\uff0c\u4f46 CRD \u7684\u79cd\u7c7b\u548c\u590d\u6742\u5ea6\u4e5f\u589e\u52a0\u4e86\uff0c\u76f8\u6bd4\u4e4b\u4e0b\u5bf9\u4e8e\u5927\u90e8\u5206\u7b80\u5355\u7528\u4f8b\u573a\u666f\uff0cIngress API \u66f4\u52a0\u7b80\u5355\u6613\u7528\u3002\\n\\n\u5bf9\u4e8e\u4ee5\u4e0b\u573a\u666f\uff0c\u91c7\u7528 Gateway API \u66ff\u4ee3 Ingress API \u4f1a\u5e26\u6765\u5f88\u5927\u5e2e\u52a9\uff1a\\n\\n- \u5927\u578b\u56e2\u961f\u5212\u5206\u4e86 SRE \u89d2\u8272\u548c\u4e1a\u52a1\u7814\u53d1\u89d2\u8272\uff0c\u7531 SRE \u901a\u8fc7 Gateway \u8d44\u6e90\u7edf\u4e00\u7ba1\u7406\u7ad9\u70b9\u57df\u540d\u548c\u8bc1\u4e66\uff0c\u7531\u4e1a\u52a1\u7814\u53d1\u901a\u8fc7 HTTPRoute \u8d44\u6e90\u7ba1\u7406\u4e1a\u52a1\u8def\u7531\uff0c\u5b9e\u73b0\u804c\u8d23\u5212\u5206\uff0c\u6743\u9650\u6536\u655b\\n- \u521b\u5efa\u7684\u8def\u7531\u548c Service \u6709\u4e0d\u5728\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u501f\u52a9 ReferenceGrant \u8d44\u6e90\u5b9e\u73b0\\n- \u6709\u5927\u91cf\u8bc1\u4e66\u9700\u8981\u96c6\u4e2d\u5f0f\u7ba1\u7406\uff0c\u4e0d\u5e0c\u671b\u5c06\u8bc1\u4e66 Secret \u540c\u6b65\u5230 Ingress \u6240\u5728\u547d\u540d\u7a7a\u95f4\uff0c\u5e26\u6765\u5b89\u5168\u98ce\u9669\\n\\nGateway API \u7684\u53e6\u4e00\u4e2a\u597d\u5904\u662f\u5bf9\u4e8e\u66f4\u591a\u529f\u80fd\u7684\u6807\u51c6\u5316\u5b9a\u4e49\uff0c\u6211\u4eec\u5efa\u8bae\u9047\u5230\u5b9e\u9645\u9700\u8981\u518d\u8f6c\u6362\u5230\u8fd9\u4e2a\u65b0\u7684\u6807\u51c6\uff0c\u800c\u4e0d\u5fc5\u76f2\u76ee\u8ddf\u968f\u3002\\n\\nHigress \u652f\u6301 Gateway API \u548c Ingress API \u6df7\u5408\u4f7f\u7528\uff0cGateway API \u4e0b\u7684\u57df\u540d\u8def\u7531\u5c06\u6bd4 Ingress API \u4f18\u5148\u5339\u914d\uff0c\u548c Ingress \u76f8\u540c\u8d44\u6e90\u540d\u79f0\u7684 HTTPRoute \u8fd8\u4f1a\u7ee7\u627f WASM \u63d2\u4ef6\u914d\u7f6e\uff0c\u8fd9\u6837\u7528\u6237\u53ef\u4ee5\u6309\u9700\u91c7\u7528 Gateway API\uff0c\u5e73\u6ed1\u5730\u5b8c\u6210\u4ece Ingress API \u5411 Gateway API \u7684\u6f14\u8fdb\uff0c\u65e0\u9700\u7126\u8651 API \u6807\u51c6\u5347\u7ea7\u8fc7\u7a0b\u4e2d\u4ea7\u751f\u4e1a\u52a1\u635f\u5931\u3002\\n\\n## \u65b0\u5de5\u5177\uff1aAll in one \u7684 hgctl\\n\\n### \u66ff\u4ee3 Helm \u7528\u4e8e\u5b89\u88c5/\u5347\u7ea7\\n\\n\u5728 K8s \u4e0b\u7528 Helm \u5b89\u88c5/\u5347\u7ea7\u7ec4\u4ef6\u5f88\u65b9\u4fbf\uff0c\u4f46\u5728 Higress \u7684\u573a\u666f\u4e0b\u4ecd\u7136\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff1a\\n\\n1. \u65e0\u6cd5\u652f\u6301\u975e K8s \u573a\u666f\u4e0b\u7684\u5b89\u88c5/\u5347\u7ea7\\n2. Higress \u6709\u5f88\u591a\u5b89\u88c5\u53c2\u6570\uff0c\u8fdb\u884c\u5347\u7ea7\u7b49\u64cd\u4f5c\u65f6\u4e0d\u597d\u7ef4\u62a4\uff0c\u4f7f\u7528`reuse-values` \u6709\u4e00\u4e9b\u526f\u4f5c\u7528\uff0c\u4e14\u5bb9\u6613\u8bef\u64cd\u4f5c\\n3. \u65e0\u6cd5\u7ba1\u7406 CRD \u8ddf\u968f\u7248\u672c\u66f4\u65b0\uff0c\u9700\u8981\u624b\u52a8\u66f4\u65b0\\n\\nHigress \u501f\u9274\u4e86 istio \u7684 istioctl\uff0c\u63d0\u4f9b\u4e86 hgctl \u8fd9\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\u89e3\u51b3\u4e86\u4e0a\u8ff0\u95ee\u9898\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u5373\u53ef\u5b89\u88c5 hgctl\\n\\n``` bash\\n  # \u4e0b\u8f7d\u6700\u65b0\u7248 Hgctl\uff1a\\n  curl -Ls https://raw.githubusercontent.com/alibaba/higress/main/tools/hack/get-hgctl.sh | VERSION=latest bash\\n```\\n\\nhgctl \u96c6\u6210\u4e86\u4e09\u79cd Higress \u5b89\u88c5\u6a21\u5f0f\uff0c\u5e76\u7edf\u4e00\u4e86\u5347\u7ea7/\u8fd0\u7ef4\u64cd\u4f5c\uff1a\\n\\n1. \u672c\u5730 K8s \u73af\u5883\uff08\u4f8b\u5982kind/k3s\uff09\u6a21\u5f0f\\n2. \u6b63\u5f0f K8s \u73af\u5883\u6a21\u5f0f\\n3. \u4e0d\u4f9d\u8d56 K8s \u7684\u7eaf Docker \u73af\u5883\u6a21\u5f0f\\n\\n\u76f4\u63a5\u6267\u884c `hgctl install` \u547d\u4ee4\u5373\u53ef\u9009\u62e9\u4efb\u610f\u6a21\u5f0f\u8fdb\u884c\u5b89\u88c5\\n\\n\u5b89\u88c5\u914d\u7f6e\u6587\u4ef6\u5c06\u5b58\u81f3 `~/.hgctl/profiles/install.yaml` \u76ee\u5f55\u4e0b\uff0c\u67e5\u770b\u8be5\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff1a\\n\\n``` yaml\\n  charts:\\n    higress:\\n      name: higress\\n      # \u5b89\u88c5\u6587\u4ef6\u7684 helm repo \u5730\u5740\\n      url: https://higress.io/helm-charts\\n      # \u6267\u884c hgctl upgrade \u65f6\u5c06\u81ea\u52a8\u66f4\u65b0\u81f3\u6700\u65b0\u7248\u672c\\n      version: latest\\n  console:\\n    # \u5f00\u542f\u53ef\u89c2\u6d4b\u7ec4\u4ef6\\n    o11YEnabled: true\\n    # \u63a7\u5236\u53f0\u5b9e\u4f8b\u6570\\n    replicas: 1\\n  controller:\\n    # \u63a7\u5236\u9762\u7ec4\u4ef6\u5b9e\u4f8b\u6570\\n    replicas: 1\\n  gateway:\\n    # \u6570\u636e\u9762\u7ec4\u4ef6\u5b9e\u4f8b\u6570\\n    replicas: 1\\n  global:\\n    # \u5f00\u542f Gateway API\\n    enableGatewayAPI: true\\n    # \u5f00\u542f Istio API\\n    enableIstioAPI: true\\n    # \u8bbe\u7f6e\u76d1\u542c\u7684 ingress class\\n    ingressClass: higress\\n    # \u5b89\u88c5\u6a21\u5f0f\\n    install: local-k8s\\n    # \u5b89\u88c5\u547d\u540d\u7a7a\u95f4\\n    namespace: higress-system\\n  # \u914d\u7f6e\u4f20\u9012\u7ed9 helm \u7684 values \u53c2\u6570 \\n  values: {}\\n  profile: local-k8s\\n```\\n\\n\u4fee\u6539\u4e0a\u9762\u6587\u4ef6\u7684\u5185\u5bb9\u540e\uff0c\u6267\u884c`hgctl upgarde`\u5373\u53ef\u5b9e\u73b0\u53c2\u6570\u53d8\u66f4\u751f\u6548\uff0c\u5982\u679c\u53ea\u60f3\u4fee\u6539\u53c2\u6570\uff0c\u4e0d\u60f3\u89e6\u53d1\u7248\u672c\u5347\u7ea7\uff0c\u53ef\u4ee5\u5c06 version \u53c2\u6570\u56fa\u5b9a\u4e3a\u5f53\u524d\u7248\u672c\u3002\\n\\n### WASM \u63d2\u4ef6\u5f00\u53d1\u5de5\u5177\u5305\\n\\n\u4e3a\u4e86\u6807\u51c6\u5316\u5e76\u7b80\u5316 WASM \u63d2\u4ef6\u7684\u5f00\u53d1/\u7f16\u8bd1/\u6d4b\u8bd5/\u53d1\u5e03\uff0cHigress \u63d0\u4f9b\u4e86 `hgctl plugin` \u8fd9\u4e00\u5b50\u547d\u4ee4\uff0c\u4f7f\u7528\u65b9\u5f0f\u4e3a\uff1a\\n\\n1. `hgctl plugin init`: \u521d\u59cb\u5316 Golang WASM \u63d2\u4ef6\u9879\u76ee\uff0c\u5305\u62ec\u4e09\u4e2a\u6587\u4ef6\uff1b\\n2. \u7528\u6237\u7f16\u5199 WASM \u63d2\u4ef6\u903b\u8f91\uff1b\\n3. `hgctl plugin build --output-type files`: \u6784\u5efa WASM \u63d2\u4ef6\uff0c\u5728\u672c\u5730\u8f93\u51fa\u6784\u5efa\u4ea7\u7269\uff1b\\n4. `hgctl plugin test: \u4f7f\u7528 docker compose` \u5728\u672c\u5730\u6d4b\u8bd5 WASM \u63d2\u4ef6\uff0c\u5982\u9700\u4fee\u6539\u63d2\u4ef6\u903b\u8f91\uff0c\u5219\u8fd4\u56de\u7b2c 2 \u6b65\uff1b\\n5. `hgctl plugin build --output-type image`: \u6784\u5efa WASM \u63d2\u4ef6\u4f5c\u4e3a OCI \u955c\u50cf\u4e0a\u4f20\u81f3\u955c\u50cf\u4ed3\u5e93\uff1b\\n6. `hgctl plugin install`: \u5b89\u88c5 WASM \u63d2\u4ef6\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u5730\u7684 yaml \u6587\u4ef6\u6216\u63d2\u4ef6\u9879\u76ee\u8fdb\u884c\u5b89\u88c5\u3002\\n\\n\u53e6\u5916\uff0c\u82e5\u9700\u8981\u67e5\u770b\u5df2\u5b89\u88c5\u7684\u63d2\u4ef6\uff0c\u5219\u4f7f\u7528 `hgctl plugin ls`\uff1b\u82e5\u9700\u8981\u64cd\u4f5c\u63d2\u4ef6\u914d\u7f6e\uff0c\u5219\u4f7f\u7528 `hgctl plugin config`\\n\\n\u901a\u8fc7\u8fd9\u4e2a\u5de5\u5177\uff0c\u53ef\u4ee5\u5728\u6784\u5efa WASM \u63d2\u4ef6\u7684\u540c\u65f6\uff0c\u6839\u636e\u914d\u7f6e\u4ee3\u7801\u81ea\u52a8\u751f\u6210\u63d2\u4ef6\u7684\u914d\u7f6e\u8bf4\u660e\u6587\u6863\uff0c\u4ee5\u53ca\u5305\u542b\u63d2\u4ef6\u914d\u7f6e\u7ea6\u675f\u7684\u5143\u4fe1\u606f\u6587\u4ef6\uff0c\u8fd9\u4e9b\u5185\u5bb9\u90fd\u5c06\u548c WASM \u6587\u4ef6\u4e00\u8d77\u653e\u5165 OCI \u955c\u50cf\u5236\u54c1\u4e2d\uff0c\u901a\u8fc7\u955c\u50cf\u65b9\u5f0f\u8fdb\u884c\u7248\u672c\u7ba1\u7406\u548c\u5206\u53d1\u3002\u8fd9\u4e00\u673a\u5236\u662f\u540e\u7eed Higress \u5efa\u8bbe WASM \u63d2\u4ef6\u5e02\u573a\u7684\u57fa\u77f3\u3002\\n\\n### \u5176\u4ed6\u529f\u80fd\\n\\n\u53e6\u5916\u4ecb\u7ecd\u4e24\u4e2a\u5b9e\u7528\u7684\u5b50\u547d\u4ee4\uff1a\\n\\n1. `hgctl dashboard`: \u7528\u4e8e\u547c\u51fa UI \u754c\u9762\uff0c\u4f8b\u5982 Higress \u63a7\u5236\u53f0\uff0c\u76f4\u63a5\u901a\u8fc7 `hgctl dashboard console` \u5373\u53ef\u6253\u5f00\\n\\n``` bash\\n  $ hgctl dashboard\\n  Access to Higress web UIs\\n  \\n  Usage:\\n    hgctl dashboard [flags]\\n    hgctl dashboard [command]\\n  \\n  Aliases:\\n    dashboard, dash, d\\n  \\n  Available Commands:\\n    console     Open Console web UI\\n    controller  Open Controller debug web UI\\n    envoy       Open Envoy admin web UI\\n    grafana     Open Grafana web UI\\n    prometheus  Open Prometheus web UI\\n```\\n\\n2. `hgctl gateway-config`: \u7528\u4e8e\u67e5\u770b\u6570\u636e\u9762\u7684 envoy \u914d\u7f6e\uff0c\u53ef\u4ee5\u5feb\u901f\u9a8c\u8bc1\u914d\u7f6e\u662f\u5426\u6b63\u786e\u4e0b\u53d1\\n\\n``` bash\\n  $ hgctl gateway-config\\n  Retrieve information about Higress Gateway Configuration.\\n  \\n  Usage:\\n    hgctl gateway-config [command]\\n  \\n  Aliases:\\n    gateway-config, gc\\n  \\n  Available Commands:\\n    all         Retrieves all Envoy xDS resources from the specified Higress Gateway\\n    bootstrap   Retrieves bootstrap Envoy xDS resources from the specified Higress Gateway\\n    cluster     Retrieves cluster Envoy xDS resources from the specified Higress Gateway\\n    endpoint    Retrieves endpoint Envoy xDS resources from the specified Higress Gateway\\n    listener    Retrieves listener Envoy xDS resources from the specified Higress Gateway\\n    route       Retrieves route Envoy xDS resources from the specified Higress Gateway\\n```\\n\\n## \u65b0\u5f81\u7a0b\uff1aAPI Gateway\\n\\n\u4e0a\u9762\u8bf4\u4e86 Gateway API\uff0c\u63a5\u7740\u6211\u4eec\u804a\u804a API Gateway \ud83d\ude04\uff0cAPI Gateway \u6709\u4e24\u5c42\u5b9a\u4e49\uff1a\\n\\n1. \u72ed\u4e49\u4e0a\uff1a\u6ee1\u8db3\u7edf\u4e00\u63a5\u5165\uff0c\u5c06\u8def\u7531\u8f6c\u53d1\u5230\u4e0d\u540c\u670d\u52a1\u7684\u8fd0\u7ef4\u9700\u6c42\uff0c\u5373\u53ef\u79f0\u4e3a API Gateway\uff1b\u8fd9\u91cc API \u7684\u5b9a\u4e49\u662f\u670d\u52a1\u7684\u8def\u7531\\n2. \u5e7f\u4e49\u4e0a\uff1a\u5728\u5b9e\u73b0\u670d\u52a1\u8f6c\u53d1\u7684\u57fa\u7840\u4e0a\uff0c\u9700\u8981\u8bc6\u522b\u5e26\u4e1a\u52a1\u8bed\u4e49\u7684\u63a5\u53e3\uff0c\u5c06\u4e1a\u52a1\u80fd\u529b API \u5316\u7ba1\u7406\uff0c\u7edf\u4e00\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\uff1b\u8fd9\u91cc API \u7684\u5b9a\u4e49\u662f\u4e1a\u52a1\u529f\u80fd\u63a5\u53e3\\n\\nHigress \u5df2\u7ecf\u5b9e\u73b0\u4e86\u72ed\u4e49\u4e0a\u7684 API Gateway \u80fd\u529b\uff0c\u5e76\u4e14\u662f\u57fa\u4e8e Gateway/Ingress API \u8fd9\u4e9b\u901a\u7528\u8def\u7531\u6807\u51c6\u6765\u5b9e\u73b0\u7684\u3002\u800c\u4e0e\u670d\u52a1\u8def\u7531\u6807\u51c6\u4e0d\u540c\uff0c\u4e1a\u52a1\u529f\u80fd\u63a5\u53e3\u7684\u6807\u51c6\u662f Swagger/OAS3/RPC IDL \u7b49\uff0c\u505a\u4e3a API Gateway \u9700\u8981\u63d0\u4f9b\u4ee5\u4e0b\u5173\u952e\u80fd\u529b\uff1a\\n\\n1. \u652f\u6301\u901a\u8fc7\u4e0a\u4f20 Swagger \u7b49\u63a5\u53e3\u5b9a\u4e49\u6587\u4ef6\u7684\u65b9\u5f0f\u5bfc\u5165 API\\n2. \u5bf9 API \u5b9e\u73b0\u7cbe\u7ec6\u5316\u7b56\u7565\u7ba1\u7406\uff0c\u4f8b\u5982\u6839\u636e\u51fa\u5165\u53c2\u5b9a\u4e49\u5b9e\u73b0\u53c2\u6570\u6620\u5c04/\u8f6c\u6362\\n3. \u5b9e\u73b0\u4ee5 API \u65b9\u5f0f\u5f00\u653e\u80fd\u529b\u65f6\u7684\u8ba4\u8bc1/\u9274\u6743\uff0c\u8c03\u7528\u91cf\u63a7\u5236/\u5ba1\u8ba1\u80fd\u529b\\n\\nHigress \u65b0\u7684\u5f00\u6e90\u5f81\u7a0b\u5c06\u5411\u5177\u5907\u4e1a\u52a1 API \u7ba1\u7406\u80fd\u529b\u7684 API Gateway \u5f62\u6001\u8fdb\u53d1\u3002\u5728\u5b9e\u73b0\u65b9\u5f0f\u4e0a\uff0c\u6211\u4eec\u5c06\u57fa\u4e8e WASM \u63d2\u4ef6\u53bb\u6269\u5c55\u8fd9\u4e00\u90e8\u5206\u80fd\u529b\uff0c\u8fd9\u53ef\u4ee5\u964d\u4f4e\u6211\u4eec\u5bf9\u4e0a\u6e38 Envoy \u793e\u533a\u7684\u4fb5\u5165\u6027\u6539\u9020\uff0c\u540c\u65f6\u8ba9\u5bf9 API \u7684\u7cbe\u7ec6\u5316\u7b56\u7565\u7ba1\u7406\u5177\u5907\u81ea\u5b9a\u4e49\u6269\u5c55\u80fd\u529b\u3002\\n\u76ee\u524d\u793e\u533a\u5df2\u7ecf\u6709\u4e00\u4e9b Proposal \uff0c\u6b22\u8fce\u4e86\u89e3\uff1a\\n\\nhttps://github.com/alibaba/higress/issues/535\\n\\nhttps://github.com/alibaba/higress/issues/601\\n\\n\u6b22\u8fce\u6709\u66f4\u591a\u5c0f\u4f19\u4f34\u52a0\u5165\uff0c\u548c\u6211\u4eec\u4e00\u8d77\u8e0f\u4e0a\u65b0\u7684\u5f81\u7a0b\uff0c\u6709\u5174\u8da3\u7684\u5c0f\u4f19\u4f34\u53ef\u4ee5\u8054\u7cfb\u6211(\u5fae\u4fe1\uff1anomadao)\uff0c\u52a0\u5165 API Gateway \u7684 SIG\uff08\u5174\u8da3\u5c0f\u7ec4\uff09\u3002\\n\\n## \u793e\u533a\u81f4\u8c22\\n\\n\u9996\u5148\u8981\u611f\u8c22 Envoy \u548c Istio \u793e\u533a\uff0cHigress \u7ad9\u5728\u8fd9\u4e24\u4e2a\u8f6f\u4ef6\u7684\u80a9\u8180\u4e0a\u6f14\u8fdb\u80fd\u529b\uff0c\u5f97\u4ee5\uff1a\\n\\n1. \u901a\u8fc7 WASM \u673a\u5236\u6269\u5c55 Envoy \u6570\u636e\u9762\u80fd\u529b\uff0c\u6301\u7eed\u4e0d\u65ad\u5730\u6269\u5927\u7f51\u5173\u63d2\u4ef6\u751f\u6001\\n2. \u901a\u8fc7\u4e13\u6ce8\u5728\u7f51\u5173\u9886\u57df\uff0c\u5728 Istio \u4f18\u79c0\u7684\u63a7\u5236\u9762\u57fa\u7840\u4e0a\uff0c\u8fdb\u4e00\u6b65\u505a\u62bd\u8c61\u548c\u7b80\u5316\uff0c\u964d\u4f4e\u4e0a\u624b\u548c\u8fd0\u7ef4\u95e8\u69db\\n\\n\u8fd8\u8981\u611f\u8c22\u53c2\u4e0e Higress \u5f00\u6e90\u8d21\u732e\u7684\u5f00\u53d1\u8005\u4eec\uff0c\u8fd9\u91cc\u91cd\u70b9\u611f\u8c22\u4e0b\u4e3a 1.3 \u7248\u672c\u505a\u51fa\u6838\u5fc3\u8d21\u732e\u7684\u5f00\u53d1\u8005\uff1a\\n\\n### Maintainer\uff1a\u8463\u827a\u8343(CH3CHO)\\n\\n\u4eba\u5982\u5176\u540d\u201c\u827a\u5168\u201d\uff0c\u5341\u516b\u822c\u6b66\u827a\u6837\u6837\u7cbe\u901a\uff0c\u4e0d\u7ba1\u662f\u63a7\u5236\u53f0 TS \u524d\u7aef\uff0cJava \u540e\u53f0\uff0c\u8fd8\u662f Higress \u7684 GO \u63a7\u5236\u9762\uff0c\u4ee5\u53ca Standalone \u5b89\u88c5 Shell \u811a\u672c\u548c\u5404\u79cd CICD \u6d41\u7a0b\uff0c\u901a\u901a\u624b\u5230\u64d2\u6765\u3002\\n\\n\u5728 1.3 \u7248\u672c\u4e2d\u4e3b\u8981\u8d1f\u8d23\u4e86 Higress \u652f\u6301 Gateway API \u7684\u80fd\u529b\uff0c\u4ee5\u53ca\u5b9e\u73b0\u4e86 Higress Admin Java SDK \u53ef\u4ee5\u63d0\u4f9b\u5916\u90e8\u96c6\u6210\u7528\u4e8e\u7ba1\u7406 Higress \u914d\u7f6e\uff0c\u5e76\u6539\u8fdb\u4e86 Higress Console \u7684\u5b89\u5168\u6027\u548c\u6613\u7528\u6027\u3002\\n\\n\u9664\u4e86\u5f00\u53d1\u8d21\u732e\u4e4b\u5916\uff0c\u4ed6\u8fd8\u5bf9\u793e\u533a\u7528\u6237\u5145\u6ee1\u5584\u610f\u548c\u70ed\u60c5\uff0c\u65e0\u8bba\u662f\u5728 GitHub \u7684 Issues/Discussions\uff0c\u6216\u662f\u793e\u533a\u4ea4\u6d41\u5fae\u4fe1/\u9489\u9489\u7fa4\uff0c\u968f\u5904\u53ef\u89c1\u4ed6\u5e2e\u52a9\u7528\u6237\u89e3\u51b3\u95ee\u9898\u7684\u8eab\u5f71\u3002\\n\\n### Approver\uff1a\u5434\u65b0\u519b(Jun)\uff0c\u5218\u8bad\u707c(Xunzhuo)\\n\\n\u4e24\u4f4d\u90fd\u5728\u591a\u4e2a Higress \u7248\u672c\u4e3a\u793e\u533a\u505a\u51fa\u4e86\u8d21\u732e\uff0cJun \u7684\u4e3b\u8981\u8d21\u732e\u6709\uff1a\u5728\u591a\u6ce8\u518c\u4e2d\u5fc3\u7684\u670d\u52a1\u53d1\u73b0\u652f\u6301\uff0c\u5168\u5c40\u914d\u7f6e\u7ba1\u7406\u67b6\u6784\u62bd\u8c61\uff1bXunzhuo \u7684\u4e3b\u8981\u8d21\u732e\u6709\uff1aHigress E2E \u6d4b\u8bd5\u6d41\u7a0b\u7684\u642d\u5efa\uff0cGitHub CI \u6d41\u7a0b\u7684\u5efa\u8bbe\uff0chgctl \u7684\u6574\u4f53\u67b6\u6784\u8bbe\u8ba1\u3002\\n\\n\u5728 1.3 \u7248\u672c\u4e2d\u4e8c\u4f4d\u534f\u4f5c\u5b8c\u6210\u4e86 hgctl \u7684\u591a\u6837\u5316\u80fd\u529b\u5efa\u8bbe\uff0c\u5e2e\u52a9 Higress \u7684\u6613\u7528\u6027\u53c8\u4e0a\u5230\u4e86\u4e00\u4e2a\u65b0\u7684\u53f0\u9636\u3002\\n\\n\u4e24\u4f4d\u540c\u5b66\u4f5c\u4e3a Approver \u79ef\u6781\u53c2\u4e0e\u793e\u533a\u8d21\u732e PR \u7684 Review\uff0c\u76ee\u524d\u5206\u522b\u662f Higress Tools SIG \u548c Higress GatewayAPI SIG \u7684\u9886\u5bfc\u8005\u3002\\n\\n### Member\uff1a\u97e6\u946b(WeixinX)\uff0c\u5c01\u5b87\u817e(Fkbqf)\\n\\n\u4e24\u4f4d\u90fd\u662f\u901a\u8fc7\u4e2d\u79d1\u9662\u5f00\u6e90\u4e4b\u590f\uff08OSPP 2023\uff09\u9879\u76ee\u5f00\u59cb\u53c2\u4e0e Higress \u8d21\u732e\uff0cWeixinX \u662f\u4e00\u540d\u7814\u4e8c\u7684\u5b66\u751f\uff0cFkbqf \u662f\u4e00\u540d\u5927\u4e09\u7684\u5b66\u751f\u3002\\n\\n\u5728 1.3 \u7248\u672c\u4e2d\uff0cWeixinX \u5b9e\u73b0\u4e86 hgctl plugin \u5b50\u547d\u4ee4\u7684\u80fd\u529b\uff0c\u540c\u65f6\u8d21\u732e\u4e86 Go \u5b9e\u73b0\u7684 Basic Auth \u63d2\u4ef6\uff0c\u4ee5\u53ca\u5bf9\u6807 Spring Cloud Gateway \u8bf7\u6c42\u54cd\u5e94\u8f6c\u6362\u80fd\u529b\u7684 Transformer \u63d2\u4ef6\uff1bFkbqf \u5219\u5b9e\u73b0\u4e86\u66f4\u4e3a\u590d\u6742\u7684 OIDC \u63d2\u4ef6\uff0c\u5177\u5907\u6bd4 Envoy \u81ea\u5e26 OAuth2 Filter \u66f4\u5f3a\u5927\u7684\u529f\u80fd\uff0c\u5e76\u4e14\u5177\u5907\u826f\u597d\u7684\u6269\u5c55\u6027\u3002\\n\\n\u4e24\u4f4d\u540c\u5b66\u9664\u4e86\u5f00\u53d1\u8d21\u732e\u4ee5\u5916\uff0c\u7528\u8bfe\u4f59\u65f6\u95f4\u79ef\u6781\u53c2\u4e0e Higress \u793e\u533a\u5468\u4f1a\uff0c\u4e00\u8d77\u63a2\u8ba8\u548c\u5b66\u4e60\u6280\u672f\uff0c\u4e0d\u4ea6\u4e50\u4e4e\u3002\u80fd\u591f\u6210\u4e3a\u4f60\u4eec\u4eba\u751f\u5b66\u4e1a\u8fdb\u9636\u8def\u4e0a\u7684\u9636\u68af\uff0cHigress \u8363\u5e78\u4e4b\u81f3\u3002\\n\\nHigress \u793e\u533a\u540e\u7eed\u6574\u4f53\u7684 Roadmap \u89c4\u5212\u5982\u4e0b\uff1a\\n\\n![image](https://github.com/johnlanni/higress-group.github.io/assets/6763318/f646d9ad-d2d0-4496-b164-2884851e9e0c)\\n\\n\u6b22\u8fce\u66f4\u591a\u5c0f\u4f19\u4f34\u4e00\u8d77\u52a0\u5165\u6211\u4eec\uff1a\\n\\n![higress-comm](https://github.com/johnlanni/higress-group.github.io/assets/6763318/d8e09712-0b3b-4c5a-b478-c84da139cf2f)"},{"id":"/plugin-transformer","metadata":{"permalink":"/zh-cn/blog/plugin-transformer","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/plugin-transformer.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/plugin-transformer.md","title":"\u901a\u8fc7 Higress Wasm \u63d2\u4ef6 3 \u500d\u6027\u80fd\u5b9e\u73b0 Spring-cloud-gateway \u529f\u80fd","description":"\u901a\u8fc7 Higress Wasm \u63d2\u4ef6 3 \u500d\u6027\u80fd\u5b9e\u73b0 Spring-cloud-gateway \u529f\u80fd","date":"2023-10-27T00:00:00.000Z","formattedDate":"2023\u5e7410\u670827\u65e5","tags":[],"readingTime":10.3,"hasTruncateMarker":false,"authors":[{"name":"WeixinX"}],"frontMatter":{"title":"\u901a\u8fc7 Higress Wasm \u63d2\u4ef6 3 \u500d\u6027\u80fd\u5b9e\u73b0 Spring-cloud-gateway \u529f\u80fd","keywords":["Higress","Wasm"],"description":"\u901a\u8fc7 Higress Wasm \u63d2\u4ef6 3 \u500d\u6027\u80fd\u5b9e\u73b0 Spring-cloud-gateway \u529f\u80fd","author":"WeixinX","date":"2023-10-27T00:00:00.000Z"},"prevItem":{"title":"Higress \u5f00\u6e90\u4e00\u5468\u5e74\uff1a\u65b0\u7248\u672c\uff0c\u65b0\u6807\u51c6\uff0c\u65b0\u5de5\u5177\uff0c\u65b0\u5f81\u7a0b","permalink":"/zh-cn/blog/release-1.3"},"nextItem":{"title":"Higress\u57282023 KubeCon China\u7684\u5206\u4eab","permalink":"/zh-cn/blog/2023-kubecon"}},"content":"> \u5bfc\u8bfb: \u672c\u6587\u5c06\u548c\u5927\u5bb6\u4e00\u540c\u56de\u987e Spring Cloud Gateway \u662f\u5982\u4f55\u6ee1\u8db3 HTTP \u8bf7\u6c42/\u54cd\u5e94\u8f6c\u6362\u9700\u6c42\u573a\u666f\u7684\uff0c\u5e76\u4e3a\u5927\u5bb6\u4ecb\u7ecd\u5728\u8fd9\u79cd\u573a\u666f\u4e0b\u4f7f\u7528 Higress \u4e91\u539f\u751f\u7f51\u5173\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u540c\u65f6\u8fd8\u5bf9\u6bd4\u4e86\u4e24\u8005\u7684\u6027\u80fd\u5dee\u5f02\u3002\\n\\n# 1. SCG \u4fee\u6539\u8bf7\u6c42/\u54cd\u5e94\\n\\n\u5728 [Spring Cloud Gateway](https://cloud.spring.io/spring-cloud-gateway/reference/html/) (\u4ee5\u4e0b\u7b80\u79f0\u4e3a SCG) \u4e2d\uff0c\u5f53\u6211\u4eec\u9700\u8981\u5bf9 HTTP \u8bf7\u6c42\u6216\u54cd\u5e94\u8fdb\u884c\u4fee\u6539\u65f6\uff0cSCG \u63d0\u4f9b\u4e86\u8bb8\u591a\u5185\u7f6e\u7684 [GatewayFilter](https://cloud.spring.io/spring-cloud-gateway/reference/html/#gatewayfilter-factories) \u6765\u6ee1\u8db3\u6211\u4eec\u5bf9\u8fd9\u79cd\u5e94\u7528\u573a\u666f\u7684\u9700\u6c42\uff0c\u4f8b\u5982 AddRequestHeader,AddRequestParameter, DedupeResponseHeader,MapRequestHeader, ModifyRequestBody \u7b49\u3002\\n\\n\u8003\u8651\u4ee5\u4e0b\u7b80\u5355\u7528\u4f8b\uff1a\\n\\n- \u6dfb\u52a0\u8bf7\u6c42\u5934\u90e8 X-First\uff0c\u503c\u4ece\u8bf7\u6c42\u8def\u5f84\u4e2d\u83b7\u53d6\uff0c\u4f8b\u5982\u4ece /response-headers?testKey=testValue \u4e2d\u83b7\u53d6 \\"response-headers\\"\uff1b\\n- \u5c06\u8bf7\u6c42\u5934\u90e8 X-First \u7684\u503c\u6620\u5c04\u7ed9 X-Second\uff1b\\n- \u6dfb\u52a0\u8bf7\u6c42\u67e5\u8be2\u53c2\u6570 k1=v1\uff1b\\n- \u5254\u9664\u91cd\u590d\u7684\u54cd\u5e94\u5934\u90e8 X-Dedupe\u3002\\n\\n\u5728 SCG \u4e2d\u4f7f\u7528 GatewayFilter \u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u914d\u7f6e\uff1a\\n\\n```yaml\\n# application.yaml:\\n\\nspring:\\n  cloud:\\n    gateway:\\n      routes:\\n        - id: test_route\\n          uri: lb://httpbin-svc\\n          predicates:\\n            - Path=/{api}/**\\n          filters:\\n            - AddRequestHeader=X-First, {api}\\n            - MapRequestHeader=X-First, X-Second\\n            - AddRequestParameter=k1, v1\\n            - DedupeResponseHeader=X-Dedupe, RETAIN_FIRST\\n```\\n\\n\u76f8\u4fe1\u62e5\u6709 SCG \u4f7f\u7528\u7ecf\u9a8c\u7684\u540c\u5b66\u5bf9\u4e0a\u8ff0\u914d\u7f6e\u4e00\u5b9a\u4e0d\u964c\u751f\uff0c\u90a3\u4e48\u672c\u6587\u5c06\u91cd\u70b9\u7ed9\u51fa\u53e6\u4e00\u79cd\u80fd\u591f**\u6ee1\u8db3\u4e0a\u8ff0\u9700\u6c42\u5e76\u4e14\u6027\u80fd\u66f4\u52a0\u4f18\u8d8a\u7684\u89e3\u51b3\u65b9\u6848\u2014\u2014\u4f7f\u7528 Higress \u4e91\u539f\u751f\u7f51\u5173\u7684 Transformer \u63d2\u4ef6**\u3002\\n\\n\\n# 2. Higress \u63d2\u4ef6\u4e0e SCG \u6027\u80fd\u6bd4\u8f83\\n\\n\u6211\u4eec\u5728\u540c\u4e00\u541e\u5410\u91cf\u6c34\u5e73\uff08QPS\uff09\u4e0a\uff0c\u5f00\u542f/\u5173\u95ed [Higress Transformer \u63d2\u4ef6](https://github.com/alibaba/higress/tree/main/plugins/wasm-go/extensions/transformer) \u548c SCG \u76f8\u5e94 GatewayFilters\uff0c\u7edf\u8ba1\u4e24\u8005\u5728 CPU \u548c\u5185\u5b58\u8d44\u6e90\u4e0a\u7684\u5f00\u9500\u3002\\n\\n\u7ecf\u8fc7[\u6d4b\u8bd5](https://gist.github.com/WeixinX/c24f4ded37832dd7e753b2d27470f0fc)\uff0c\u6211\u4eec\u5f97\u5230\u7684\u7ed3\u8bba\u662f\uff1a\\n\\n- \u5728 Higress \u672a\u542f\u7528 Transformer \u63d2\u4ef6\uff0cSCG \u672a\u542f\u7528 GatewayFilters \u7684\u6761\u4ef6\u4e0b\uff0cSCG \u7684 CPU, \u5185\u5b58\u8d44\u6e90\u5f00\u9500\u5206\u522b\u7ea6\u4e3a Higress\u7684 3.30, 4.88\u500d\uff1b\\n- \u5728 Higress \u542f\u7528 Transformer \u63d2\u4ef6\uff0cSCG \u542f\u7528\u76f8\u5e94 GatewayFilters \u7684\u6761\u4ef6\u4e0b\uff0cSCG \u7684 CPU,\u5185\u5b58\u8d44\u6e90\u5f00\u9500\u5206\u522b\u7ea6\u4e3a Higress \u7684 2.98, 3.19\u500d\u3002\\n\\n![\u76f8\u540c QPS \u4e0b\u7684 CPU \u5f00\u9500](https://github.com/higress-group/higress-group.github.io/assets/49450531/61d3ec0b-b708-41e6-9f28-96108b4b55c6)\\n\\n![\u76f8\u540c QPS \u4e0b\u7684\u5185\u5b58\u5f00\u9500](https://github.com/higress-group/higress-group.github.io/assets/49450531/a60415d5-bed6-47cf-a976-b8e55a818e14)\\n\\n**\u53ef\u89c1 Higress Transformer \u76f8\u6bd4\u4e8e SCG GatewayFilter \u6709\u7740\u76f8\u5f53\u4e0d\u9519\u7684\u6027\u80fd\u8868\u73b0\uff01**\\n\\n\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u8fdb\u4e00\u6b65\u4e3a\u5927\u5bb6\u4ecb\u7ecd Higress \u4e91\u539f\u751f\u7f51\u5173\u4ee5\u53ca\u4e0a\u8ff0\u63d0\u5230\u7684 Higress Transformer \u63d2\u4ef6\u3002\\n\\n\\n# 3. Higress \u7b80\u4ecb\\n\\n[Higress](https://higress.io/zh-cn/) \u662f\u57fa\u4e8e\u963f\u91cc\u5185\u90e8\u7684 Envoy Gateway \u5b9e\u8df5\u6c89\u6dc0\u3001\u4ee5\u5f00\u6e90 Istio + Envoy \u4e3a\u6838\u5fc3\u6784\u5efa\u7684\u4e0b\u4e00\u4ee3\u4e91\u539f\u751f\u7f51\u5173\uff0c\u5b9e\u73b0\u4e86\u6d41\u91cf\u7f51\u5173+\u5fae\u670d\u52a1\u7f51\u5173+\u5b89\u5168\u7f51\u5173\u4e09\u5408\u4e00\u7684\u9ad8\u96c6\u6210\u80fd\u529b\uff0c\u6df1\u5ea6\u96c6\u6210 Dubbo\u3001Nacos\u3001Sentinel \u7b49\u5fae\u670d\u52a1\u6280\u672f\u6808\uff0c\u80fd\u591f\u5e2e\u52a9\u7528\u6237\u6781\u5927\u5730\u964d\u4f4e\u7f51\u5173\u7684\u90e8\u7f72\u53ca\u8fd0\u7ef4\u6210\u672c\u4e14\u80fd\u529b\u4e0d\u6253\u6298\uff1b\u5728\u6807\u51c6\u4e0a\u5168\u9762\u652f\u6301 Ingress \u4e0e Gateway API\uff0c\u79ef\u6781\u62e5\u62b1\u4e91\u539f\u751f\u4e0b\u7684\u6807\u51c6 API \u89c4\u8303\uff1b\u540c\u65f6\uff0cHigress Controller \u4e5f\u652f\u6301 Nginx Ingress \u5e73\u6ed1\u8fc1\u79fb\uff0c\u5e2e\u52a9\u7528\u6237\u96f6\u6210\u672c\u5feb\u901f\u8fc1\u79fb\u5230 Higress\u3002\\nHigress \u63d0\u4f9b\u4e86\u4e00\u5957 [Wasm (WebAssembly) SDK](https://github.com/alibaba/higress/tree/main/plugins)\uff0c\u4f7f\u5f97\u5f00\u53d1\u8005\u80fd\u591f\u8f7b\u677e\u4f7f\u7528 C++\uff0cGolang\uff0cRust \u5f00\u53d1 Wasm \u63d2\u4ef6\u589e\u5f3a\u7f51\u5173\u80fd\u529b\u3002\u4e0b\u9762\u5c06\u4e3a\u5927\u5bb6\u4ecb\u7ecd Higress Transformer \u63d2\u4ef6\u7684\u57fa\u672c\u529f\u80fd\uff0c\u6700\u540e\u7b80\u5355\u8bf4\u660e Transformer \u63d2\u4ef6\u7684\u6838\u5fc3\u4ee3\u7801\u903b\u8f91\u3002\\n\\n![Higress Architecture](https://github.com/higress-group/higress-group.github.io/assets/49450531/c93bc55d-8cca-47ac-8b63-64168626f9a9)\\n\\n\\n# 4. Transformer \u63d2\u4ef6\u4ecb\u7ecd\\n\\nHigress Transformer \u63d2\u4ef6\u53ef\u4ee5\u5bf9\u8bf7\u6c42/\u54cd\u5e94\u5934\u90e8\u3001\u8bf7\u6c42\u67e5\u8be2\u53c2\u6570\u3001\u8bf7\u6c42/\u54cd\u5e94\u4f53\u53c2\u6570\u8fdb\u884c\u8f6c\u6362\uff0c\u652f\u6301\u7684\u8f6c\u6362\u64cd\u4f5c\u7c7b\u578b\u5305\u62ec\u5220\u9664\uff08remove\uff09\u3001\u91cd\u547d\u540d\uff08rename\uff09\u3001\u66f4\u65b0\uff08replace\uff09\u3001\u6dfb\u52a0\uff08add\uff09\u3001\u8ffd\u52a0\uff08append\uff09\u3001\u6620\u5c04\uff08map\uff09\u548c\u53bb\u91cd\uff08dedupe\uff09\u3002\\n\\n\u63a5\u4e0b\u6765\u6211\u4eec\u590d\u73b0\u6700\u5f00\u59cb\u63d0\u5230\u7684 SCG GatewayFilter \u7b80\u5355\u7528\u4f8b\uff0c\u6765\u6f14\u793a\u5982\u4f55\u4f7f\u7528\u8be5\u63d2\u4ef6\uff08\u4ee5\u4e0b\u4f7f\u7528 Higress \u63a7\u5236\u53f0\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u90e8\u7f72\u63d2\u4ef6\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u4f7f\u7528 [K8s YAML Manifests \u7684\u65b9\u5f0f](https://github.com/higress-group/higress-demo/tree/main/wasm-demo/wasm-plugin-transformer)\uff09\uff1a\\n\\n1. \u9996\u5148\u6839\u636e[\u5b98\u65b9\u6587\u6863](https://higress.io/zh-cn/docs/user/quickstart) \u5feb\u901f\u5b89\u88c5 Higress\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a\\n\\n```bash\\n$ kubectl -n higress-system get deploy\\nNAME                         READY   UP-TO-DATE   AVAILABLE   AGE\\nhigress-console              1/1     1            1           1d\\nhigress-console-grafana      1/1     1            1           1d\\nhigress-console-prometheus   1/1     1            1           1d\\nhigress-controller           1/1     1            1           1d\\nhigress-gateway              1/1     1            1           1d\\n```\\n\\n2. \u901a\u8fc7 Higress \u63a7\u5236\u53f0\u6dfb\u52a0\u57df\u540d\uff08foo.bar.com\uff09\u3001\u8def\u7531\u914d\u7f6e\uff08foo\uff09\uff0c\u5c06\u6d41\u91cf\u8f6c\u53d1\u81f3\u540e\u7aef\u7684 [httpbin](https://httpbin.org/) \u670d\u52a1\uff1a\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/49450531/4a6b2ed0-f42b-4ffa-8b36-99f7444a9e5f)\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/49450531/151442fd-b43a-40e3-8fcf-7afa49f69af9)\\n\\n3. \u4e3a foo \u8def\u7531\u6dfb\u52a0 Transformer \u63d2\u4ef6\uff08\u5f53\u524d\u672a\u63a8\u9001\u63d2\u4ef6\u81f3\u5b98\u65b9\u955c\u50cf\u4ed3\u5e93\uff0c\u53ef\u4ee5\u5148\u4f7f\u7528 docker.io/weixinx/transformer:v0.1.0\uff0c\u6216\u5230\u4ee3\u7801\u4ed3\u5e93\u81ea\u884c\u6784\u5efa\uff09\uff1a\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/49450531/fb522095-ee88-4f77-89c2-8a8547a3a96f)\\n\\n\u6ce8\uff1a\u4e3a\u4e86\u80fd\u591f\u540c\u65f6\u5b8c\u6210\u8bf7\u6c42\u548c\u54cd\u5e94\u8f6c\u6362\u7684\u9700\u6c42\uff0c\u6211\u4eec\u9700\u8981\u4e3a foo \u8def\u7531\u518d\u6dfb\u52a0\u4e00\u4e2a Transformer \u63d2\u4ef6\uff0c\u547d\u540d\u4e3a transformer-resp\uff0c\u7528\u4e8e\u5904\u7406\u54cd\u5e94\u65b9\u5411\u3002\\n\\n4. \u6dfb\u52a0 Transformer \u914d\u7f6e\u5e76\u5f00\u542f\u8be5\u63d2\u4ef6\uff1a\\n\\n- \u6dfb\u52a0\u8bf7\u6c42\u5934\u90e8 X-First\uff0c\u503c\u4ece\u8bf7\u6c42\u8def\u5f84\u4e2d\u83b7\u53d6\uff0c\u4f8b\u5982\u4ece /response-headers?testKey=testValue \u4e2d\u83b7\u53d6 \\"response-headers\\"\uff1b\\n- \u5c06\u8bf7\u6c42\u5934\u90e8 X-First \u7684\u503c\u6620\u5c04\u7ed9 X-Second\uff1b\\n- \u6dfb\u52a0\u8bf7\u6c42\u67e5\u8be2\u53c2\u6570 k1=v1\uff1b\\n- \u5254\u9664\u91cd\u590d\u7684\u54cd\u5e94\u5934\u90e8 X-Dedupe\u3002\\n\\n```yaml\\n# transformer:\\ntype: request  # \u6307\u5b9a Transformer \u7c7b\u578b\\nrules:         # \u6307\u5b9a\u8f6c\u6362\u89c4\u5219\\n- operate: add # \u6307\u5b9a\u8f6c\u6362\u64cd\u4f5c\u7c7b\u578b\\n  headers:     # \u6307\u5b9a\u5934\u90e8\u8f6c\u6362\u89c4\u5219\\n  - key: X-First\\n    value: $1  # \u6b63\u5219\u8868\u8fbe\u5f0f\u6355\u83b7\u7ec4 $1\uff0c\u652f\u6301 RE2 \u8bed\u6cd5\\n    path_pattern: ^\\\\/(\\\\w+)[\\\\?]{0,1}.*$\\n  querys:      # \u6307\u5b9a\u67e5\u8be2\u53c2\u6570\u8f6c\u6362\u89c4\u5219\\n  - key: k1\\n    value: v1\\n- operate: map\\n  headers:\\n  - key: X-First\\n    value: X-Second\\n---\\n# transformer-resp:\\ntype: response\\nrules:\\n- operate: dedupe\\n  headers:\\n  - key: X-Dedupe\\n    value: RETAIN_FIRST\\n```\\n\\n5. \u53d1\u9001\u8bf7\u6c42\u8fdb\u884c\u6d4b\u8bd5\uff1a\\n\\n```yaml\\n# \u9a8c\u8bc1\u8bf7\u6c42\u65b9\u5411\u8f6c\u6362\\n$ curl -v -H \\"host: foo.bar.com\\" \\"console.higress.io/get\\"\\n...\\n>\\n< HTTP/1.1 200 OK\\n...\\n<\\n{\\n  \\"args\\": {\\n    # \u6dfb\u52a0\u4e86\u67e5\u8be2\u53c2\u6570 k1=v1\\n    \\"k1\\": \\"v1\\"\\n  },\\n  \\"headers\\": {\\n    ...\\n    \\"X-First\\": \\"get\\", # \u6dfb\u52a0\u4e86\u8bf7\u6c42\u5934\u90e8 X-First\uff0c\u503c \\"get\\" \u6765\u81ea\u8bf7\u6c42\u8def\u5f84\\n    \\"X-Second\\": \\"get\\" # \u6620\u5c04\u4e86\u8bf7\u6c42\u5934\u90e8 X-Second\\n  },\\n  ...\\n  # \u6dfb\u52a0\u4e86\u67e5\u8be2\u53c2\u6570 k1=v1\\n  \\"url\\": \\"http://foo.bar.com/get?k1=v1\\"\\n}\\n\\n\\n# \u9a8c\u8bc1\u54cd\u5e94\u65b9\u5411\u8f6c\u6362\\n$ curl -v -H \\"host: foo.bar.com\\" \\\\\\n\\"console.higress.io/response-headers?X-Dedupe=1&X-Dedupe=2&X-Dedupe=3\\"\\n...\\n>\\n< HTTP/1.1 200 OK\\n< x-dedupe: 1 # \u4fdd\u7559\u4e86\u54cd\u5e94\u5934\u90e8 X-Dedupe \u7684\u7b2c\u4e00\u4e2a\u503c\\n...\\n<\\n{\\n  ...\\n  # \u901a\u8fc7\u67e5\u8be2\u53c2\u6570\u4f20\u7ed9 httpbin \u7684\u81ea\u5b9a\u4e49\u54cd\u5e94\u5934\u90e8\\n  \\"X-Dedupe\\": [\\n    \\"1\\",\\n    \\"2\\",\\n    \\"3\\"\\n  ],\\n  ...\\n}\\n\\n```\\n\\n\u2757\ufe0f\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a\\n\\n- \u4e0e\u4e0a\u8ff0\u4f8b\u5b50\u76f8\u540c\uff0c\u82e5\u6709\u540c\u65f6\u5904\u7406\u8bf7\u6c42\u548c\u54cd\u5e94\u8f6c\u6362\u7684\u9700\u6c42\uff0c\u5219\u9700\u8981\u4e3a\u76f8\u5e94\u8def\u7531\u6dfb\u52a0\u4e24\u4e2a Transformer \u63d2\u4ef6\uff0c\u5206\u522b\u5904\u7406\u8bf7\u6c42\u65b9\u5411\u548c\u54cd\u5e94\u65b9\u5411\uff08\u6b63\u5728\u4f18\u5316\uff09\uff1b\\n- \u8bf7\u6c42\u4f53\u652f\u6301\u7684 Content-Type \u6709\uff1aapplication/json, application/x-www-form-urlencoded, multipart/form-data\uff1b\u800c\u54cd\u5e94\u4f53\u4ec5\u652f\u6301 application/json\uff1b\\n- \u66f4\u591a\u8bf4\u660e\u8be6\u89c1[\u63d2\u4ef6\u6587\u6863](https://github.com/alibaba/higress/tree/main/plugins/wasm-go/extensions/transformer)\u3002\\n\\n\\n# 5. Transformer \u903b\u8f91\\n\\n\u672c\u8282\u5c06\u7b80\u5355\u8bf4\u660e Higress Transformer \u63d2\u4ef6\u7684\u6838\u5fc3\u4ee3\u7801\u903b\u8f91\uff0c\u5e0c\u671b\u53ef\u4ee5\u4e3a\u6709\u5174\u8da3\u4f18\u5316\u8be5\u63d2\u4ef6\u6216\u8fdb\u884c\u4e8c\u6b21\u5f00\u53d1\u7684\u540c\u5b66\u63d0\u4f9b\u4e00\u4e9b\u5e2e\u52a9\u3002\\n\\n\u9996\u5148\u8be5\u63d2\u4ef6\u4ee3\u7801\u4f4d\u4e8eHigress \u4ed3\u5e93\u7684 plugins/wasm-go/extensions/transformer \u76ee\u5f55\u4e0b\uff0c\u4f7f\u7528 Higress \u63d0\u4f9b\u7684 [Wasm SDK](https://github.com/alibaba/higress/tree/main/plugins) \u8fdb\u884c\u5f00\u53d1\uff08\u5173\u4e8e\u5982\u4f55\u5f00\u53d1 Wasm \u63d2\u4ef6\u8be6\u89c1[\u5b98\u65b9\u6587\u6863](https://higress.io/zh-cn/docs/user/wasm-go)\uff09\u3002\\n\\n\u63d2\u4ef6\u7684\u914d\u7f6e\u6a21\u578b TransformerConfig\uff1a\\n\\n```go\\n# \u6a21\u578b\u4ee5\u63d2\u4ef6\u914d\u7f6e\u7684\u5f62\u5f0f\u66b4\u9732\u7ed9\u7528\u6237\\ntype TransformerConfig struct {\\n  typ   string          # Transformer \u7c7b\u578b\uff0c[request, response]\\n  rules []TransformRule # \u8f6c\u6362\u89c4\u5219\\n  \\n  trans Transformer # Transformer \u5b9e\u4f8b\uff0c\u4e0d\u5bf9\u7528\u6237\u66b4\u9732\u914d\u7f6e\uff0c\u7528\u4e8e\u5b9e\u9645\u7684\u8f6c\u6362\u64cd\u4f5c\\n}\\n\\ntype TransformRule struct {\\n  operate string   # \u8f6c\u6362\u64cd\u4f5c\u7c7b\u578b\\n  headers []Param  # header \u53c2\u6570 \\n  querys  []Param  # query \u53c2\u6570\\n  body    []Param  # body \u53c2\u6570\\n}\\n\\ntype Param struct {\\n  key         string # \u8868\u793a\u5b57\u6bb5\u7684 key\\n  value       string # \u8868\u793a\u5b57\u6bb5\u7684 value \u6216 key (map) \u6216 strategy (dedupe)\\n  valueType   string # \u4e3a application/json body \u6307\u5b9a value \u7684\u6570\u636e\u7c7b\u578b\\n  hostPattern string # host \u6b63\u5219\u5339\u914d\u6a21\u5f0f\\n  pathPattern string # path \u6b63\u5219\u5339\u914d\u6a21\u5f0f\\n}\\n```\\n\\n\u5176\u4e2d Transformer \u4f5c\u4e3a\u63a5\u53e3\u5206\u522b\u6709\u8bf7\u6c42\u548c\u54cd\u5e94\u4e24\u4e2a\u5b9e\u73b0\uff08requestTransformer, responseTransformer\uff09\uff0c\u4e3b\u8981\u5b9e\u73b0\u4e86 3 \u4e2a\u63a5\u53e3\u65b9\u6cd5 TransformHeaders,TransformerQuerys \u548c TransformBody\uff1a\\n\\n```go\\ntype Transformer interface {\\n TransformHeaders(host, path string, hs map[string][]string) error\\n TransformQuerys(host, path string, qs map[string][]string) error\\n TransformBody(host, path string, body interface{}) error\\n ...\\n}\\n\\nvar _ Transformer = (*requestTransformer)(nil)\\nvar _ Transformer = (*responseTransformer)(nil)\\n```\\n\\n\u7531\u4e8e\u5934\u90e8\uff08Headers\uff09\u548c\u67e5\u8be2\u53c2\u6570\uff08Querys\uff09\u90fd\u662f\u4ee5 key-value \u7684\u5f62\u5f0f\u5b58\u5728\uff0c\u56e0\u6b64\u901a\u8fc7 kvHandler \u5bf9\u4e24\u8005\u91c7\u7528\u7edf\u4e00\u7684\u5904\u7406\u903b\u8f91\uff1b\u800c Body \u7531\u4e8e\u8bf7\u6c42\u3001\u54cd\u5e94\u652f\u6301\u4e0d\u540c\u7684 Content-Type\uff0c\u56e0\u6b64\u5206\u522b\u901a\u8fc7 requestBodyHandler (kvHandler, jsonHandler \u7ec4\u5408)\u548c responseBodyHandler (jsonHandler) \u8fdb\u884c\u5904\u7406\u3002\u7efc\u4e0a\uff0c\u5728\u4fee\u6539\u8be5\u63d2\u4ef6\u903b\u8f91\u65f6\uff0c\u4e3b\u8981\u5bf9 kvHandler \u548c jsonHandler \u8fdb\u884c\u4fee\u6539\u5373\u53ef\uff0c\u5176\u4e2d jsonHandler \u4f9d\u8d56 [GJSON](https://github.com/tidwall/gjson) \u548c [SJSON](https://github.com/tidwall/sjson) \u5de5\u5177\u5e93\u3002\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/49450531/fc08ff0c-12ec-4dfd-b946-4e83f8431174)\\n\\n\u76ee\u524d handler \u4e2d\u7684\u8f6c\u6362\u987a\u5e8f\u662f\u88ab\u786c\u7f16\u7801\u7684\uff08remove -> rename -> replace -> add -> append -> map -> dedupe\uff09\uff0c\u6211\u4eec\u5bf9\u6b64\u6709\u4f18\u5316\u7684\u6253\u7b97\uff0c\u4e5f\u6b22\u8fce\u611f\u5174\u8da3\u7684\u540c\u5b66\u53c2\u4e0e\u8fdb\u6765 ~\\n\\n# 6. \u603b\u7ed3\\n\\n\u672c\u6587\u5e26\u5927\u5bb6\u4e86\u89e3\u4e86 Higress Transformer \u63d2\u4ef6\uff0c\u5e76\u4e0e Spring Cloud Gateway \u8fdb\u884c\u4e86\u6027\u80fd\u6bd4\u8f83\uff0c\u5728\u6587\u7ae0\u7684\u6700\u540e\u8fd8\u8bf4\u660e\u4e86\u8be5\u63d2\u4ef6\u7684\u6838\u5fc3\u4ee3\u7801\u903b\u8f91\uff0c\u5e0c\u671b\u80fd\u591f\u4e3a\u5927\u5bb6\u4ece Spring Cloud Gateway \u8fc1\u79fb\u81f3 Higress \u63d0\u4f9b\u5e2e\u52a9\uff01\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/49450531/c2a47afd-5f29-4cfc-b5c5-571d2265ec19)\\n\\n\u5982\u679c\u60a8\u89c9\u5f97 Higress \u5bf9\u60a8\u6709\u5e2e\u52a9\uff0c\u6b22\u8fce\u524d\u5f80 [Github: Higress](https://github.com/alibaba/higress) \u4e3a\u6211\u4eec star\u2b50\ufe0f \u4e00\u4e0b\uff01\u671f\u5f85\u4e0e\u60a8\u5728 Higress \u793e\u533a\u76f8\u9047 ~"},{"id":"/2023-kubecon","metadata":{"permalink":"/zh-cn/blog/2023-kubecon","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/2023-kubecon.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/2023-kubecon.md","title":"Higress\u57282023 KubeCon China\u7684\u5206\u4eab","description":"\u770bK8s\u8d44\u6df1\u8fd0\u7ef4\u5982\u4f55\u9009\u578bIngress\u7f51\u5173","date":"2023-09-28T00:00:00.000Z","formattedDate":"2023\u5e749\u670828\u65e5","tags":[],"readingTime":8.92,"hasTruncateMarker":false,"authors":[{"name":"\u6f84\u6f6d"}],"frontMatter":{"title":"Higress\u57282023 KubeCon China\u7684\u5206\u4eab","keywords":["Higress","KubeCon"],"description":"\u770bK8s\u8d44\u6df1\u8fd0\u7ef4\u5982\u4f55\u9009\u578bIngress\u7f51\u5173","author":"\u6f84\u6f6d","date":"2023-09-28T00:00:00.000Z"},"prevItem":{"title":"\u901a\u8fc7 Higress Wasm \u63d2\u4ef6 3 \u500d\u6027\u80fd\u5b9e\u73b0 Spring-cloud-gateway \u529f\u80fd","permalink":"/zh-cn/blog/plugin-transformer"},"nextItem":{"title":"\u57fa\u4e8e\u6587\u4ef6\u914d\u7f6e\u5b9e\u73b0 Higress \u6781\u7b80\u72ec\u7acb\u90e8\u7f72","permalink":"/zh-cn/blog/config-with-file"}},"content":"## \u5206\u4eab\u7b80\u4ecb\\n\\n\u57289\u670826\u65e5\u76842023 KubeCon\u963f\u91cc\u4e91\u4e91\u539f\u751f\u5f00\u653e\u65e5\uff0cHigress\u7684\u5206\u4eab\u5185\u5bb9\u5206\u4e3a\u4e24\u90e8\u5206\uff1a\\n\\nPart 1. \u7531\u4e0a\u6d77\u8d39\u82ae\u7f51\u7edc\u79d1\u6280\u7cfb\u7edf\u8fd0\u7ef4\u526f\u603b\u76d1\u6234\u559c\u519b\uff0c\u5e26\u6765\u8d39\u82ae\u5728\u9009\u578b\u4f01\u4e1a\u7248Higress\u4f5c\u4e3aK8s Ingress\u66ff\u4ee3Nginx Ingress\u7684\u4ecb\u7ecd\\n\\nPart 2. \u7531Higress\u5f00\u6e90\u793e\u533a\u8d1f\u8d23\u4eba\u6f84\u6f6d\uff0c\u5e26\u6765Higress\u5f00\u6e90\u9879\u76ee\u7684\u4ecb\u7ecd\\n\\n\u5f00\u6e90\u7248\u548c\u4f01\u4e1a\u7248\u662fHigress\u7684\u4e00\u4f53\u4e24\u9762\uff0c\u901a\u8fc7\u672c\u6b21\u5206\u4eab\uff0c\u76f8\u4fe1\u5927\u5bb6\u4f1a\u5bf9Higress\u6709\u66f4\u5168\u9762\u7684\u4e86\u89e3\u3002\\n\\n## Part 1. \u8d39\u82ae\u4e92\u52a8\u4f7f\u7528Higress\u4f5c\u4e3aKubernetes Ingress\u5b9e\u73b0\u7a33\u5b9a\u6027\u548c\u6027\u80fd\u63d0\u5347\\n\\n\u8d39\u82ae\u901a\u8fc7Higress\u89e3\u51b3\u4e86\u539f\u672cNginx Ingress\u7f51\u5173\u7684\u8bf8\u591a\u75db\u70b9\uff0c\u6027\u80fd\u63d0\u534790%\uff0c\u54cd\u5e94\u65f6\u95f4\u4e0b\u964d50%\uff0c\u5e76\u5927\u5e45\u63d0\u5347\u4e1a\u52a1\u5165\u53e3\u7684\u7a33\u5b9a\u53ca\u5b89\u5168\u6027\uff0c\u9ad8\u6548\u652f\u6491\u6bcf\u65e51\u4ebf+\u7c89\u4e1d\u4ea4\u4e92\uff0c 4\u4e07+\u7ebf\u4e0b\u95e8\u5e97\u3001\u6bcf\u67083000\u4e07+\u7b14\u7684\u79fb\u52a8\u652f\u4ed8\u9700\u6c42\u3002\\n\\n### \u8d39\u82ae\u4e1a\u52a1\u573a\u666f\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/0d4f761d-1471-49b6-a03c-38b11304262d)\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/dba8ae2a-93c8-4368-af3d-739f97090d39)\\n\\n\u8d39\u82ae\u4e13\u6ce8\u4e8e\u79fb\u52a8\u8425\u9500\u3001O2O\u3001\u793e\u4ea4\u5a92\u4f53\u3001\u79fb\u52a8\u7535\u5546\u9886\u57df\u7684\u521b\u65b0\u4e0e\u7814\u53d1\u3002\u8d39\u82ae\u4e92\u52a8\u81ea\u4e3b\u7814\u53d1\u7684\u81ea\u5a92\u4f53\u5e73\u53f0\u8fd0\u7ef4\u8d85\u8fc72\u4ebf\u7c89\u4e1d \uff1b \u6709\u8d85\u8fc74\u4e07\u5bb6\u7ebf\u4e0b\u95e8\u5e97\u91c7\u7528\u8d39\u82aeO2O\u89e3\u51b3\u65b9\u6848\u3002\u8d39\u82ae\u7684\u4e3b\u8981\u5ba2\u6237\u5305\u62ec\u4f18\u8863\u5e93\uff0c\u5fc5\u80dc\u5ba2\uff0c\u80af\u5fb7\u57fa\uff0c\u661f\u5df4\u514b\uff0cSPG\uff0c\u6b27\u83b1\u96c5\uff0cInnisfree\uff0c\u8fea\u5361\u4fac\uff0c\u9876\u65b0\u96c6\u56e2\u7b49\u3002\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/61791bae-b40c-4b90-bc4d-c23bc052911c)\\n\\n\u8d39\u82ae\u5185\u90e8\u4e1a\u52a1\u7cfb\u7edf\u7684\u65e5\u5747\u53d1\u5e03\u6b21\u6570\u8fbe\u5230100\u6b21\u4e4b\u591a\uff0c\u4f1a\u6d89\u53ca\u5230400\u591a\u6761Ingress\u8def\u7531\u89c4\u5219\u7684\u65e5\u5e38\u66f4\u65b0\uff0c\u4e14\u7f51\u5173\u6bcf\u5929\u9700\u8981\u627f\u8f7d\u7684PV\u6d41\u91cf\u8fbe\u5230\u4e861\u4e2a\u4ebf\u3002Ingress\u7f51\u5173\u7684\u6027\u80fd\u548c\u7a33\u5b9a\u6027\u81f3\u5173\u91cd\u8981\u3002\\n\\n### Nginx Ingress \u75db\u70b9\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/1d8a178e-05de-4114-96b3-7d4e11240374)\\n\\n\u914d\u7f6e\u53d8\u66f4\u9891\u7e41\uff0c\u5bfc\u81f4Nginx\u8fdb\u7a0b\u9891\u7e41\u91cd\u542f\uff0c\u5927\u91cf\u8fde\u63a5\u77ac\u65f6\u65ad\u5f00\u540e\u5e76\u53d1\u91cd\u8fde\u4f1a\u5bfc\u81f4\u540e\u7aef\u670d\u52a1\u4ea7\u751f\u538b\u529b\uff0c\u4e25\u91cd\u65f6\u9020\u6210\u5927\u91cf\u8bf7\u6c42\u5931\u8d25\u3002\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/52e6ff5a-7374-4fe9-b001-ff6d3ac97744)\\n\\nNginx Ingress\u7684Controller\u7ec4\u4ef6\u548cNginx\u7ec4\u4ef6\u8fd0\u884c\u5728\u540c\u4e00\u4e2aPOD\u4e2d\uff0c\u63a7\u5236\u9762\u8d44\u6e90\u4f7f\u7528\u8fd8\u4f1a\u5f71\u54cd\u5230\u6570\u636e\u9762\u7684\u6027\u80fd\u3002\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/b09a3db4-465b-46b8-8e35-bd274388f143)\\n\\nNginx Ingress\u8fd8\u7f3a\u5c11\u9762\u5411\u670d\u52a1\u9650\u6d41\u7684\u80fd\u529b\uff0c\u53ea\u80fd\u5b9e\u73b0\u9762\u5411\u5355\u4e2a\u6765\u6e90IP\u9650\u6d41\uff0c\u5bf9\u4e8e\u540e\u7aef\u670d\u52a1\u4fdd\u62a4\u6765\u8bf4\u6ca1\u6709\u610f\u4e49\u3002\\n\\n### Higress \u6536\u76ca\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/48388f01-7796-4f7d-b7d1-fb7bd1522925)\\n\\nHigress\u4f01\u4e1a\u7248\u91c7\u7528\u4e86\u5168\u6258\u7ba1\u67b6\u6784\uff0c\u4e0e\u4e1a\u52a1\u96c6\u7fa4\u5206\u79bb\uff0c\u65e0\u9700\u81ea\u5df1\u8fd0\u7ef4\uff0c\u7a33\u5b9a\u6027\u6709\u66f4\u597d\u4fdd\u969c\u3002\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/5e689364-fb08-4ec1-9d71-49539da561b8)\\n\\n\u914d\u7f6e\u66f4\u65b0\u90fd\u662f\u52a8\u6001\u52a0\u8f7d\uff0c\u65e0\u9700\u91cd\u542f\u6570\u636e\u9762\uff0c\u4fdd\u969c\u4e1a\u52a1\u5e73\u7a33\u53d1\u5e03\uff0cwebsocket\u8fde\u63a5\u7684\u4e1a\u52a1\u6536\u76ca\u4e5f\u7279\u522b\u660e\u663e\uff0c\u957f\u8fde\u63a5\u53ef\u4ee5\u59cb\u7ec8\u4fdd\u6301\u4e0d\u4f1a\u65ad\u5f00\u3002\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/29ae8168-e84d-41fb-bb4f-a258c4200a7e)\\n\\n\u5f00\u542f\u4e86TLS\u786c\u4ef6\u52a0\u901f\uff0cTLS\u63e1\u624b\u65f6\u5ef6\u76f4\u63a5\u51cf\u534a\uff0cQPS\u541e\u5410\u63d0\u534786%\u3002\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/4ace2996-5b5a-4331-90cb-8448c65042d5)\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/8664f436-c058-42bc-82c9-7355d24592ad)\\n\\n\u5f00\u542fWAF\u5bf9\u541e\u5410\u5f71\u54cd\u8fd8\u662f\u6bd4\u8f83\u660e\u663e\u7684\uff0c\u4e0b\u964d\u4e8630%\uff0c\u4f46\u76f8\u6bd4Ingress Nginx\u76f4\u63a5\u4e0b\u964d\u4e8690%\uff0c\u6027\u80fd\u63d0\u5347\u8fd8\u662f\u5f88\u660e\u663e\uff0c\u800c\u4e14\u66f4\u5927\u7684\u4f18\u52bf\u662f\u57fa\u4e8e\u963f\u91cc\u4e91WAF\u4ea7\u54c1\uff0c\u9632\u62a4\u89c4\u5219\u662f\u5b9e\u65f6\u66f4\u65b0\u7684\uff0c\u800c\u975eModsecurity\u7684\u9759\u6001\u89c4\u5219\u3002\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/10fca63d-a0bb-45a1-82ee-de115bf577e7)\\n\\nHigress\u96c6\u6210\u4e86Sentinel\u9650\u6d41\u7684\u80fd\u529b\uff0c\u53ef\u4ee5\u76f4\u63a5\u9762\u5411\u670d\u52a1\u7684QPS\u541e\u5410\u4e0a\u9650/\u5e76\u53d1\u6570\u4e0a\u7ebf\u8fdb\u884c\u9650\u6d41\uff0c\u5e76\u4e14\u76f8\u6bd4Nginx\u53ea\u80fd\u914d\u7f6e\u5355\u673a\u9650\u5236\u9608\u503c\uff0c\u9700\u8981\u5173\u6ce8\u7f51\u5173\u8282\u70b9\u6570\u91cf\uff0cHigress\u8fd9\u91cc\u7684\u914d\u7f6e\u662f\u5168\u5c40\u9608\u503c\uff0c\u4e0d\u53d7\u7f51\u5173\u6269\u7f29\u5bb9\u5f71\u54cd\u3002\\n\\n\u89e6\u53d1\u9650\u6d41\u540e\u53ef\u4ee5\u81ea\u5b9a\u4e49\u54cd\u5e94\u5185\u5bb9\u6216\u8005\u91cd\u5b9a\u5411\u5230\u6307\u5b9a\u5730\u5740\uff0c\u90fd\u662f\u5f88\u5b9e\u7528\u7684\u80fd\u529b\u3002\\n\\n## Part 2. Higress\u5f00\u6e90\u4e4b\u8def\uff1a\u624e\u6839\u5f00\u6e90\u751f\u6001\uff0c\u5b9a\u4e49\u4e91\u539f\u751f\u7f51\u5173\\n\\n\u5f00\u6e90\u662f\u4e91\u539f\u751f\u751f\u6001\u7684\u57fa\u77f3\uff0cHigress\u4e5f\u662f\u501f\u52a9\u4e86\u5f00\u6e90\u751f\u6001\u7684\u529b\u91cf\uff0c\u7ad9\u5728Istio/Envoy\u7684\u80a9\u8180\u4e0a\u5f00\u53d1\u51fa\u4e86\u66f4\u591a\u5b9e\u7528\u7684\u529f\u80fd\uff0c\u6211\u4eec\u9009\u62e9\u5c06MSE Higress\uff08\u4f01\u4e1a\u7248\uff09\u4e2d\u7684\u6838\u5fc3\u80fd\u529b\u5168\u90e8\u5f00\u6e90\uff0c\u51b3\u5fc3\u624e\u6839\u5728\u5f00\u6e90\u751f\u6001\u4e2d\uff0c\u8ba9Higress\u53d8\u5f97\u66f4\u666e\u60e0\uff0c\u6709\u66f4\u591a\u4eba\u4f7f\u7528\uff0c\u4ece\u800c\u8ba9Higress\u66f4\u52a0\u5f3a\u5927\u3002\\n\\n### \u7b80\u4ecb\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/438dcf9a-96fa-4d0d-89ed-e810746c61ab)\\n\\nHigress\u5b9e\u9645\u4e0a\u6709\u4e09\u6b21\u8bde\u751f\u8fc7\u7a0b\uff1a\u7b2c\u4e00\u6b21\u662f\u5728\u963f\u91cc\u96c6\u56e2\u5185\u90e8\u4e1a\u52a1\u9700\u6c42\u9a71\u52a8\u4e0b\u8bde\u751f\uff1b\u7b2c\u4e8c\u6b21\u662f\u968f\u7740\u5185\u90e8\u4f7f\u7528\u9010\u6e10\u6210\u719f\u6c89\u6dc0\u4e3a\u963f\u91cc\u4e91\u4e0a\u7684MSE Higress\u4e91\u539f\u751f\u7f51\u5173\u4ea7\u54c1\uff1b\u7b2c\u4e09\u6b21\u662f\u968f\u7740\u4e91\u4ea7\u54c1\u6210\u719f\uff0c2022\u5e7411\u6708\u5728\u4e91\u6816\u5927\u4f1a\u4e0a\u6b63\u5f0f\u5ba3\u5e03\u5f00\u6e90\u30022023\u5e745\u6708Release\u4e86\u7b2c\u4e00\u4e2aGA\u7248\u672c\uff0c\u610f\u5473\u7740\u5f00\u6e90\u7248\u672c\u4e5f\u8d70\u5165\u6210\u719f\u9636\u6bb5\u3002\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/783b96cc-b628-4784-a6cf-c2cf10e11f3f)\\n\\n\u4ece\u914d\u7f6e\u6d41\u8f6c\u7684\u8fc7\u7a0b\u6765\u770bHigress\u7684\u67b6\u6784\uff1a\\n\\n1. \u9996\u5148\u7528\u6237\u53ef\u4ee5\u901a\u8fc7UI\u63a7\u5236\u53f0/\u547d\u4ee4\u884c\u5de5\u5177\u591a\u79cd\u65b9\u5f0f\u6765\u4e0b\u53d1\u914d\u7f6e\\n2. \u5230\u4e86\u63a7\u5236\u9762\uff0c\u5982\u679c\u662fK8s\u4e0b\uff0c\u914d\u7f6e\u6301\u4e45\u5316\u57fa\u4e8eCRD\uff0c\u5982\u679c\u4e0d\u662fK8s\uff0c\u914d\u7f6e\u6301\u4e45\u5316\u57fa\u4e8eNacos\\n3. \u9664\u4e86\u7528\u6237\u4e0b\u53d1\u7684\u8def\u7531\u914d\u7f6e\uff0c\u5b9e\u73b0\u670d\u52a1\u8def\u7531\u8fd8\u9700\u8981\u7684\u670d\u52a1IP\u5730\u5740\u4fe1\u606f\uff0c\u652f\u6301\u4eceK8s service/Nacos/Eureka/Consul/ZooKeeper/DNS/\u56fa\u5b9aIP\u7b49\u591a\u79cd\u65b9\u5f0f\u83b7\u53d6\\n4. Higress\u6570\u636e\u9762\u662f\u57fa\u4e8eEnvoy\uff0c\u914d\u7f6e\u901a\u8fc7xDS\u4e0b\u53d1\uff0c\u8fd9\u91cc\u590d\u7528\u4e86Istio\u7684\u914d\u7f6e\u4e0b\u53d1\u673a\u5236\uff0c\u56e0\u4e3a\u662f\u5185\u7f6e\u4e86\u8fd9\u4e2a\u673a\u5236\uff0c\u65e0\u9700\u5355\u72ec\u90e8\u7f72Istio\\n5. \u6700\u7ec8\u914d\u7f6e\u4e0b\u53d1\u5230\u6570\u636e\u9762\u751f\u6548\uff0cHigress\u57fa\u4e8eEnvoy\u6269\u5c55\u4e86\u5f88\u591a\u80fd\u529b\uff0c\u800c\u4e14\u57fa\u4e8eWasm\u6269\u5c55\u673a\u5236\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5f00\u53d1\u81ea\u5b9a\u4e49\u63d2\u4ef6\uff0c\u4e14\u5177\u5907\u5168\u5c40/\u57df\u540d/\u8def\u7531\u7ef4\u5ea6\u7684\u751f\u6548\u7c92\u5ea6\\n\\n### \u6838\u5fc3\u80fd\u529b\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/be02b599-f82f-42be-a8e5-82f69b9196b8)\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/4dc3cc2b-d6fe-4717-a53a-3e75c5f826ca)\\n\\n\u9ad8\u96c6\u6210\uff1a\u540c\u65f6\u96c6\u6210\u7ecf\u5178\u5fae\u670d\u52a1\u751f\u6001\u548cK8s\u5f00\u6e90\u751f\u6001\u80fd\u529b\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4e1a\u52a1\u4ece\u4f20\u7edf\u67b6\u6784\u8fc1\u79fb\u5230\u4e91\u539f\u751f\u67b6\u6784\uff0c\u57fa\u4e8e\u6d41\u91cf\u7070\u5ea6\u7b49\u80fd\u529b\uff0c\u53ef\u4ee5\u4fdd\u969c\u8fd9\u4e00\u8fc7\u7a0b\u7684\u5e73\u6ed1\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/87f8eacd-39b6-4a26-a7a1-b78f6a5abb4f)\\n\\n\u6807\u51c6\u5316\uff1a\u517c\u5bb9Nginx Ingress\u5e38\u7528\u6ce8\u89e3\uff0c\u57fa\u4e8e\u7edf\u4e00\u7684Ingress\u6807\u51c6\u53ef\u4ee5\u8f7b\u677e\u5b9e\u73b0Nginx\u5230Higress\u8fd9\u4e00\u6280\u672f\u9e3f\u6c9f\u7684\u8de8\u8d8a\uff0cHigress\u4e5f\u5df2\u7ecf\u652f\u6301Gateway API\uff0c\u8def\u7531\u6807\u51c6\u672c\u8eab\u4e5f\u80fd\u501f\u52a9Higress\u5b9e\u73b0\u5e73\u6ed1\u5347\u7ea7\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/33776d12-baf3-4d09-ae42-a5cadb655bef)\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/b9e4a718-c985-4ac4-9b7b-46a427ccb987)\\n\\n\\n\u6613\u6269\u5c55\uff1a\u501f\u52a9Higress\u7684Wasm SDK\uff0c\u5f88\u5c11\u7684\u4e1a\u52a1\u4ee3\u7801\u5c31\u53ef\u4ee5\u5f00\u53d1\u4e00\u4e2a\u7075\u6d3b\u7684\u63d2\u4ef6\uff1b\u5e76\u4e14\u652f\u6301\u57fa\u4e8eOCI\u955c\u50cf\u6807\u51c6\u5206\u53d1\uff0c\u53ef\u4ee5\u8ba9\u63d2\u4ef6\u7684\u6587\u6863\uff0c\u914d\u7f6e\u7ea6\u675f\u7b49\u8ddf\u968f\u63d2\u4ef6\u672c\u8eab\u4e00\u8d77\u88ab\u5206\u53d1\u548c\u5171\u4eab\uff1b\u548c\u4f20\u7edfNginx\u7c7b\u7f51\u5173\u6700\u5927\u7684\u5dee\u522b\uff0c\u5728\u4e8e\u63d2\u4ef6\u7684\u5206\u53d1\u96c6\u6210\u9636\u6bb5\uff0c\u5b9e\u73b0\u4e86\u63d2\u4ef6\u7248\u672c\u66f4\u65b0\u8ddf\u7f51\u5173\u81ea\u8eab\u7248\u672c\u66f4\u65b0\u7684\u89e3\u8026\u3002\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/d037bd1d-89c1-4f9c-b489-857b46de31ca)\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/65f71cee-09d9-4e7b-aa6e-bd4c9a60de83)\\n\\n\u70ed\u66f4\u65b0\uff1aEnvoy\u76f8\u6bd4Nginx\u66f4\u5408\u7406\u7684\u914d\u7f6e\u7cfb\u7edf\u62bd\u8c61\uff0c\u8ba9Higress\u5177\u5907\u4e86Nginx Ingress\u65e0\u6cd5\u5b9e\u73b0\u7684\u914d\u7f6e\u70ed\u66f4\u65b0\u80fd\u529b\\n\\n### \u56de\u987e\u4e0e\u5c55\u671b\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/f46c4d68-8e31-44bb-afc6-c02c9fccb105)\\n\\nHigress\u5f00\u6e90\u7684\u524d\u534a\u5e74\uff0c\u4e13\u6ce8\u4e8e\u5f00\u6e90\u751f\u6001\u7684\u6253\u901a\u548c\u6613\u7528\u6027\u7684\u63d0\u5347\uff0c\u5e76\u57fa\u4e8eGithub Action\u6784\u5efa\u4e86\u5f00\u6e90\u7684\u96c6\u6210\u6d4b\u8bd5\u4f53\u7cfb\uff0c\u6765\u4fdd\u969c\u9879\u76ee\u8d28\u91cf\uff0c\u5728\u4eca\u5e745\u6708\u4efd\u53d1\u5e03\u7b2c\u4e00\u4e2aGA\u7a33\u5b9a\u7248\u672c\u540e\uff0c\u5728\u591a\u4e2a\u6838\u5fc3\u793e\u533a\u5f00\u53d1\u8005\u7684\u52aa\u529b\u4e0b\uff0c\u6211\u4eec\u53c8\u5f88\u5feb\u53d1\u5e03\u4e861.1\u548c1.2\u4e24\u4e2a\u5927\u7248\u672c\uff0c\u63a8\u51fa\u4e86\u975eK8s\u90e8\u7f72/Knative\u652f\u6301\u7b49\u91cd\u91cf\u7ea7\u529f\u80fd\u3002\\n\\n\\n![image](https://github.com/higress-group/higress-group.github.io/assets/6763318/3ba10a71-b3f0-4ede-a150-c64e0b1003c4)\\n\\n\u672a\u6765\u7684RoadMap\uff0cHigress\u4f1a\u805a\u7126\u5728Gateway API/\u63d2\u4ef6\u751f\u6001/API\u7ba1\u7406\u4e09\u4e2a\u65b9\u5411\u4e0a\uff0c\u968f\u7740\u793e\u533a\u5f00\u53d1\u56e2\u961f\u7684\u4e0d\u65ad\u58ee\u5927\uff0cHigress\u5df2\u7ecf\u5efa\u7acb\u4e86\u591a\u4e2a\u4e0d\u540c\u65b9\u5411\u7684[SIG](https://github.com/alibaba/higress/issues/547) \u5e76\u884c\u63a8\u8fdb\u6838\u5fc3\u529f\u80fd\u6f14\u8fdb\uff0c\u672a\u6765\u5c06\u4e0d\u65ad\u6709\u91cd\u91cf\u7ea7\u529f\u80fd\u63a8\u51fa\uff0c\u5c3d\u8bf7\u671f\u5f85\u3002\\n\\n\\n## \u76f4\u64ad\u56de\u770b\\n\\nhttps://www.aliyun.com/activity/middleware/CloudNative_Meetup"},{"id":"/config-with-file","metadata":{"permalink":"/zh-cn/blog/config-with-file","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/config-with-file.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/config-with-file.md","title":"\u57fa\u4e8e\u6587\u4ef6\u914d\u7f6e\u5b9e\u73b0 Higress \u6781\u7b80\u72ec\u7acb\u90e8\u7f72","description":"\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528\u6587\u4ef6\u6765\u7ba1\u7406 Higress \u914d\u7f6e\u4fe1\u606f\u5e76\u5b9e\u73b0\u72ec\u7acb\u90e8\u7f72","date":"2023-08-25T00:00:00.000Z","formattedDate":"2023\u5e748\u670825\u65e5","tags":[],"readingTime":3.755,"hasTruncateMarker":false,"authors":[{"name":"CH3CHO"}],"frontMatter":{"title":"\u57fa\u4e8e\u6587\u4ef6\u914d\u7f6e\u5b9e\u73b0 Higress \u6781\u7b80\u72ec\u7acb\u90e8\u7f72","keywords":["higress","file","config"],"description":"\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528\u6587\u4ef6\u6765\u7ba1\u7406 Higress \u914d\u7f6e\u4fe1\u606f\u5e76\u5b9e\u73b0\u72ec\u7acb\u90e8\u7f72","author":"CH3CHO","date":"2023-08-25T00:00:00.000Z","custom_edit_url":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/config-with-file.md"},"prevItem":{"title":"Higress\u57282023 KubeCon China\u7684\u5206\u4eab","permalink":"/zh-cn/blog/2023-kubecon"},"nextItem":{"title":"Windows \u4e0b Higress \u90e8\u7f72\u5b9e\u8df5","permalink":"/zh-cn/blog/DeployOnWindows"}},"content":"## \u524d\u7f6e\u51c6\u5907\\n\\n### \u5b89\u88c5 Docker Compose\\n\\n\u8bf7\u53c2\u8003 Docker \u5b98\u65b9\u6587\u6863\u6765\u5b89\u88c5 Docker Engine\uff0c\u5176\u4e2d\u5df2\u7ecf\u5185\u7f6e\u4e86 Docker Compose \u7ec4\u4ef6\uff1ahttps://docs.docker.com/engine/install/\\n\\n### \u73af\u5883\u9a8c\u8bc1\\n\\n1. \u542f\u52a8\u7ec8\u7aef\uff1b\\n3. \u6267\u884c `docker compose version` \u547d\u4ee4\uff0c\u786e\u8ba4\u53ef\u4ee5\u6b63\u5e38\u8f93\u51fa Docker Compose \u7684\u7248\u672c\u3002\\n   ```\\n   Docker Compose version v2.20.2\\n   ```\\n\\n## \u5b89\u88c5 Higrees\\n\\n### \u786e\u5b9a\u914d\u7f6e\u76ee\u5f55\\n\\n\u7531\u4e8e\u8fd9\u6b21\u6211\u4eec\u51c6\u5907\u4f7f\u7528\u6587\u4ef6\u6765\u7ba1\u7406 Higress \u7684\u914d\u7f6e\u6570\u636e\uff0c\u6240\u4ee5\u9700\u8981\u5148\u786e\u5b9a\u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55\u3002\u4e0b\u9762\u6211\u4eec\u5c06\u4ee5 `~/higress/conf` \u76ee\u5f55\u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\u3002\\n\\n### \u6267\u884c\u5b89\u88c5\\n\\n\u542f\u52a8\u7ec8\u7aef\uff0c\u5e76\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\\n\\n```\\ncurl -fsSL https://higress.io/standalone/get-higress.sh | bash -s -- -c file://~/higress/conf -p <\u4f60\u7684\u5bc6\u7801> -a\\n```\\n\\n\u8bf7\u8010\u5fc3\u7b49\u5f85\u5b89\u88c5\u8fc7\u7a0b\u6267\u884c\u5b8c\u6bd5\u3002Higress \u7684\u6267\u884c\u6587\u4ef6\u5c06\u88ab\u5b89\u88c5\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 `higress` \u5b50\u76ee\u5f55\u5185\u3002\u914d\u7f6e\u6570\u636e\u5219\u5c06\u88ab\u5199\u5165 `~/higress/conf` \u76ee\u5f55\u5185\u3002\\n\\n\u5728\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u811a\u672c\u4f1a\u81ea\u52a8\u542f\u52a8 Higress\u3002\u5f53\u7ec8\u7aef\u8f93\u51fa\u5982\u4e0b\u4fe1\u606f\u65f6\uff0c\u5219\u8bf4\u660e Higress \u5df2\u5b89\u88c5\u5b8c\u6210\u5e76\u6210\u529f\u542f\u52a8\u3002\\n\\n```shell\\nHigress is now started. You can check out its status by executing /home/ch3cho/higress/bin/status.sh\\n\\nHigress Gateway is listening on:\\n  http://0.0.0.0:80\\n  https://0.0.0.0:443\\nVisit Higress Console: http://localhost:8080/\\n```\\n\\n### Higress \u8def\u7531\u914d\u7f6e\\n\\n\u4e3a\u4e86\u7740\u91cd\u8bf4\u660e\u57fa\u4e8e\u6587\u4ef6\u7684\u8def\u7531\u914d\u7f6e\u65b9\u5f0f\uff0c\u8fd9\u91cc\u5c06\u4e0d\u518d\u5c55\u5f00\u4ecb\u7ecd\u4f7f\u7528 Higress \u63a7\u5236\u53f0\u6765\u8fdb\u884c\u914d\u7f6e\u7684\u5177\u4f53\u6b65\u9aa4\u3002\u5982\u6709\u9700\u8981\uff0c\u5927\u5bb6\u53ef\u4ee5\u67e5\u9605\u5176\u4ed6\u6587\u6863\u3002\\n\\n#### \u521b\u5efa\u670d\u52a1\u6765\u6e90\\n\\n\u4f7f\u7528\u6587\u672c\u7f16\u8f91\u5668\u5c06\u4ee5\u4e0b\u5185\u5bb9\u5199\u5165 `~/higress/conf/mcpbridges/default.yaml` \u6587\u4ef6\u4e2d\uff1a\\n\\n```yaml\\napiVersion: networking.higress.io/v1\\nkind: McpBridge\\nmetadata:\\n  name: default\\n  namespace: higress-system\\nspec:\\n  registries:\\n  - domain: httpbin.org\\n    name: httpbin\\n    port: 80\\n    type: dns\\n```\\n\\n#### \u521b\u5efa\u57df\u540d\u914d\u7f6e\\n\\n\u4f7f\u7528\u6587\u672c\u7f16\u8f91\u5668\u5c06\u4ee5\u4e0b\u5185\u5bb9\u5199\u5165 `~/higress/conf/configmaps/domain-foo.bar.com.yaml` \u6587\u4ef6\u4e2d\uff1a\\n\\n```yaml\\napiVersion: v1\\nkind: ConfigMap\\nmetadata:\\n  name: domain-foo.bar.com\\n  namespace: higress-system\\ndata:\\n  domain: foo.bar.com\\n  enableHttps: \\"off\\"\\n```\\n\\n#### \u521b\u5efa\u670d\u52a1\u8def\u7531\\n\\n\u4f7f\u7528\u6587\u672c\u7f16\u8f91\u5668\u5c06\u4ee5\u4e0b\u5185\u5bb9\u5199\u5165 `~/higress/conf/ingresses/route-foo-bar.yaml` \u6587\u4ef6\u4e2d\uff1a\\n\\n```yaml\\napiVersion: networking.k8s.io/v1\\nkind: Ingress\\nmetadata:\\n  annotations:\\n    higress.io/destination: httpbin.dns\\n    higress.io/ignore-path-case: \\"false\\"\\n  name: route-foo-bar\\n  namespace: higress-system\\nspec:\\n  ingressClassName: higress\\n  rules:\\n  - host: foo.bar.com\\n    http:\\n      paths:\\n      - backend:\\n          resource:\\n            apiGroup: networking.higress.io\\n            kind: McpBridge\\n            name: default\\n        path: /\\n        pathType: Prefix\\n```\\n\\n### \u8bf7\u6c42\u9a8c\u8bc1\\n\\n\u5728\u7ec8\u7aef\u4e2d\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\\n\\n```shell\\ncurl http://localhost/get?foo=bar -H \'Host: foo.bar.com\'\\n```\\n\\n\u8bf7\u6c42\u5e94\u8fd4\u56de\u4e00\u6bb5\u5305\u542b\u8bf7\u6c42\u4fe1\u606f\u7684 JSON \u6570\u636e\uff1a\\n```json\\n{\\n  \\"args\\": {\\n    \\"foo\\": \\"bar\\"\\n  },\\n  \\"headers\\": {\\n    \\"Accept\\": \\"*/*\\",\\n    \\"Host\\": \\"foo.bar.com\\",\\n    \\"Original-Host\\": \\"foo.bar.com\\",\\n    \\"Req-Start-Time\\": \\"1693049173053\\",\\n    \\"User-Agent\\": \\"curl/8.1.2\\",\\n    \\"X-Amzn-Trace-Id\\": \\"Root=1-11111111-111111111111111111111111\\",\\n    \\"X-B3-Sampled\\": \\"0\\",\\n    \\"X-B3-Spanid\\": \\"2222222222222222\\",\\n    \\"X-B3-Traceid\\": \\"33333333333333333333333333333333\\",\\n    \\"X-Envoy-Attempt-Count\\": \\"1\\",\\n    \\"X-Envoy-Decorator-Operation\\": \\"httpbin.dns:80/*\\",\\n    \\"X-Envoy-Internal\\": \\"true\\"\\n  },\\n  \\"origin\\": \\"192.168.16.1, 123.123.123.123\\",\\n  \\"url\\": \\"http://foo.bar.com/get?foo=bar\\"\\n}\\n```\\n\\n## \u5df2\u77e5\u95ee\u9898\\n\\n\u5728 Windows \u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u76f4\u63a5\u4fee\u6539\u6302\u8f7d\u5230 Docker \u5bb9\u5668\u4e2d\u7684\u672c\u5730\u6587\u4ef6\u540e\uff0c\u5bb9\u5668\u5185\u7684\u8fdb\u7a0b\u65e0\u6cd5\u6536\u5230\u901a\u77e5\uff08\u8be6\u60c5\u8bf7\u67e5\u770b [fsnotify/fsnotify #292](https://github.com/fsnotify/fsnotify/issues/292)\uff09\u3002\u5982\u679c\u8981\u4f7f\u7528\u6587\u4ef6\u6765\u4fdd\u5b58\u914d\u7f6e\u6570\u636e\u7684\u8bdd\uff0c\u5728\u76f4\u63a5\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u540e\uff0cHigress \u65e0\u6cd5\u7acb\u5373\u52a0\u8f7d\u5230\u65b0\u7684\u914d\u7f6e\u3002\u5982\u679c\u9700\u8981\u5728 Windows \u4e0a\u72ec\u7acb\u90e8\u7f72 Higress \u7f51\u5173\uff0c\u53ef\u4ee5\u8003\u8651\u901a\u8fc7 Higress Console \u6765\u7ba1\u7406\u914d\u7f6e\u4fe1\u606f\uff0c\u6216\u4f7f\u7528 Nacos \u4fdd\u5b58\u7f51\u5173\u914d\u7f6e\u3002\\n\\n## \u53c2\u8003\u6587\u6863\\n\\n\u66f4\u591a\u76f8\u5173\u4fe1\u606f\u4e0e Higress \u7684\u5176\u4ed6\u90e8\u7f72\u65b9\u5f0f\u53ef\u67e5\u9605\u4ee5\u4e0b\u6587\u6863\uff1a\\n- [\u5feb\u901f\u5f00\u59cb](../docs/user/quickstart)\\n- [\u4f7f\u7528 Helm \u8fdb\u884c\u4e91\u539f\u751f\u90e8\u7f72](../docs/ops/deploy-by-helm)\\n- [\u57fa\u4e8e Docker Compose \u8fdb\u884c\u72ec\u7acb\u90e8\u7f72](../docs/ops/deploy-by-docker-compose)"},{"id":"/DeployOnWindows","metadata":{"permalink":"/zh-cn/blog/DeployOnWindows","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/DeployOnWindows.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/DeployOnWindows.md","title":"Windows \u4e0b Higress \u90e8\u7f72\u5b9e\u8df5","description":"Windows\u90e8\u7f72Higress","date":"2023-07-28T00:00:00.000Z","formattedDate":"2023\u5e747\u670828\u65e5","tags":[],"readingTime":3.525,"hasTruncateMarker":false,"authors":[{"name":"Fkbqf"}],"frontMatter":{"title":"Windows \u4e0b Higress \u90e8\u7f72\u5b9e\u8df5","keywords":["higress"],"description":"Windows\u90e8\u7f72Higress","author":"Fkbqf","date":"2023-07-28T00:00:00.000Z","custom_edit_url":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/DeployOnWindows.md"},"prevItem":{"title":"\u57fa\u4e8e\u6587\u4ef6\u914d\u7f6e\u5b9e\u73b0 Higress \u6781\u7b80\u72ec\u7acb\u90e8\u7f72","permalink":"/zh-cn/blog/config-with-file"},"nextItem":{"title":"Higress \u5168\u5c40\u914d\u7f6e\u63a7\u5236\u9762\u539f\u7406\u5206\u6790","permalink":"/zh-cn/blog/configmap"}},"content":"## \u524d\u7f6e\u51c6\u5907\\n\\n###  \u914d\u7f6e WSL2\\n\u8be6\u60c5\u53c2\u770b\u6b65\u9aa41-5,\u987a\u4fbf\u5728\u5fae\u8f6f\u5546\u5e97\u4e2d\u4e0b\u8f7dTerminal\u3002\\n\\n[WSL\u624b\u52a8\u5b89\u88c5\u6b65\u9aa4](https://learn.microsoft.com/zh-cn/windows/wsl/install-manual)\\n\\n### \u4e0b\u8f7d Docker Desktop\\n\\n1. **\u8bbf\u95ee Docker Desktop \u5b98\u65b9\u4e0b\u8f7d\u9875\u9762**\\n\\n   \u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 [Docker Desktop \u7684\u5b98\u65b9\u4e0b\u8f7d\u9875\u9762](https://www.docker.com/products/docker-desktop)\\n\\n2. **\u4e0b\u8f7d Docker Desktop**\\n\\n   \u5728\u4e0b\u8f7d\u9875\u9762\uff0c\u627e\u5230\u9002\u7528\u4e8e Windows \u7684 Docker Desktop \u7248\u672c\uff0c\u7136\u540e\u70b9\u51fb\u4e0b\u8f7d\u3002\\n\\n3. **\u8fd0\u884c\u5b89\u88c5\u7a0b\u5e8f**\\n\\n   \u4e0b\u8f7d\u5b8c\u6210\u540e\uff0c\u627e\u5230\u4e0b\u8f7d\u7684\u5b89\u88c5\u7a0b\u5e8f\uff08\u901a\u5e38\u5728\u4f60\u7684 \\"\u4e0b\u8f7d\\" \u6587\u4ef6\u5939\u4e2d\uff09\uff0c\u7136\u540e\u53cc\u51fb\u8fd0\u884c\u3002\\n\\n\\n\\n### \u5b89\u88c5 Cygwin\\n\\n[cygwin\u5b98\u7f51](http://www.cygwin.com/)\\n\\n\\n\u9009\u62e9setup-x86_64.exe\uff0c\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210\u3002\\n\\n\\n#### \u9a8c\u8bc1 Cygwin \u5b89\u88c5\u662f\u5426\u6210\u529f\\n```shell\\ncygcheck -c cygwin\\n```\\n\\n![7.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2F7.png)\\n\\n#### \u4e3a Cygwin \u914d\u7f6e\u73af\u5883\u53d8\u91cf\\n\\n![8.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2F8.png)\\n\\n\\n![9.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2F9.png)\\n\\n\\n![10.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2F10.png)\\n\\n\\n![11.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2F11.png)\\n\\n\\n\u70b9\u51fb\u786e\u5b9a\u5373\u53ef\u6dfb\u52a0\u6210\u529f\\n\\n\\n## \u5b89\u88c5 Higrees\\n\\n### \u51c6\u5907 Nacos \\n[nacos\u5b98\u7f51\u624b\u518c](https://nacos.io/zh-cn/docs/v2/quickstart/quick-start-docker.html)\\n\\n\u6211\u4eec\u8fd9\u91cc\u9009\u62e9nacos-docker\u7684\u6a21\u5f0f\u5b89\u88c5\\n\\n![A.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2FA.png)\\n\\n\u4e0b\u8f7d\u89e3\u538bzip\u6587\u4ef6,\u8fdb\u5165 nacos-docker-master \u6587\u4ef6\u5939\u53f3\u952e\u9009\u62e9\u7ec8\u7aef\u6253\u5f00\uff0c\u6267\u884c\u547d\u4ee4\uff0c\u6211\u4eec\u8fd9\u91cc\u9009\u62e9\u5355\u673a\u6a21\u5f0f\u90e8\u7f72\\n\\n```powershell\\n    docker-compose -f example/standalone-derby.yaml up\\n```\\n\\n\u7b49\u5f85\u51fa\u73b0\u754c\u9762\uff0c\u5373\u5b89\u88c5\u6210\u529f\\n\\n![B.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2FB.png)\\n\\n### \u4f7f\u7528 Higrees \u5bf9\u63a5 Nacos\\n**\u5b89\u88c5\u547d\u4ee4\uff1a\u4f7f\u7528\u72ec\u7acb\u90e8\u7f72\u7684 Nacos**\\n\\n\u5f53\u8bbf\u95eedocker\u5bb9\u5668\u4e92\u76f8\u8bbf\u95ee\u65f6\u5019\u672c\u5730\u56de\u73af\u5730\u5740\u5e76\u4e0d\u662f\u771f\u6b63\u7684\u5730\u5740\uff0c\u6240\u4ee5\u9700\u8981\u5728cygwin\u4e2d\u6267\u884c\u83b7\u53d6\u672c\u5730\u7f51\u5361\u5730\u5740\\n\\n```shell\\nipconfig\\n```\\n\\n![C.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2FC.png)\\n\\n\\n```\\ncurl -fsSL https://higress.io/standalone/get-higress.sh | bash -s -- -c nacos://192.168.0.1:8848 --nacos-username=nacos --nacos-password=nacos -p <\u4f60\u7684\u5bc6\u7801>\\n```\\n\\n\u8bf7\u5c06 `192.168.0.1` \u66ff\u6362\u4e3a Nacos \u670d\u52a1\u5668\u7684 IP\uff08\u5982\u679c Nacos \u90e8\u7f72\u5728\u672c\u673a\uff0c\u8bf7\u4e0d\u8981\u4f7f\u7528\u5982 `localhost` \u6216 `127.0.0.1` \u7684 Loopback \u5730\u5740\uff09\uff0c\u5e76\u6309\u9700\u8c03\u6574 `--nacos-username` \u548c `--nacos-password` \u7684\u53d6\u503c\u3002\u5982\u679c Nacos \u670d\u52a1\u672a\u5f00\u542f\u8ba4\u8bc1\u529f\u80fd\uff0c\u5219\u53ef\u4ee5\u79fb\u9664\u8fd9\u4e24\u4e2a\u53c2\u6570\u3002\\n\\n\\n\u5728\u8fd9\u91cc\u672a\u5f00\u542f\u6388\u6743\u670d\u52a1\uff0c\u76f4\u63a5\u4f7f\u7528WLANIP\u66ff\u6362\u5bf9\u5e94\u7684IP\\n```shell\\ncurl -fsSL https://higress.io/standalone/get-higress.sh | bash -s -- -c nacos://10.30.0.225:8848\\n\\n```\\n\u8f93\u5165\u547d\u4ee4\u7b49\u5f85\u90e8\u7f72\uff0c\u5373\u53ef\u770b\u5230\u751f\u6210\u7684\u7528\u6237\u540d\u4e0e\u5bc6\u7801\\n\\n![D.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2FD.png)\\n\\n### Higress \u63a7\u5236\u53f0\u914d\u7f6e\\n\\n**\u8bbf\u95ee `http://localhost:8080/`, \u4f7f\u7528\u7528\u6237\u540d admin \u548c\u5b89\u88c5\u65f6\u8bbe\u7f6e\u7684\u5bc6\u7801\u767b\u5f55 Higress \u63a7\u5236\u53f0\u3002**\\n\\n![13.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2F13.png)\\n\\n**\u70b9\u51fb\u5de6\u4fa7\u201c\u670d\u52a1\u6765\u6e90\u201d\u5bfc\u822a\u680f\uff0c\u7136\u540e\u70b9\u51fb\u9875\u9762\u53f3\u4fa7\u7684\u201c\u521b\u5efa\u670d\u52a1\u6765\u6e90\u201d\u6309\u94ae\u3002\u6309\u7167\u4e0b\u56fe\u6240\u793a\u5185\u5bb9\u586b\u5199\u8868\u5355\u5e76\u70b9\u51fb\u201c\u786e\u5b9a\u201d\u6309\u94ae\u3002**\\n\\n![14.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2F14.png)\\n\\n**\u70b9\u51fb\u5de6\u4fa7\u201c\u57df\u540d\u7ba1\u7406\u201d\u5bfc\u822a\u680f\uff0c\u7136\u540e\u70b9\u51fb\u9875\u9762\u53f3\u4fa7\u7684\u201c\u521b\u5efa\u57df\u540d\u201d\u6309\u94ae\u3002\u6309\u7167\u4e0b\u56fe\u6240\u793a\u5185\u5bb9\u586b\u5199\u8868\u5355\u5e76\u70b9\u51fb\u201c\u786e\u5b9a\u201d\u6309\u94ae\u3002**\\n\\n![15.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2F15.png)\\n\\n**\u70b9\u51fb\u5de6\u4fa7\u201c\u8def\u7531\u7ba1\u7406\u201d\u5bfc\u822a\u680f\uff0c\u7136\u540e\u70b9\u51fb\u9875\u9762\u53f3\u4fa7\u7684\u201c\u521b\u5efa\u8def\u7531\u201d\u6309\u94ae\u3002\u6309\u7167\u4e0b\u56fe\u7247\u6240\u793a\u5185\u5bb9\u586b\u5199\u8868\u5355\u5e76\u70b9\u51fb\u201c\u786e\u5b9a\u201d\u6309\u94ae\u3002**\\n\\n![16.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2F16.png)\\n\\n### \u8bf7\u6c42\u9a8c\u8bc1\\n```shell\\n# should output a JSON object containing request data \\ncurl http://localhost/get?foo=bar -H \'host: foo.bar.com\'\\n```\\n\\n![E.png](..%2F..%2F..%2Fstatic%2Fimg%2Fblog%2Fwindows%2Fpic%2FE.png)\\n\\n\u66f4\u591a\u8be6\u60c5\u4e0e\u90e8\u7f72\u65b9\u6848\u53ef\u53c2\u8003 [quick start](https://higress.io/zh-cn/docs/user/quickstart)"},{"id":"/configmap","metadata":{"permalink":"/zh-cn/blog/configmap","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/configmap.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/configmap.md","title":"Higress \u5168\u5c40\u914d\u7f6e\u63a7\u5236\u9762\u539f\u7406\u5206\u6790","description":"Higress \u5168\u5c40\u914d\u7f6e\u63a7\u5236\u9762\u539f\u7406\u5206\u6790","date":"2023-07-23T00:00:00.000Z","formattedDate":"2023\u5e747\u670823\u65e5","tags":[],"readingTime":11.275,"hasTruncateMarker":false,"authors":[{"name":"Jun"}],"frontMatter":{"title":"Higress \u5168\u5c40\u914d\u7f6e\u63a7\u5236\u9762\u539f\u7406\u5206\u6790","keywords":["higress"],"description":"Higress \u5168\u5c40\u914d\u7f6e\u63a7\u5236\u9762\u539f\u7406\u5206\u6790","author":"Jun","date":"2023-07-23T00:00:00.000Z","custom_edit_url":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/configmap.md"},"prevItem":{"title":"Windows \u4e0b Higress \u90e8\u7f72\u5b9e\u8df5","permalink":"/zh-cn/blog/DeployOnWindows"},"nextItem":{"title":"Higress\u52a9\u529bAI\u5927\u6a21\u578b\u4f01\u4e1a\u7ea7\u5e94\u7528\u843d\u5730","permalink":"/zh-cn/blog/ai_plugin"}},"content":"Higress \u6709\u4e2a\u5168\u5c40\u914d\u7f6e ConfigMap \u5bf9\u8c61 higress-config\uff0c\u53c2\u8003\u914d\u7f6e\u5982\u4e0b\uff1a\\n\\n```yaml\\napiVersion: v1\\ndata:\\n  higress: |-\\n    tracing:\\n      enable: true\\n      sampling: 100\\n      timeout: 500\\n      skywalking:\\n       service: skywalking-oap-server.op-system.svc.cluster.local\\n       port: 11800\\n...\\n...\\nkind: ConfigMap\\nmetadata:\\n  name: higress-config\\n  namespace: higress-system\\n```\\n\\n\u5177\u4f53\u914d\u7f6e\u8bf4\u660e\u8bf7\u53c2\u8003 [Higress \u5168\u5c40\u914d\u7f6e\u8bf4\u660e\u6587\u6863](https://higress.io/zh-cn/docs/user/configmap)\uff0c\\n\u672c\u6587\u4ecb\u7ecd\u4ee5 Tracing \u4e3a\u4f8b\uff0c\u8be6\u7ec6\u8bf4\u660e Tracing \u5168\u5c40\u914d\u7f6e\u662f\u5982\u4f55\u8f6c\u6210 EnvoyFilter \u548c\u5982\u4f55\u540c\u65f6\u5b9e\u73b0\u5b9e\u65f6\u4e0b\u53d1\u5230 Higress Gateway\u8fc7\u7a0b\u3002\\n\\n\u672c\u6587\u6d89\u53ca\u6574\u4f53\u67b6\u6784\u6d41\u7a0b\u3001\u521d\u59cb\u5316\u8fc7\u7a0b\u548c\u542f\u52a8\u3001higress-config \u53d8\u66f4\u548c\u5904\u7406\u6d41\u7a0b\u3001\u901a\u77e5 XDSUpdater\u3001\u6784\u5efa EnvoyFilter \u548c\u4e0b\u53d1\u4ee5\u53ca\u5982\u4f55\u6269\u5c55\u5168\u5c40\u914d\u7f6e\u7b49\u5185\u5bb9\u3002\\n\\n## \u6574\u4f53\u67b6\u6784\u6d41\u7a0b\\n\\n### 1. \u6574\u4f53\u67b6\u6784\\n\\n![img.png](../../../static/img/blog/configmap1.png)\\n\\n\\n### 2. \u6838\u5fc3\u7ec4\u4ef6\\n\\n- IngressConfig\\n\\nIngressConfig \u662f Higress \u4e00\u4e2a\u6838\u5fc3\u7ed3\u6784\u4f53, \u8d1f\u8d23\u76d1\u63a7 Ingress\uff0c McpBridge, Http2Rpc, WasmPlugin \u7b49 k8s \u8d44\u6e90\uff0c \u540c\u65f6\u96c6\u6210 ConfigStore Interface\uff0c\u901a\u8fc7 List \u63a5\u53e3\u4e0b\u53d1 VirtualService, DestinationRule, EnvoyFilter, ServiceEntry, WasmPlugin \u7b49 CR \u8d44\u6e90\u3002\\n\\n- ConfigmapMgr\\n\\nConfigmapMgr \u7ed3\u6784\u4f53\u8d1f\u8d23\u6574\u4e2a\u6838\u5fc3\u6d41\u7a0b\uff0c\u5305\u62ec\u901a\u8fc7 Informer List/Watch \u673a\u5236\u76d1\u63a7 higress-config \u7684\u53d8\u66f4\uff0c\u540c\u65f6\u904d\u5386 ItemControllers \u4e0b\u53d1\u53d8\u66f4\u901a\u77e5\uff0c\u63d0\u4f9b\u6784\u5efa EnvoyFilter \u5217\u8868\u7b49\u529f\u80fd\u3002\\n\\n- TracingController\\n\\nTracingController \u7ed3\u6784\u4f53\u8d1f\u8d23\u5177\u4f53\u7684 Tracing \u6570\u636e\u6821\u9a8c\uff0c\u6784\u5efa Tracing EnvoyFilter, \u4ee5\u53ca\u901a\u8fc7 ItemEventHandler \u4e0b\u53d1\u53d8\u66f4\u901a\u77e5\u7b49\u3002\\n\\n- HigressConfig\\n \\nHigressConfig \u662f higress-config Configmap \u6240\u5bf9\u5e94\u6570\u636e\u7684\u7ed3\u6784\u4f53\u3002\\n\\n\\n### 3. \u6838\u5fc3\u6d41\u7a0b\\n\\n- \u7528 Informer List/Watch \u673a\u5236\u76d1\u63a7 higress-config \u53d8\u66f4\uff0c\u6821\u9a8c\u53d8\u66f4\uff0c\u540c\u65f6\u4fdd\u5b58\u53d8\u66f4\u540e\u6570\u636e\u3002\\n- \u7528\u53d8\u66f4\u6570\u636e\u6784\u5efa EnvoyFilter\u3002\\n- \u901a\u77e5 XDSUpdater\uff0cEnvoyFilter \u6709\u53d8\u66f4\uff0c\u91cd\u65b0\u62c9\u53d6\u65b0\u7684 EnvoyFilter \u5217\u8868\u3002\\n\\n## \u521d\u59cb\u5316\u8fc7\u7a0b\\n\\n### 1. \u521d\u59cb\u5316\u5165\u53e3\\n\\n\u521d\u59cb\u5316\u8fc7\u7a0b\u5165\u53e3\u5728 NewIngressConfig\uff0c \u521d\u59cb\u5316 IngressConfig \u65f6\u540c\u65f6\u6784\u5efa HigressConfigController \u548c ConfigmapMgr\u3002\\n\\n```golang\\n// pkg/ingress/config/ingress_config.go\\nfunc NewIngressConfig(localKubeClient kube.Client, XDSUpdater model.XDSUpdater, namespace, clusterId string) *IngressConfig {\\n\\t// ...\\n\\t\\n\\t// \u6784\u5efa controller \u548c configmapMgr\\n\\thigressConfigController := configmap.NewController(localKubeClient, clusterId, namespace)\\n\\tconfig.configmapMgr = configmap.NewConfigmapMgr(XDSUpdater, namespace, higressConfigController, higressConfigController.Lister())\\n\\n\\treturn config\\n}\\n```\\n\\n### 2. HigressConfigController \u521d\u59cb\u5316\\n\\n\u901a\u8fc7 Higress \u63d0\u4f9b NewCommonController \u521d\u59cb\u5316 HigressConfigController \u7528\u4e8e\u76d1\u542c higress-system \u547d\u540d\u7a7a\u95f4\u4e0b Configmap \u7684\u53d8\u5316\u3002\\n\\n```golang\\n// pkg/ingress/kube/configmap/controller.go\\ntype HigressConfigController controller.Controller[listersv1.ConfigMapNamespaceLister]\\n\\nfunc NewController(client kubeclient.Client, clusterId string, namespace string) HigressConfigController {\\n\\tinformer := client.KubeInformer().Core().V1().ConfigMaps().Informer()\\n\\treturn controller.NewCommonController(\\"higressConfig\\", client.KubeInformer().Core().V1().ConfigMaps().Lister().ConfigMaps(namespace),\\n\\t\\tinformer, GetConfigmap, clusterId)\\n}\\n\\nfunc GetConfigmap(lister listersv1.ConfigMapNamespaceLister, namespacedName types.NamespacedName) (controllers.Object, error) {\\n\\treturn lister.Get(namespacedName.Name)\\n}\\n```\\n### 3. ConfigmapMgr \u521d\u59cb\u5316\\n\\nConfigmapMgr \u521d\u59cb\u5316\u5177\u4f53\u6b65\u9aa4\u5982\u4e0b\uff1a\\n- \u6784\u5efa ConfigmapMgr\\n- \u8bbe\u7f6e HigressConfigController configmap \u65b0\u589e\u6216\u8005\u66f4\u65b0\u56de\u8c03\u51fd\u6570\u4e3a configmapMgr.AddOrUpdateHigressConfig\\n- \u8bbe\u7f6e HigressConfig \u7ed3\u6784\u4f53\u9ed8\u8ba4\u503c\\n- \u521d\u59cb\u5316 TracingController\\n- \u628a tracingController \u6dfb\u52a0\u5230 configmapMgr itemControllers \u6570\u7ec4\u91cc\\n- \u521d\u59cb\u5316 ItemEventHandler\uff0c \u540c\u65f6\u904d\u5386 itemControllers\uff0c\u8bbe\u7f6e ItemEventHandler\\n\\n```golang\\n// pkg/ingress/kube/configmap/controller.go\\nfunc NewConfigmapMgr(XDSUpdater model.XDSUpdater, namespace string, higressConfigController HigressConfigController, higressConfigLister listersv1.ConfigMapNamespaceLister) *ConfigmapMgr {\\n    //  \u6784\u5efa ConfigmapMgr\\n\\tconfigmapMgr := &ConfigmapMgr{\\n\\t\\tXDSUpdater:              XDSUpdater,\\n\\t\\tNamespace:               namespace,\\n\\t\\tHigressConfigController: higressConfigController,\\n\\t\\tHigressConfigLister:     higressConfigLister,\\n\\t\\thigressConfig:           atomic.Value{},\\n\\t}\\n\\t// \u8bbe\u7f6e HigressConfigController configmap \u65b0\u589e\u6216\u8005\u66f4\u65b0\u56de\u8c03\u51fd\u6570 configmapMgr.AddOrUpdateHigressConfig\\n\\tconfigmapMgr.HigressConfigController.AddEventHandler(configmapMgr.AddOrUpdateHigressConfig)\\n\\t// \u8bbe\u7f6e HigressConfig \u7ed3\u6784\u4f53\u9ed8\u8ba4\u503c\\n\\tconfigmapMgr.SetHigressConfig(NewDefaultHigressConfig())\\n\\n\\t// \u521d\u59cb\u5316 TracingController\\n\\ttracingController := NewTracingController(namespace)\\n\\t// \u628a tracingController \u6dfb\u52a0\u5230 configmapMgr itemControllers \u91cc\\n\\tconfigmapMgr.AddItemControllers(tracingController)\\n\\t// \u521d\u59cb\u5316 itemEventHandler\uff0c \u540c\u65f6\u904d\u5386 itemControllers\uff0c\u8bbe\u7f6e itemEventHandler\\n\\tconfigmapMgr.initEventHandlers()\\n\\n\\t// \u8fd4\u56de configmapMgr\\n\\treturn configmapMgr\\n}\\n```\\n\\n## \u542f\u52a8\\n\\n\u5728 IngressConfig \u6dfb\u52a0 HigressConfigController Run() \u548c HasSynced() \u63a7\u5236\u6d41\u7a0b\u3002\\n\\n```golang\\n// pkg/ingress/config/ingress_config.go\\nfunc (m *IngressConfig) Run(stop <-chan struct{}) {\\n\\t// ...\\n\\t// \u542f\u52a8 HigressConfigController\\n\\tgo m.configmapMgr.HigressConfigController.Run(stop)\\n}\\n\\nfunc (m *IngressConfig) HasSynced() bool {\\n\\t// ....\\n\\tif !m.configmapMgr.HigressConfigController.HasSynced() {\\n\\t\\treturn false\\n\\t}\\n}\\n```\\n\\n## higress-config \u53d8\u66f4\u548c\u5904\u7406\u6d41\u7a0b\\n\\n### 1. configmapMgr \u53d8\u66f4\u5904\u7406\\n\\nConfigmapMgr \u901a\u8fc7\u6536\u5230 HigressConfigController \u901a\u77e5\u6765\u5904\u7406\u53d8\u66f4\u8bf7\u6c42\u3002\\n\\n\u5177\u4f53\u53d8\u66f4\u6d41\u7a0b\u5982\u4e0b\uff1a\\n- \u5224\u65ad\u662f\u5426 higress-system \u547d\u540d\u7a7a\u95f4\u4e0b name \u4e3a higress-config Configmap \u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5982\u679c\u4e0d\u662f\u5c31\u8fd4\u56de\u3002\\n- \u83b7\u53d6 higress-config \u5185\u5bb9\u3002\\n- \u904d\u5386 ItemControllers, \u6821\u9a8c higress-config \u914d\u7f6e\u662f\u5426\u5408\u6cd5\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u8fd4\u56de\u4e0d\u5408\u6cd5\uff0c\u5c31\u8fd4\u56de\u3002\\n- \u548c\u4e0a\u6b21\u4fdd\u5b58\u5728\u672c\u5730 higressConfig \u6bd4\u5bf9, \u68c0\u67e5\u8fd9\u6b21\u6570\u636e\u662f\u5426\u6709\u53d8\u5316\uff0c\u5982\u679c\u6ca1\u6709\u53d8\u5316\u5c31\u8fd4\u56de\u3002\\n- \u5982\u679c\u6570\u636e\u6709\u53d8\u5316\uff0c\u5c31\u904d\u5386 ItemControllers \u901a\u77e5\u6bcf\u4e2a itemController \u6570\u636e\u6709\u53d8\u5316\uff0c\u540c\u65f6\u4fdd\u5b58\u8fd9\u6b21\u53d8\u5316\u5230\u672c\u5730 higressConfig\u3002\\n\\n```golang\\n// pkg/ingress/kube/configmap/controller.go\\nfunc (c *ConfigmapMgr) AddOrUpdateHigressConfig(name util.ClusterNamespacedName) {\\n\\t// \u53ea\u76d1\u542c higress-system \u547d\u540d\u7a7a\u95f4\u4e0b name \u4e3a higress-config Configmap \u7684\u53d8\u5316\\n\\tif name.Namespace != c.Namespace || name.Name != HigressConfigMapName {\\n\\t\\treturn\\n\\t}\\n    // ...\\n\\t// \u83b7\u53d6 higress-config \u5185\u5bb9\\n\\thigressConfigmap, err := c.HigressConfigLister.Get(HigressConfigMapName)\\n\\t\\n\\t// \u901a\u8fc7 yaml.Unmarshal \u8f6c\u6210 HigressConfig\\n\\tnewHigressConfig := NewDefaultHigressConfig()\\n\\tif err = yaml.Unmarshal([]byte(higressConfigmap.Data[HigressConfigMapKey]), newHigressConfig); err != nil {\\n\\t\\tIngressLog.Errorf(\\"data:%s,  convert to higress config error, error: %+v\\", higressConfigmap.Data[HigressConfigMapKey], err)\\n\\t\\treturn\\n\\t}\\n\\n\\t// ...\\n\\t// \u904d\u5386 ItemControllers, \u6821\u9a8c\u914d\u7f6e\u662f\u5426\u5408\u6cd5\\n\\tfor _, itemController := range c.ItemControllers {\\n\\t\\tif itemErr := itemController.ValidHigressConfig(newHigressConfig); itemErr != nil {\\n\\t\\t\\tIngressLog.Errorf(\\"configmap %s controller valid higress config error, error: %+v\\", itemController.GetName(), itemErr)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t}\\n\\n\\t// \u548c\u4e0a\u6b21\u6bd4\u5bf9\u8fd9\u6b21\u6570\u636e\u662f\u5426\u6709\u53d8\u66f4\\n\\toldHigressConfig := c.GetHigressConfig()\\n\\tresult, _ := c.CompareHigressConfig(oldHigressConfig, newHigressConfig)\\n    // ...\\n\\t// \u5982\u679c\u6570\u636e\u6709\u53d8\u66f4\uff0c\u5c31\u904d\u5386 ItemControllers \u901a\u77e5\u6bcf\u4e2a itemController \u6570\u636e\u6709\u53d8\u66f4\uff0c\u540c\u65f6\u4fdd\u5b58\u8fd9\u6b21\u53d8\u66f4\u5230\u672c\u5730\u3002\\n\\tif result == ResultReplace || result == ResultDelete {\\n\\t\\tfor _, itemController := range c.ItemControllers {\\n\\t\\t\\tIngressLog.Infof(\\"configmap %s controller AddOrUpdateHigressConfig\\", itemController.GetName())\\n\\t\\t\\tif itemErr := itemController.AddOrUpdateHigressConfig(name, oldHigressConfig, newHigressConfig); itemErr != nil {\\n\\t\\t\\t\\tIngressLog.Errorf(\\"configmap %s controller AddOrUpdateHigressConfig error, error: %+v\\", itemController.GetName(), itemErr)\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\t// \u4fdd\u5b58\u8fd9\u6b21\u53d8\u66f4\\n\\t\\tc.SetHigressConfig(newHigressConfig)\\n\\t}\\n}\\n```\\n\\n### 2. TracingController \u53d8\u66f4\u5904\u7406\\n\\nTracingController \u53d8\u66f4\u5904\u7406\u5c31\u6bd4\u8f83\u7b80\u5355\uff1a\\n- \u68c0\u67e5 Tracing \u8fd9\u90e8\u5206\u6570\u636e\u662f\u5426\u6709\u53d8\u66f4\u3002\\n- \u5982\u679c\u6709\u53d8\u66f4\uff0cDeepCopy \u4e00\u4efd Tracing \u6570\u636e\u4fdd\u5b58\u5230\u672c\u5730\uff0c\u540c\u65f6\u901a\u8fc7 eventHandler \u4e0b\u53d1\u53d8\u66f4\u901a\u77e5\u3002\\n\\n```golang\\n// pkg/ingress/kube/configmap/tracing.go\\nfunc (t *TracingController) AddOrUpdateHigressConfig(name util.ClusterNamespacedName, old *HigressConfig, new *HigressConfig) error {\\n\\t// ...\\n\\t// \u68c0\u67e5 Tracing \u90e8\u5206\u6570\u636e\u662f\u5426\u6709\u53d8\u66f4\\n\\tresult, _ := compareTracing(old.Tracing, new.Tracing)\\n\\n\\t// \u5982\u679c\u6709\u53d8\u66f4\uff0cDeepCopy \u4e00\u4efd Tracing \u6570\u636e\u4fdd\u5b58\u5230\u672c\u5730\uff0c\u540c\u65f6\u901a\u8fc7 eventHandler \u4e0b\u53d1\u53d8\u66f4\u901a\u77e5\\n\\tswitch result {\\n\\tcase ResultReplace:\\n\\t\\tif newTracing, err := deepCopyTracing(new.Tracing); err != nil {\\n\\t\\t\\tIngressLog.Infof(\\"tracing deepcopy error:%v\\", err)\\n\\t\\t} else {\\n\\t\\t\\tt.SetTracing(newTracing)\\n\\t\\t\\tIngressLog.Infof(\\"AddOrUpdate Higress config tracing\\")\\n\\t\\t\\tt.eventHandler(higressTracingEnvoyFilterName)\\n\\t\\t\\tIngressLog.Infof(\\"send event with filter name:%s\\", higressTracingEnvoyFilterName)\\n\\t\\t}\\n\\tcase ResultDelete:\\n\\t\\tt.SetTracing(NewDefaultTracing())\\n\\t\\tIngressLog.Infof(\\"Delete Higress config tracing\\")\\n\\t\\tt.eventHandler(higressTracingEnvoyFilterName)\\n\\t\\tIngressLog.Infof(\\"send event with filter name:%s\\", higressTracingEnvoyFilterName)\\n\\t}\\n\\n\\treturn nil\\n}\\n```\\n\\n## \u901a\u77e5 XDSUpdater\\n\\n\u5728 ConfigmapMgr \u521d\u59cb\u5316\u65f6\u5019\u8c03\u7528 configmapMgr.initEventHandlers()\uff0c \u8fd9\u4e2a func \u4f1a\u521b\u5efa ItemEventHandler, \u540c\u65f6\u904d\u5386 ItemControllers \u8bbe\u7f6e ItemEventHandler\u3002\\n\\n```golang\\n// pkg/ingress/kube/configmap/config.go\\ntype ItemEventHandler = func(name string)\\n\\n// pkg/ingress/kube/configmap/controller.go\\nfunc (c *ConfigmapMgr) initEventHandlers() error {\\n    itemEventHandler := func(name string) {\\n    c.XDSUpdater.ConfigUpdate(&model.PushRequest{\\n        Full: true,\\n        ConfigsUpdated: map[model.ConfigKey]struct{}{{\\n            Kind:      gvk.EnvoyFilter,\\n            Name:      name,\\n            Namespace: c.Namespace,\\n        }: {}},\\n        Reason: []model.TriggerReason{ModelUpdatedReason},\\n        })\\n    }\\n    \\n    for _, itemController := range c.ItemControllers {\\n\\t\\titemController.RegisterItemEventHandler(itemEventHandler)\\n    }\\n    \\n    return nil\\n}\\n```\\n\\n\u8fd9\u91cc XDSUpdater \u662f\u4ece IngressConfig \u521d\u59cb\u5316\u4f20\u5165\uff0c XDSUpdater.ConfigUpdate() \u7528\u4e8e\u66f4\u65b0\u901a\u77e5\u4e0b\u53d1\u3002\\n\\n\u8fdb\u4e00\u6b65\u8ddf\u8e2a\u53ef\u4ee5\u53d1\u73b0\u5728 Higress controller server \u542f\u52a8\u65f6\u6267\u884c s.initXdsServer \u51fd\u6570\u521b\u5efa s.xdsServer\uff0c\u5177\u4f53\u903b\u8f91\u4e0d\u5728\u672c\u6587\u8ba8\u8bba\u8303\u56f4, \u6709\u5174\u8da3\u53ef\u4ee5\u8fdb\u4e00\u6b65\u9605\u8bfb\u6e90\u7801\u3002\\n\\n\\n```golang\\n// pkg/bootstrap/server.go\\nfunc NewServer(args *ServerArgs) (*Server, error) {\\n\\t// ...\\n\\ts := &Server{\\n\\t\\tServerArgs:      args,\\n\\t\\thttpMux:         http.NewServeMux(),\\n\\t\\tenvironment:     e,\\n\\t\\treadinessProbes: make(map[string]readinessProbe),\\n\\t\\tserver:          server.New(),\\n\\t}\\n\\ts.environment.Watcher = mesh.NewFixedWatcher(&v1alpha1.MeshConfig{})\\n\\ts.environment.Init()\\n\\tinitFuncList := []func() error{\\n\\t\\ts.initKubeClient,\\n\\t\\ts.initXdsServer,\\n\\t\\ts.initHttpServer,\\n\\t\\ts.initConfigController,\\n\\t\\ts.initRegistryEventHandlers,\\n\\t\\ts.initAuthenticators,\\n\\t}\\n\\n\\tfor _, f := range initFuncList {\\n\\t\\tif err := f(); err != nil {\\n\\t\\t\\treturn nil, err\\n\\t\\t}\\n\\t}\\n\\n\\t// ...\\n\\treturn s, nil\\n}\\n\\n// pkg/bootstrap/server.go\\nfunc (s *Server) initXdsServer() error {\\n    log.Info(\\"init xds server\\")\\n    s.xdsServer = xds.NewDiscoveryServer(s.environment, nil, PodName, PodNamespace, s.RegistryOptions.KubeOptions.ClusterAliases)\\n    // ...\\n    return s.initGrpcServer()\\n}\\n```\\n\\n## \u6784\u5efa\u548c\u4e0b\u53d1 EnvoyFilters\\n\\n### 1. IngressConfig List \u4e0b\u53d1 EnvoyFilters \u5217\u8868\\n\\nIngressConfig List \u7528\u4e8e VirtualService, DestinationRule, EnvoyFilter, ServiceEntry, WasmPlugin \u7b49 CR \u8d44\u6e90\u4e0b\u53d1\uff0c \u8fd9\u91cc\u4e3b\u8981\u5173\u6ce8 EnvoyFilter CR \u8d44\u6e90\u4e0b\u53d1\u3002\\n\\n```golang\\n// pkg/ingress/config/ingress_config.go\\nfunc (m *IngressConfig) List(typ config.GroupVersionKind, namespace string) ([]config.Config, error) {\\n\\tif typ != gvk.Gateway &&\\n\\t\\ttyp != gvk.VirtualService &&\\n\\t\\ttyp != gvk.DestinationRule &&\\n\\t\\ttyp != gvk.EnvoyFilter &&\\n\\t\\ttyp != gvk.ServiceEntry &&\\n\\t\\ttyp != gvk.WasmPlugin {\\n\\t\\treturn nil, common.ErrUnsupportedOp\\n\\t}\\n\\t// ...\\n\\tif typ == gvk.EnvoyFilter {\\n\\t\\tm.mutex.RLock()\\n\\t\\tdefer m.mutex.RUnlock()\\n\\t\\tvar envoyFilters []config.Config\\n\\t\\t\\n\\t\\t// \u8c03\u7528 ConfigmapMgr ConstructEnvoyFilters \u83b7\u53d6\u9700\u8981\u4e0b\u53d1 EnvoyFilter \u5217\u8868\\n\\t\\tconfigmapEnvoyFilters, err := m.configmapMgr.ConstructEnvoyFilters()\\n\\t\\tif err != nil {\\n\\t\\t\\tIngressLog.Errorf(\\"Construct configmap EnvoyFilters error %v\\", err)\\n\\t\\t} else {\\n\\t\\t\\tfor _, envoyFilter := range configmapEnvoyFilters {\\n\\t\\t\\t\\tenvoyFilters = append(envoyFilters, *envoyFilter)\\n\\t\\t\\t}\\n\\t\\t\\tIngressLog.Infof(\\"Append %d configmap EnvoyFilters\\", len(configmapEnvoyFilters))\\n\\t\\t}\\n\\t\\tif len(envoyFilters) == 0 {\\n\\t\\t\\tIngressLog.Infof(\\"resource type %s, configs number %d\\", typ, len(m.cachedEnvoyFilters))\\n\\t\\t\\treturn m.cachedEnvoyFilters, nil\\n\\t\\t}\\n\\t\\t// \u9700\u8981\u4e0b\u53d1 configmap EnvoyFilter \u5217\u8868 \u548c m.cachedEnvoyFilters \u5217\u8868\u805a\u5408\u4e00\u4e0b\u4e0b\u53d1\\n\\t\\tenvoyFilters = append(envoyFilters, m.cachedEnvoyFilters...)\\n\\t\\tIngressLog.Infof(\\"resource type %s, configs number %d\\", typ, len(envoyFilters))\\n\\t\\treturn envoyFilters, nil\\n\\t}\\n\\t\\n}\\t\\n```\\n\\n\u8c03\u7528 ConfigmapMgr ConstructEnvoyFilters \u83b7\u53d6\u9700\u8981\u4e0b\u53d1 EnvoyFilter \u5217\u8868\uff0c \u540c\u65f6\u548c m.cachedEnvoyFilters \u5217\u8868\u805a\u5408\u4e00\u4e0b\u518d\u4e0b\u53d1\u3002\\n\\n\u8fd9\u91cc m.cachedEnvoyFilters \u662f\u5728\u6784\u5efa VirtualService \u65f6\u751f\u6210\uff0c\u6709\u5174\u8da3\u53ef\u4ee5\u8fdb\u4e00\u6b65\u9605\u8bfb IngressConfig \u6e90\u7801\u3002\\n\\n\\n### 2. ConfigmapMgr \u6784\u5efa EnvoyFilter \u5217\u8868\\n\\n\u8fd9\u91cc\u6bd4\u8f83\u7b80\u5355\uff0c\u904d\u5386\u4e00\u4e0b ItemControllers\uff0c\u805a\u5408\u6bcf\u4e2a itemController \u8fd4\u56de\u7684 EnvoyFilters.\\n\\n```golang\\n// /pkg/ingress/kube/configmap/controller.go\\nfunc (c *ConfigmapMgr) ConstructEnvoyFilters() ([]*config.Config, error) {\\n\\tconfigs := make([]*config.Config, 0)\\n\\tfor _, itemController := range c.ItemControllers {\\n\\t\\tIngressLog.Infof(\\"controller %s ConstructEnvoyFilters\\", itemController.GetName())\\n\\t\\tif itemConfigs, err := itemController.ConstructEnvoyFilters(); err != nil {\\n\\t\\t\\tIngressLog.Errorf(\\"controller %s ConstructEnvoyFilters error, error: %+v\\", itemController.GetName(), err)\\n\\t\\t} else {\\n\\t\\t\\tconfigs = append(configs, itemConfigs...)\\n\\t\\t}\\n\\t}\\n\\treturn configs, nil\\n}\\n```\\n\\n### 3. TracingController \u6784\u5efa EnvoyFilters\\n\\n\u8fd9\u91cc\u5c31\u6bd4\u8f83\u7b80\u5355\uff0c\u6839\u636e\u4fdd\u5b58\u7684 Tracing \u6570\u636e\u6784\u5efa\u5bf9\u5e94\u7684 EnvoyFilter\\n\\n```golang\\n// pkg/ingress/kube/configmap/tracing.go\\nfunc (t *TracingController) ConstructEnvoyFilters() ([]*config.Config, error) {\\n\\t// ...\\n\\ttracingConfig := t.constructTracingTracer(tracing, namespace)\\n\\tif len(tracingConfig) == 0 {\\n\\t\\treturn configs, nil\\n\\t}\\n\\n\\tconfig := &config.Config{\\n\\t\\tMeta: config.Meta{\\n\\t\\t\\tGroupVersionKind: gvk.EnvoyFilter,\\n\\t\\t\\tName:             higressTracingEnvoyFilterName,\\n\\t\\t\\tNamespace:        namespace,\\n\\t\\t},\\n\\t\\tSpec: &networking.EnvoyFilter{\\n\\t\\t\\tConfigPatches: []*networking.EnvoyFilter_EnvoyConfigObjectPatch{\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tApplyTo: networking.EnvoyFilter_NETWORK_FILTER,\\n\\t\\t\\t\\t\\tMatch: &networking.EnvoyFilter_EnvoyConfigObjectMatch{\\n\\t\\t\\t\\t\\t\\tContext: networking.EnvoyFilter_GATEWAY,\\n\\t\\t\\t\\t\\t\\tObjectTypes: &networking.EnvoyFilter_EnvoyConfigObjectMatch_Listener{\\n\\t\\t\\t\\t\\t\\t\\tListener: &networking.EnvoyFilter_ListenerMatch{\\n\\t\\t\\t\\t\\t\\t\\t\\tFilterChain: &networking.EnvoyFilter_ListenerMatch_FilterChainMatch{\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tFilter: &networking.EnvoyFilter_ListenerMatch_FilterMatch{\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tName: \\"envoy.filters.network.http_connection_manager\\",\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\tPatch: &networking.EnvoyFilter_Patch{\\n\\t\\t\\t\\t\\t\\tOperation: networking.EnvoyFilter_Patch_MERGE,\\n\\t\\t\\t\\t\\t\\tValue:     util.BuildPatchStruct(tracingConfig),\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tApplyTo: networking.EnvoyFilter_HTTP_FILTER,\\n\\t\\t\\t\\t\\tMatch: &networking.EnvoyFilter_EnvoyConfigObjectMatch{\\n\\t\\t\\t\\t\\t\\tContext: networking.EnvoyFilter_GATEWAY,\\n\\t\\t\\t\\t\\t\\tObjectTypes: &networking.EnvoyFilter_EnvoyConfigObjectMatch_Listener{\\n\\t\\t\\t\\t\\t\\t\\tListener: &networking.EnvoyFilter_ListenerMatch{\\n\\t\\t\\t\\t\\t\\t\\t\\tFilterChain: &networking.EnvoyFilter_ListenerMatch_FilterChainMatch{\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tFilter: &networking.EnvoyFilter_ListenerMatch_FilterMatch{\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tName: \\"envoy.filters.network.http_connection_manager\\",\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tSubFilter: &networking.EnvoyFilter_ListenerMatch_SubFilterMatch{\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tName: \\"envoy.filters.http.router\\",\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\tPatch: &networking.EnvoyFilter_Patch{\\n\\t\\t\\t\\t\\t\\tOperation: networking.EnvoyFilter_Patch_MERGE,\\n\\t\\t\\t\\t\\t\\tValue: util.BuildPatchStruct(`{\\n\\t\\t\\t\\t\\t\\t\\t\\"name\\":\\"envoy.filters.http.router\\",\\n\\t\\t\\t\\t\\t\\t\\t\\"typed_config\\":{\\n\\t\\t\\t\\t\\t\\t\\t\\t\\"@type\\": \\"type.googleapis.com/envoy.extensions.filters.http.router.v3.Router\\",\\n\\t\\t\\t\\t\\t\\t\\t\\t\\"start_child_span\\": true\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t}`),\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t},\\n\\t\\t\\t},\\n\\t\\t},\\n\\t}\\n\\n\\tconfigs = append(configs, config)\\n\\treturn configs, nil\\n}\\n```\\n\\n\\n## \u5982\u4f55\u6269\u5c55\u5168\u5c40\u914d\u7f6e\\n\\n### 1. HigressConfig \u7ed3\u6784\u4f53\u6dfb\u52a0\u5bf9\u5e94\u7684\u6269\u5c55\u914d\u7f6e\\n\\n```golang\\ntype HigressConfig struct {\\n\\tTracing *Tracing `json:\\"tracing,omitempty\\"`\\n\\t// \u5728\u8fd9\u91cc\u6dfb\u52a0\u5bf9\u5e94\u7684\u6570\u636e\u7ed3\u6784\u6765\u6269\u5c55\u914d\u7f6e\\n}\\n```\\n\\n### 2. \u589e\u52a0\u6269\u5c55\u914d\u7f6e\u9ed8\u8ba4\u503c\\n\\n```golang\\n// pkg/ingress/kube/configmap/config.go\\nfunc NewDefaultHigressConfig() *HigressConfig {\\n\\thigressConfig := &HigressConfig{\\n\\t\\tTracing: NewDefaultTracing(),\\n\\t\\t// \u5728\u8fd9\u91cc\u589e\u52a0\u6269\u5c55\u914d\u7f6e\u9ed8\u8ba4\u503c\\n\\t}\\n\\treturn higressConfig\\n}\\n```\\n\\n### 3. \u5b9e\u73b0 ItemController interface\\n\\n```golang\\ntype ItemController interface {\\n\\tGetName() string\\n\\tAddOrUpdateHigressConfig(name util.ClusterNamespacedName, old *HigressConfig, new *HigressConfig) error\\n\\tValidHigressConfig(higressConfig *HigressConfig) error\\n\\tConstructEnvoyFilters() ([]*config.Config, error)\\n\\tRegisterItemEventHandler(eventHandler ItemEventHandler)\\n}\\n```\\n\\n### 4. \u521d\u59cb\u5316\u6269\u5c55\u914d\u7f6e\uff0c\u540c\u65f6\u6dfb\u52a0\u5230 ItemControllers\\n\\n```golang\\nfunc NewConfigmapMgr(XDSUpdater model.XDSUpdater, namespace string, higressConfigController HigressConfigController, higressConfigLister listersv1.ConfigMapNamespaceLister) *ConfigmapMgr {\\n\\t// ...\\n\\ttracingController := NewTracingController(namespace)\\n\\tconfigmapMgr.AddItemControllers(tracingController)\\n\\t// ...\\n\\t// \u5728\u8fd9\u91cc\u521d\u59cb\u5316\u6269\u5c55\u914d\u7f6e\uff0c\u540c\u65f6\u6dfb\u52a0\u5230 ItemControllers\\n\\tconfigmapMgr.initEventHandlers()\\n\\n\\treturn configmapMgr\\n}\\n```\\n\\n## \u53c2\u4e0e\u793e\u533a\u8d21\u732e\\n\\nHigress \u5f00\u6e90\u8d21\u732e\u5c0f\u7ec4\u6b63\u5728\u706b\u70ed\u62db\u52df\u8d21\u732e\u8005\u3002\u65e9\u671f\u53c2\u4e0e\u5f00\u6e90\u66f4\u5bb9\u6613\u6210\u4e3a\u9879\u76ee Committer\uff0c\u5e76\u6709\u66f4\u591a\u673a\u4f1a\u6210\u4e3a Higress PMC(Project Management Committee) \u7684\u4e00\u5458\uff0c\u53c2\u4e0e\u4e3b\u5bfc Higress \u793e\u533a\u7684\u524d\u8fdb\u65b9\u5411\u3002\\n\u6b22\u8fce\u52a0\u5165 Higress \u793e\u533a\u7fa4\uff1a\\n\\n\\n![](https://img.alicdn.com/imgextra/i1/O1CN0166Gkdt1cRTVjJ2skL_!!6000000003597-2-tps-720-405.png)"},{"id":"/ai_plugin","metadata":{"permalink":"/zh-cn/blog/ai_plugin","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/ai_plugin.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/ai_plugin.md","title":"Higress\u52a9\u529bAI\u5927\u6a21\u578b\u4f01\u4e1a\u7ea7\u5e94\u7528\u843d\u5730","description":"\u4ecb\u7ecdHigress\u5982\u4f55\u901a\u8fc7AI proxy plugin\u5bf9\u63a5AI\u5927\u6a21\u578b\u5e76\u5b9e\u73b0\u7f51\u5173\u7ea7API\u7ba1\u7406","date":"2023-07-12T00:00:00.000Z","formattedDate":"2023\u5e747\u670812\u65e5","tags":[],"readingTime":15.14,"hasTruncateMarker":false,"authors":[{"name":"\u8d75\u4f1f\u57fa(\u5146\u7ef4)"}],"frontMatter":{"title":"Higress\u52a9\u529bAI\u5927\u6a21\u578b\u4f01\u4e1a\u7ea7\u5e94\u7528\u843d\u5730","keywords":["Higress","wasm","AI plugin"],"description":"\u4ecb\u7ecdHigress\u5982\u4f55\u901a\u8fc7AI proxy plugin\u5bf9\u63a5AI\u5927\u6a21\u578b\u5e76\u5b9e\u73b0\u7f51\u5173\u7ea7API\u7ba1\u7406","author":"\u8d75\u4f1f\u57fa(\u5146\u7ef4)","date":"2023-07-12T00:00:00.000Z","custom_edit_url":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/ai_plugin.md"},"prevItem":{"title":"Higress \u5168\u5c40\u914d\u7f6e\u63a7\u5236\u9762\u539f\u7406\u5206\u6790","permalink":"/zh-cn/blog/configmap"},"nextItem":{"title":"\u7f8e\u6d3d\u667a\u80fd\u5ba2\u670d\u4f7f\u7528 Higress \u7edf\u4e00\u7f51\u5173\u843d\u5730\u5b9e\u8df5","permalink":"/zh-cn/blog/user-mq"}},"content":"\u4ee5 ChatGPT \u4e3a\u4ee3\u8868\u7684 AIGC \u6280\u672f\u4e3a\u4f01\u4e1a\u751f\u4ea7\u5e26\u6765\u4e86\u5de8\u5927\u7684\u53d8\u5316\uff0c\u5e76\u5728\u4f01\u4e1a\u5e94\u7528\u5f00\u53d1\u9886\u57df\u5360\u636e\u4e00\u5e2d\u4e4b\u5730\u3002AI \u5927\u6a21\u578b\u51ed\u501f\u5176\u5f3a\u5927\u7684\u5b66\u4e60\u80fd\u529b\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4eba\u4eec\u5b8c\u6210\u5404\u79cd\u590d\u6742\u7684\u4efb\u52a1\uff0c\u4f8b\u5982\u5e2e\u52a9\u5f00\u53d1\u4eba\u5458\u7f16\u5199\u4e0e\u8c03\u8bd5\u4ee3\u7801\u3001\u7814\u7a76\u4eba\u5458\u5feb\u901f\u4e86\u89e3\u79d1\u7814\u9886\u57df\u3001\u8425\u9500\u4eba\u5458\u64b0\u5199\u4ea7\u54c1\u63cf\u8ff0\u3001\u8bbe\u8ba1\u4eba\u5458\u8bbe\u8ba1\u65b0\u4f5c\u54c1\u7b49\u7b49\u3002\u8bb8\u591a\u4f01\u4e1a\u63a2\u7d22\u5982\u4f55\u964d\u4f4e AI \u5927\u6a21\u578b\u7684\u4f7f\u7528\u6210\u672c\u3002\u901a\u8fc7\u7f51\u5173\u8fdb\u884c AI \u5927\u6a21\u578b\u7684 API \u7ba1\u7406\u6210\u4e3a\u4e86\u5f88\u5e38\u89c4\u7684\u9700\u6c42\u3002\\n\\n\\n## Higress \u5982\u4f55\u964d\u4f4e AI \u5927\u6a21\u578b\u4f7f\u7528\u6210\u672c\uff1f\\n\\nHigress GitHub\uff1a https://github.com/alibaba/higress\\n\\n\u4ee5 OpenAI \u4e3a\u4f8b\uff0cOpenAI \u7684 API \u8c03\u7528\u5e76\u4e0d\u662f\u57fa\u4e8e\u8bf7\u6c42\u91cf\u6216\u8005\u8ba2\u9605\u65f6\u95f4\u6765\u8ba1\u8d39\uff0c\u800c\u662f\u57fa\u4e8e\u6bcf\u4e2a\u8bf7\u6c42\u7684\u4f7f\u7528\u91cf\u6765\u8ba1\u8d39\u3002\u5bf9\u4e8e AI \u5927\u6a21\u578b\u6765\u8bf4\uff0c\u6a21\u578b\u8f93\u5165\u4e0e\u8f93\u51fa\u7684 token \u6570\u53ef\u4ee5\u6bd4\u8f83\u597d\u7684\u8861\u91cf\u5f53\u524d\u6a21\u578b\u8fdb\u884c\u63a8\u7406\u4efb\u52a1\u7684\u590d\u6742\u5ea6\u3002\u56e0\u6b64\u57fa\u4e8e token \u4f5c\u4e3a\u8bf7\u6c42\u4f7f\u7528\u91cf\u8fdb\u884c\u8ba1\u8d39\u662f OpenAI-API \u7684\u6807\u51c6\u8ba1\u8d39\u7b56\u7565\u3002\u5bf9\u4e8e\u4e0d\u540c\u7684\u6a21\u578b token \u7684\u8ba1\u8d39\u6807\u51c6\u4e5f\u4e0d\u540c\uff0c\u8d8a\u590d\u6742\u7684\u6a21\u578b\u4f1a\u751f\u6210\u8d8a\u597d\u7684\u7ed3\u679c\uff0c\u4f46\u4e5f\u4f1a\u5e26\u6765\u66f4\u9ad8\u7684\u8ba1\u8d39\u3002OpenAI \u901a\u8fc7\u4e3a\u7528\u6237\u5206\u53d1 API \u5bc6\u94a5\u6765\u5b8c\u6210\u7528\u6237\u7684\u9274\u6743\u4e0e\u6536\u8d39\u7b49\u529f\u80fd\u3002\\n\\n![image.png]( https://img.alicdn.com/imgextra/i1/O1CN01U3c6nD1grokneioDi_!!6000000004196-2-tps-3392-1436.png)\\n\\n\u5bf9\u4e8e\u7ec4\u7ec7\u6765\u8bf4\uff0c\u4e3a\u6bcf\u4f4d\u6210\u5458\u7533\u8bf7 AI \u5927\u6a21\u578b\u7684\u8bbf\u95ee\u6743\u9650\uff08 API-Key \uff09\u663e\u7136\u662f\u4e0d\u73b0\u5b9e\u7684\u3002\u5206\u6563\u7684 API \u5bc6\u94a5\u5c06\u4e0d\u5229\u4e8e\u7ec4\u7ec7\u8fdb\u884c API \u7684\u7528\u91cf\u8ba1\u7b97\u3001\u7ba1\u7406\u4e0e\u4ed8\u8d39\uff0c\u4ece\u800c\u589e\u52a0 AI \u5927\u6a21\u578b\u7684\u4f7f\u7528\u6210\u672c\u3002\u5176\u6b21\uff0c\u5bf9\u4e8e\u7ec4\u7ec7\u6765\u8bf4\uff0cAI \u6a21\u578b\u7684\u9009\u578b\u3001\u4f7f\u7528\u9891\u7387\u548c\u6210\u5458\u4f7f\u7528\u6743\u9650\u3001\u4ee5\u53ca\u5411 AI \u5927\u6a21\u578b\u66b4\u9732\u54ea\u4e9b\u6570\u636e\u90fd\u662f\u5728\u7ba1\u7406\u4e2d\u9700\u8981\u7740\u91cd\u5173\u6ce8\u7684\u529f\u80fd\u3002\\n\\nHigress \u57fa\u4e8e\u4e30\u5bcc\u7684\u63d2\u4ef6\u80fd\u529b\uff0c\u63d0\u4f9b\u4e86\u8ba4\u8bc1\u9274\u6743\u3001\u8bf7\u6c42\u8fc7\u6ee4\u3001\u6d41\u91cf\u63a7\u5236\u3001\u7528\u91cf\u76d1\u6d4b\u548c\u5b89\u5168\u9632\u62a4\u7b49\u529f\u80fd\uff0c\u80fd\u591f\u5e2e\u52a9\u7ec4\u7ec7\u4e0e AI \u5927\u6a21\u578b\u7684 API \u4ea4\u4e92\u53d8\u5f97\u66f4\u52a0\u5b89\u5168\u3001\u53ef\u9760\u548c\u53ef\u89c2\u5bdf\uff1a\u57fa\u4e8e Higress \u63d0\u4f9b\u7684\u8ba4\u8bc1\u9274\u6743\u80fd\u529b\uff0c\u7ec4\u7ec7\u53ef\u4ee5\u5b9e\u73b0\u901a\u8fc7\u7edf\u4e00\u7684 API \u5bc6\u94a5\u8fdb\u884c AI \u6a21\u578b\u7684\u8c03\u7528\u91cf\u7ba1\u7406\u548c\u4ed8\u8d39\uff0c\u5e76\u4e3a\u56e2\u961f\u6210\u5458\u6388\u4e88\u4e0d\u540c\u7684 AI \u6a21\u578b\u8bbf\u95ee\u6743\u9650\uff1b\u57fa\u4e8e Higress \u63d0\u4f9b\u7684\u6d41\u91cf\u63a7\u5236\u80fd\u529b\uff0c\u7ec4\u7ec7\u80fd\u4e3a\u4e0d\u540c\u7684\u6a21\u578b\u4e0e\u7528\u6237\u8bbe\u7f6e\u5dee\u5f02\u5316\u7684\u8bbf\u95ee\u901f\u7387\u9650\u5236\uff0c\u6709\u6548\u964d\u4f4e AI \u6a21\u578b\u7684\u4f7f\u7528\u6210\u672c\uff1b\u57fa\u4e8e Higress \u63d0\u4f9b\u7684\u8bf7\u6c42\u62e6\u622a\u80fd\u529b\uff0c\u7ec4\u7ec7\u80fd\u591f\u6709\u6548\u8fc7\u6ee4\u542b\u654f\u611f\u4fe1\u606f\u7684\u8bbf\u95ee\u8bf7\u6c42\uff0c\u9632\u62a4\u90e8\u5206\u5185\u90e8\u7ad9\u70b9\u8d44\u6e90\u4e0d\u5bf9\u5916\u66b4\u9732\uff0c\u4ece\u800c\u6709\u6548\u4fdd\u969c\u5185\u90e8\u6570\u636e\u5b89\u5168\uff1b\u57fa\u4e8e[\u5546\u4e1a\u7248 Higress]( https://www.alibabacloud.com/product/microservices-engine?spm=higress-website.topbar.0.0.0)\u63d0\u4f9b\u7684\u5f00\u7bb1\u5373\u7528\u7684\u6307\u6807\u67e5\u8be2\u548c\u65e5\u5fd7\u8bb0\u5f55\u7684\u80fd\u529b\uff0c\u7ec4\u7ec7\u80fd\u591f\u5b8c\u6210\u5bf9\u4e0d\u540c\u7528\u6237\u7684 AI \u6a21\u578b\u8c03\u7528\u7684\u7528\u91cf\u89c2\u6d4b\u4e0e\u5206\u6790\uff0c\u4ece\u800c\u5236\u5b9a\u66f4\u52a0\u5408\u7406\u7684 AI \u6a21\u578b\u4f7f\u7528\u7b56\u7565\u3002\\n\\n![image.png]( https://img.alicdn.com/imgextra/i4/O1CN01439pNf1OX3ia9UQ4Z_!!6000000001714-2-tps-2962-1688.png)                           \\n \\n## Higress \u5bf9\u63a5 OpenAI \u5927\u8bed\u8a00\u6a21\u578b\u5b9e\u6218\\n\\n\u4e0b\u9762\u6211\u4eec\u5c06\u4ee5 Higress \u5bf9\u63a5 OpenAI \u5927\u8bed\u8a00\u6a21\u578b\u4e3a\u4f8b\uff0c\u4ecb\u7ecd Higress \u5982\u4f55\u65e0\u7f1d\u5bf9\u63a5 AI \u5927\u6a21\u578b\u3002\u6574\u4f53\u65b9\u6848\u5982\u56fe\u6240\u793a\uff0c\u6211\u4eec\u57fa\u4e8e WASM \u62d3\u5c55\u4e86 Higress \u63d2\u4ef6\uff0c\u5b9e\u73b0\u4e86\u5bf9 OpenAI \u8bed\u8a00\u6a21\u578b\u7684\u8bf7\u6c42\u4ee3\u7406\u8f6c\u53d1\u3002\u57fa\u4e8e Higress \u63d0\u4f9b\u7684 Key-Auth \u8ba4\u8bc1\u63d2\u4ef6\u7684\u80fd\u529b\uff0c\u6211\u4eec\u5b9e\u73b0\u7edf\u4e00 API-Key \u4e0b\u7684\u591a\u79df\u6237\u8ba4\u8bc1\u3002\u57fa\u4e8e Higress \u63d0\u4f9b\u7684 Request-Block \u8bf7\u6c42\u8fc7\u6ee4\u7684\u80fd\u529b\uff0c\u6211\u4eec\u5c06\u5b9e\u73b0\u542b\u654f\u611f\u4fe1\u606f\u7684\u8bf7\u6c42\u62e6\u622a\uff0c\u4fdd\u969c\u7528\u6237\u6570\u636e\u5b89\u5168\u3002\\n\\n![]( https://img.alicdn.com/imgextra/i2/O1CN01WjbLBi23A451Ip2xp_!!6000000007214-2-tps-1544-368.png)\\n\\n### \u524d\u63d0\u6761\u4ef6\uff1a\\n1. \u5b89\u88c5 Higress \uff0c\u53c2\u8003[Higress \u5b89\u88c5\u90e8\u7f72\u6587\u6863]( https://higress.io/zh-cn/docs/ops/deploy-by-helm/#%E6%94%AF%E6%8C%81-istio-crd%E5%8F%AF%E9%80%89)\u3002\\n2. \u51c6\u5907 Go \u8bed\u8a00\u5f00\u53d1 WASM \u63d2\u4ef6\u7684\u5f00\u53d1\u73af\u5883\uff0c\u53c2\u8003[\u4f7f\u7528 GO \u8bed\u8a00\u5f00\u53d1 WASM \u63d2\u4ef6]( https://higress.io/zh-cn/docs/user/wasm-go)\u3002\\n\\n### \u57fa\u4e8e WASM \u7684 AI Proxy Plugin \\n\u4e0b\u6587\u5c06\u7ed9\u51fa\u57fa\u4e8e Higress \u4e0e WASM \u5b9e\u73b0\u7684 AI \u5927\u6a21\u578b API \u4ee3\u7406\u63d2\u4ef6\u65b9\u6848\u3002Higress \u652f\u6301\u57fa\u4e8e WASM \u5b9e\u73b0\u5bf9\u5916\u6269\u5c55\u7684\u80fd\u529b\u3002WASM \u63d2\u4ef6\u63d0\u4f9b\u7684\u591a\u8bed\u8a00\u751f\u6001\u548c\u70ed\u63d2\u62d4\u673a\u5236\u4e3a\u63d2\u4ef6\u7684\u5b9e\u73b0\u548c\u90e8\u7f72\u63d0\u4f9b\u4e86\u4fbf\u5229\u3002Higress \u540c\u65f6\u652f\u6301\u5728\u63d2\u4ef6\u4e2d\u8bf7\u6c42\u5916\u90e8\u670d\u52a1\uff0c\u4e3a AI \u4ee3\u7406\u63d2\u4ef6\u7684\u5b9e\u73b0\u63d0\u4f9b\u4e86\u9ad8\u6548\u7684\u89e3\u51b3\u8def\u5f84\u3002\\n\\n#### \u5b9e\u73b0\u793a\u4f8b\uff1a\\n\u6211\u4eec\u7ed9\u51fa OpenAI-API \u7684\u4ee3\u7406\u63d2\u4ef6\u7684\u5b9e\u73b0\u793a\u4f8b\uff0c\u8be6\u60c5\u8bf7\u53c2\u8003[AI proxy plugin]( https://github.com/alibaba/higress/tree/main/plugins/wasm-go/extensions/chatgpt-proxy)\u3002\u4e0b\u5217\u4ee3\u7801\u5b9e\u73b0\u4e86\u63d2\u4ef6\u76f8\u5173\u914d\u7f6e\u5b8c\u6210\u4e4b\u540e\uff0c\u57fa\u4e8e HTTP \u81ea\u52a8\u5c06\u8bf7\u6c42\u4ee3\u7406\u8f6c\u53d1\u5230 OpenAI-API \uff0c\u5e76\u63a5\u6536\u6765\u81ea OpenAI-API \u7684\u54cd\u5e94\uff0c\u4ece\u800c\u5b8c\u6210 AI \u6a21\u578b\u7684\u8c03\u7528\uff0c\u5177\u4f53\u5b9e\u73b0\u6b65\u9aa4\u5982\u4e0b\uff1a\\n\\n1. \u901a\u8fc7 RouteCluster \u65b9\u6cd5\u6307\u5b9a\u5177\u4f53\u7684 OpenAI-API \u7684 host \uff0c\u786e\u8ba4\u7528\u6237\u8bf7\u6c42\u8f6c\u53d1\u7684\u5177\u4f53\u8def\u5f84\uff0c\u5e76\u65b0\u5efa\u7528\u4e8e\u8bf7\u6c42\u4ee3\u7406\u8f6c\u53d1\u7684 HTTP Client \u3002\\n\\n```go\\nfunc parseConfig(json gjson.Result, config *MyConfig, log wrapper.Log) error {\\n\\tchatgptUri := json.Get(\\"chatgptUri\\").String()\\n\\tvar chatgptHost string\\n\\tif chatgptUri == \\"\\" {\\n\\t\\tconfig.ChatgptPath = \\"/v1/completions\\"\\n\\t\\tchatgptHost = \\"api.openai.com\\"\\n\\t} //\u8bf7\u6c42\u9ed8\u8ba4\u8f6c\u53d1\u5230 OpenAI-API\\n    ...\\n\\tconfig.client = wrapper.NewClusterClient(wrapper.RouteCluster{\\n\\t\\tHost: chatgptHost,\\n\\t}) //\u901a\u8fc7 RouteCluster \u65b9\u6cd5\u786e\u8ba4\u8bf7\u6c42\u8f6c\u53d1\u7684\u5177\u4f53 host\\n\\t ...\\n}\\n```\\n\\n2. \u5bf9\u7528\u6237\u8bf7\u6c42\u8fdb\u884c OpenAI-API \u7684\u683c\u5f0f\u5c01\u88c5\uff0c\u901a\u8fc7 HTTP Client \u8fdb\u884c\u8bf7\u6c42\u8f6c\u53d1\u4e0e\u54cd\u5e94\u63a5\u53d7\uff0c\u5e76\u5c06\u54cd\u5e94\u8f6c\u53d1\u7ed9\u7528\u6237\u3002\\n   \\n```go\\n//OpenAI API \u63a5\u6536\u7684\u8bf7\u6c42\u4f53\u6a21\u7248\uff0c\u8be6\u89c1\uff1a https://platform.openai.com/docs/api-reference/chat\\nconst bodyTemplate string = `\\n{\\n\\"model\\":\\"%s\\",\\n\\"prompt\\":\\"%s\\",\\n\\"temperature\\":0.9,\\n\\"max_tokens\\": 150,\\n\\"top_p\\": 1,\\n\\"frequency_penalty\\": 0.0,\\n\\"presence_penalty\\": 0.6,\\n\\"stop\\": [\\"%s\\", \\"%s\\"]\\n}\\n`\\nfunc onHttpRequestHeaders(ctx wrapper.HttpContext, config MyConfig, log wrapper.Log) types.Action {\\n    ...\\n    //\u6839\u636e\u7528\u6237\u7684\u8bf7\u6c42\u5185\u5bb9\u8fdb\u884c OpenAI-API \u8bf7\u6c42\u4f53\u5c01\u88c5 \\n\\tbody := fmt.Sprintf(bodyTemplate, config.Model, prompt[0], config.HumanId, config.AIId)\\n\\t//\u901a\u8fc7 HTTP Client \u8fdb\u884c\u8f6c\u53d1\\n    err = config.client.Post(config.ChatgptPath, [][2]string{\\n\\t\\t{\\"Content-Type\\", \\"application/json\\"},\\n\\t\\t{\\"Authorization\\", \\"Bearer \\" + config.ApiKey},\\n\\t}, []byte(body),\\n\\t\\tfunc(statusCode int, responseHeaders http.Header, responseBody []byte) {\\n\\t\\t\\tvar headers [][2]string\\n\\t\\t\\tfor key, value := range responseHeaders {\\n\\t\\t\\t\\theaders = append(headers, [2]string{key, value[0]})\\n\\t\\t\\t}\\n            //\u63a5\u6536\u6765\u81ea\u4e8e OpenAI-API \u7684\u54cd\u5e94\u5e76\u8f6c\u53d1\u7ed9\u7528\u6237\\n\\t\\t\\tproxywasm.SendHttpResponse(uint32(statusCode), headers, responseBody, -1)\\n\\t\\t}, 10000)\\n    ...\\n}\\n```\\n\\n\u5728 Higress \u4e2d\u542f\u7528\u81ea\u5b9a\u4e49\u7684 AI-Proxy-Wasm \u63d2\u4ef6\u6d41\u7a0b\u5982\u4e0b\uff1a\\n![]( https://img.alicdn.com/imgextra/i1/O1CN012qI5vq1gOVPEwxqRr_!!6000000004132-2-tps-2000-1064.png)\\n\\n\u672c\u793a\u4f8b\u63d0\u4f9b\u5df2\u7ecf\u7f16\u8bd1\u597d\u7684 AI-proxy-plugin-wasm \u6587\u4ef6\u5e76\u5b8c\u6210\u5bf9\u5e94 docker \u955c\u50cf\u7684\u6784\u5efa\u548c\u63a8\u9001\uff0c\u63a8\u8350\u914d\u7f6e\u5982\u4e0b\u6240\u793a\uff1a\\n\\n| \u540d\u79f0 | \u63a8\u8350\u914d\u7f6e |\\n| --- | --- |\\n| \u955c\u50cf\u5730\u5740 | oci://registry.cn-hangzhou.aliyuncs.com/zwj_test/chatgpt-proxy:1.0.0 |\\n| \u63d2\u4ef6\u6267\u884c\u9636\u6bb5 | \u9274\u6743\u9636\u6bb5 |\\n| \u63d2\u4ef6\u6267\u884c\u4f18\u5148\u7ea7 | 1 |\\n\\n#### \u63d2\u4ef6\u914d\u7f6e\u8bf4\u660e\uff1a\\n\\n\u63d2\u4ef6\u914d\u7f6e\u7b80\u5355\uff0c\u652f\u6301\u5168\u5c40/\u57df\u540d\u7ea7/\u8def\u7531\u7ea7\u7684\u4ee3\u7406\u8f6c\u53d1\u3002\u63a8\u8350\u8fdb\u884c\u8def\u7531\u7ea7\u914d\u7f6e\uff1a\u9009\u4e2d\u5bf9\u5e94\u7684**\u8def\u7531\u914d\u7f6e**-\u9009\u4e2d**\u5bf9\u5e94\u8def\u7531**-**\u7b56\u7565**-**\u542f\u7528\u63d2\u4ef6**\u3002\u914d\u7f6e\u5b57\u6bb5\u5305\u62ec\uff1a\\n\\n| \u540d\u79f0 | \u6570\u636e\u7c7b\u578b | \u586b\u5199\u8981\u6c42 | \u9ed8\u8ba4\u503c | \u63cf\u8ff0 |\\n| --- | --- | --- | --- | --- |\\n| model | string | \u9009\u586b | text-davinci-003 | \u8c03\u7528\u7684\u6a21\u578b\u540d\u79f0 |\\n| apiKey | string | \u5fc5\u586b | - | OpenAI-API \u5bc6\u94a5\uff0c\u8be6\u60c5\u53ef\u53c2\u8003 |\\n| promptParam | string | \u9009\u586b | prompt | prompt \u7684\u6765\u6e90\u5b57\u6bb5\u540d\u79f0\uff0cURL \u53c2\u6570 |\\n| chatgptUri | string | \u9009\u586b | api.openai.com/v1/completions | \u8c03\u7528 AI \u6a21\u578b\u670d\u52a1\u7684 URL \u8def\u5f84\uff0c\u9ed8\u8ba4\u503c\u4e3a OpenAI \u7684 API \u8c03\u7528\u8def\u5f84 |\\n\\n\u793a\u4f8b\u914d\u7f6e\u5982\u4e0b\uff1a\\n\\n```yaml\\napiKey: \\"xxxxxxxxxxxxxxxxxx\\"\\nmodel: \\"curie\\"\\npromptParam: \\"text\\"\\n```\\n\\n\u6839\u636e\u8be5\u914d\u7f6e\uff0c\u7f51\u5173\u4ee3\u7406\u5230 OpenAI-API \u4e0b\u7684 curie \u6a21\u578b\uff0c\u7528\u6237\u901a\u8fc7 text \u5173\u952e\u5b57\u5728 url \u4e2d\u8f93\u5165\u6587\u672c\u3002\\n\\n```shell\\ncurl \\"http://{GatewayIP}/?text=Say,hello\\"\\n```\\n\\n\u5f97\u5230 OpenAI-API \u7684\u54cd\u5e94\uff1a\\n![image.png]( https://img.alicdn.com/imgextra/i1/O1CN010ZHdxO1ZOmKXfjVaV_!!6000000003185-2-tps-3170-520.png)\\n\\n### \u57fa\u4e8e Key Auth \u7684\u591a\u79df\u6237\u8ba4\u8bc1\\n\\n\u4e0d\u540c\u4e8e\u4e3a\u6bcf\u4f4d\u6210\u5458\u9881\u53d1 OpenAI-API \u5bc6\u94a5\u7684\u5f62\u5f0f\uff0c\u4f01\u4e1a\u53ef\u4ee5\u57fa\u4e8e Higress \u7f51\u5173\u63d0\u4f9b\u7684\u8ba4\u8bc1\u9274\u6743\u80fd\u529b\uff0c\u4f9d\u9760\u5185\u90e8\u6388\u6743\uff08\u5982 Key Auth \u7b49\uff09\u6765\u7ba1\u7406\u6210\u5458\u5bf9 AI \u6a21\u578b\u5bf9\u8bbf\u95ee\u6743\u9650\uff0c\u4ece\u800c\u9650\u5236\u6210\u5458\u53ef\u4ee5\u4f7f\u7528\u7684\u670d\u52a1\u548c\u6a21\u578b\uff0c\u5e76\u4f9d\u9760\u7edf\u4e00\u7684 AI-API \u5bc6\u94a5\u8fdb\u884c\u8bf7\u6c42\u4ee3\u7406\u8f6c\u53d1\u5b9e\u73b0\u5bf9 API \u7528\u91cf\u7684\u7edf\u4e00\u7ba1\u7406\u3002\u63a5\u4e0b\u6765\u4ee5 Key Auth \u4e3a\u4f8b\u4ecb\u7ecd Higress \u7684\u591a\u79df\u6237\u8ba4\u8bc1\u80fd\u529b\u3002\\n\\nKey Auth \u63d2\u4ef6\u5b9e\u73b0\u4e86\u57fa\u4e8e\u7f51\u5173\u5185 API Key \u8fdb\u884c\u8ba4\u8bc1\u548c\u9274\u6743\u7684\u529f\u80fd\uff0c\u652f\u6301\u4ece HTTP \u8bf7\u6c42\u7684 URL \u53c2\u6570\u6216\u8005\u8bf7\u6c42\u5934\u89e3\u6790 API Key \uff0c\u540c\u65f6\u9a8c\u8bc1\u8be5 API \u662f\u5426\u6709\u6743\u9650\u8bbf\u95ee\u3002\u901a\u8fc7\u5728**Higress \u63a7\u5236\u53f0**-**\u63d2\u4ef6\u5e02\u573a**-**Key Auth**\u8fdb\u884c**\u5168\u5c40\u914d\u7f6e**\u548c**\u8def\u7531\u7ea7\u914d\u7f6e**\uff0c\u5373\u53ef\u5b9e\u73b0 Higress \u7f51\u5173\u7684\u591a\u79df\u6237\u8ba4\u8bc1\u3002\\n\\n![]( https://img.alicdn.com/imgextra/i1/O1CN01qaQxNw1DIthKfowWi_!!6000000000194-2-tps-2773-1350.png)\\n                                                \\n```yaml\\nconsumers:\\n- credential: \\"xxxxxx\\"\\n  name: \\"consumer1\\"\\n- credential: \\"yyyyyy\\"\\n  name: \\"consumer2\\"\\nglobal_auth: false\\nin_header: true\\nkeys:\\n- \\"apikey\\"\\n```\\n\\n![]( https://img.alicdn.com/imgextra/i4/O1CN01Or1jY41SYDAyTJ6ve_!!6000000002258-2-tps-2018-951.png)\\n                                                 \\n```yaml\\nallow: [consumer1]\\n```\\n\\n\u4ee5\u4e0a\u914d\u7f6e\u5b9a\u4e49\u4e86\u6307\u5411 AI \u6a21\u578b\u670d\u52a1\u7684\u6d88\u8d39\u8005\u7ec4`consumers`\uff0c\u5e76\u4e14\u53ea\u6709`consumer1`\u5177\u5907\u8bbf\u95ee\u5f53\u524d\u8def\u7531\u4e0b AI \u6a21\u578b\u670d\u52a1\u7684\u6743\u9650\u3002\\n\\n```yaml\\ncurl \\"http://{GatewayIP}/?text=Say,hello\\"\\n#\u8bf7\u6c42\u672a\u63d0\u4f9b API-Key \uff0c\u8fd4\u56de 401\\n\\ncurl \\"http://{GatewayIP}/?text=Say,hello\\" -H \\"apikey:zzzzzz\\"\\n#\u8bf7\u6c42\u63d0\u4f9b\u7684 API-Key \u672a\u5728\u6d88\u8d39\u8005\u7ec4\u5185\uff0c\u65e0\u6743\u8bbf\u95ee\uff0c\u8fd4\u56de 401\\n\\ncurl  \\"http://{GatewayIP}/?text=Say,hello\\" -H \\"apikey:yyyyyy\\"\\n#\u6839\u636e\u8bf7\u6c42\u63d0\u4f9b\u7684 API-Keyy \u5339\u914d\u5230\u7684\u8c03\u7528\u8005\u65e0 AI \u6a21\u578b\u670d\u52a1\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u8fd4\u56de 403\\n\\ncurl \\"http://{GatewayIP}/?text=Say,hello\\" -H \\"apikey:xxxxxx\\"\\n#\u8bf7\u6c42\u5408\u6cd5\u4e14\u6709 AI \u6a21\u578b\u670d\u52a1\u8bbf\u95ee\u6743\u9650\uff0c\u8bf7\u6c42\u5c06\u88ab\u4ee3\u7406\u5230 AI \u6a21\u578b\uff0c\u6b63\u5e38\u5f97\u5230 OpenAI-API \u7684\u54cd\u5e94\\n```\\n\\nHigress \u9664\u4e86\u63d0\u4f9b\u7f51\u5173\u7ea7\u591a\u79df\u6237\u8ba4\u8bc1\u5916\uff0c\u8fd8\u80fd\u63d0\u4f9b\u9650\u6d41\u7b49\u80fd\u529b\u3002Key Rate Limit \u63d2\u4ef6\u53ef\u4ee5\u6839\u636e\u7528\u6237\u5728\u6d88\u8d39\u7ec4\u4e2d\u7684\u6210\u5458\u8d44\u683c\u5bf9\u7528\u6237\u8bf7\u6c42\u901f\u7387\u8fdb\u884c\u9650\u5236\uff0c\u4ece\u800c\u9650\u5236\u5e94\u7528\u7a0b\u5e8f\u5bf9\u9ad8\u6210\u672c AI \u5927\u6a21\u578b\u670d\u52a1\u7684\u6d88\u8017\u3002\u57fa\u4e8e\u591a\u79df\u6237\u8ba4\u8bc1\u4e0e\u9650\u6d41\u7b49\u529f\u80fd\uff0cHigress \u53ef\u4ee5\u5b8c\u5168\u63a7\u5236 AI \u5927\u6a21\u578b API \u7684\u8bbf\u95ee\u6743\u9650\u3001\u8bbf\u95ee\u6570\u91cf\u4e0e\u8c03\u7528\u6210\u672c\u3002\\n\\n### \u57fa\u4e8e Request Block \u4fdd\u969c\u6570\u636e\u5b89\u5168\\n\\n\u5bf9\u4e8e AI \u5927\u6a21\u578b\u5c24\u5176\u662f\u8bed\u8a00\u6a21\u578b\u6765\u8bf4\uff0c\u8981\u5f97\u5230\u826f\u597d\u7684\u8fd4\u56de\u5f80\u5f80\u9700\u8981\u7528\u6237\u63d0\u4f9b\u8db3\u591f\u7684\u63d0\u793a\uff08 prompt \uff09\u4f5c\u4e3a\u6a21\u578b\u8f93\u5165\u3002\u8fd9\u4e5f\u610f\u5473\u7740\u7ec4\u7ec7\u548c\u4e2a\u4eba\u53ef\u80fd\u4f1a\u5728\u63d0\u4f9b\u63d0\u793a\u7684\u8fc7\u7a0b\u4e2d\u9762\u4e34\u6570\u636e\u6cc4\u6f0f\u7684\u98ce\u9669\u3002\u56e0\u6b64\u5982\u4f55\u5728\u4f7f\u7528 AI \u6a21\u578b\u7684\u8fc7\u7a0b\u4e2d\u4fdd\u969c\u6570\u636e\u5b89\u5168\u4e5f\u662f API \u8c03\u7528\u65b9\u9762\u4e34\u91cd\u8981\u95ee\u9898\u3002\u4fdd\u62a4\u6570\u636e\u5b89\u5168\u6d89\u53ca\u5230\u5bf9 AI \u6a21\u578b\u7684 API \u8c03\u7528\u6e20\u9053\u8fdb\u884c\u4e25\u683c\u7684\u63a7\u5236\u3002\u4e00\u79cd\u65b9\u5f0f\u662f\u4f7f\u7528\u7279\u5b9a\u7684\u7ecf\u6279\u51c6\u7684\u6a21\u578b\u4e0e\u5176\u53d1\u5e03\u7684 API \u3002\u53e6\u4e00\u79cd\u65b9\u5f0f\u662f\u5bf9\u542b\u654f\u611f\u4fe1\u606f\u7684\u7528\u6237\u8bf7\u6c42\u8fdb\u884c\u62e6\u622a\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u5728\u7f51\u5173\u7ea7\u522b\u8bbe\u7f6e\u7279\u5b9a\u7684\u8bf7\u6c42\u62e6\u622a\u6765\u5b9e\u73b0\u3002Higress \u57fa\u4e8e Request Block \u63d2\u4ef6\u63d0\u4f9b\u8bf7\u6c42\u62e6\u622a\u80fd\u529b\uff0c\u65e2\u80fd\u9632\u6b62\u672a\u7ecf\u6388\u6743\u7684\u6a21\u578b\u8bbf\u95ee\u7528\u6237\u4fe1\u606f\uff0c\u53c8\u80fd\u9632\u6b62\u542b\u654f\u611f\u4fe1\u606f\u7684\u7528\u6237\u8bf7\u6c42\u66b4\u9732\u5230\u5916\u7f51\u3002\\n\\nRequest Block \u63d2\u4ef6\u57fa\u4e8e URL \u3001\u8bf7\u6c42\u5934\u7b49\u7279\u5f81\u5c4f\u853d HTTP \u8bf7\u6c42\uff0c\u53ef\u4ee5\u7528\u4e8e\u9632\u62a4\u7ad9\u70b9\u8d44\u6e90\u4e0d\u5bf9\u5916\u66b4\u9732\u3002 \u901a\u8fc7\u5728**Higress \u63a7\u5236\u53f0**-**\u63d2\u4ef6\u5e02\u573a-Request Block**\u8fdb\u884c\u5c4f\u853d\u5b57\u6bb5\u914d\u7f6e\uff0c\u5373\u53ef\u9632\u6b62\u542b\u654f\u611f\u5b57\u6bb5\u7684\u8bf7\u6c42\u5bf9\u5916\u53d1\u9001\u3002\\n\\n![]( https://img.alicdn.com/imgextra/i3/O1CN01mqWHos1XDD5yRxOeX_!!6000000002889-2-tps-2905-914.png)\\n                                \\n```yaml\\nblocked_code: 404\\nblock_urls:\\n- password\\n- pw\\ncase_sensitive: false\\n```\\n\\n\u4ee5\u4e0a\u914d\u7f6e\u5b9a\u4e49\u4e86\u5f53\u524d\u8def\u7531\u4e0b\u57fa\u4e8e URL \u7684\u5c4f\u853d\u5b57\u6bb5\uff0c\u5176\u4e2d\u542b\u654f\u611f\u4fe1\u606f\uff08\u5982 password \u3001pw \uff09\u7684\u8bf7\u6c42\u5c06\u88ab\u5c4f\u853d\u3002\\n\\n```yaml\\ncurl \\"http://{GatewayIP}/?text=Mypassword=xxxxxx\\" -H \\"apikey:xxxxxx\\"\\ncurl \\"http://{GatewayIP}/?text=pw=xxxxxx\\" -H \\"apikey:xxxxxx\\"\\n#\u4e0a\u8ff0\u8bf7\u6c42\u5c06\u88ab\u7981\u6b62\u8bbf\u95ee\uff0c\u8fd4\u56de 404\\n```\\n### \u57fa\u4e8e\u5546\u4e1a\u7248 Higress \u7684\u7528\u91cf\u89c2\u6d4b\u4e0e\u5206\u6790\\n\\n\u5bf9\u4e8e\u7ec4\u7ec7\u6765\u8bf4\uff0c\u5bf9\u5404\u7528\u6237\u8fdb\u884c AI \u6a21\u578b\u8c03\u7528\u7684\u7528\u91cf\u89c2\u6d4b\u548c\u5206\u6790\u6709\u52a9\u4e8e\u4e86\u89e3\u5176\u4f7f\u7528\u60c5\u51b5\u4e0e\u4ea7\u751f\u7684\u6210\u672c\u3002\u5bf9\u4e8e\u4e2a\u4eba\u7528\u6237\uff0c\u4e86\u89e3\u81ea\u5df1\u7684\u8c03\u7528\u91cf\u548c\u5f00\u9500\u4e5f\u662f\u5fc5\u8981\u7684\u3002\u56e0\u6b64\uff0c\u5728\u7f51\u5173\u5c42\u8fdb\u884c\u8c03\u7528\u7684\u89c2\u6d4b\u548c\u5206\u6790\u5bf9\u4e8e AI \u5927\u6a21\u578b\u7684 API \u7ba1\u7406\u662f\u5fc5\u8981\u7684\u80fd\u529b\u3002[\u5546\u4e1a\u7248 Higress]( https://www.alibabacloud.com/product/microservices-engine?spm=higress-website.topbar.0.0.0)\u4e0e\u5404\u79cd\u6307\u6807\u4e0e\u65e5\u5fd7\u7cfb\u7edf\u8fdb\u884c\u4e86\u6df1\u5ea6\u96c6\u6210\uff0c\u63d0\u4f9b\u4e86\u5f00\u7bb1\u5373\u7528\u7684\u7528\u91cf\u89c2\u6d4b\u5206\u6790\u62a5\u544a\u6784\u5efa\u673a\u5236\uff0c\u53ef\u4ee5\u5b9e\u65f6\u67e5\u770b\u5404\u79cd API \u7684\u4f7f\u7528\u60c5\u51b5\uff0c\u5e76\u6839\u636e\u5404\u7c7b\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\uff0c\u4ece\u800c\u66f4\u597d\u7684\u4e86\u89e3 API \u4f7f\u7528\u60c5\u51b5\u3002\\n\\n\u4ee5\u89c2\u5bdf\u5404\u7528\u6237\u5bf9 OpenAI-Curie \u6a21\u578b\u7684\u8c03\u7528\u91cf\u4e3a\u4f8b\uff0c\u7528\u6237\u53ef\u901a\u8fc7**MSE \u7ba1\u7406\u63a7\u5236\u53f0**-**\u4e91\u539f\u751f\u7f51\u5173**-**\u7f51\u5173\u5b9e\u4f8b**-**\u53c2\u6570\u914d\u7f6e-\u65e5\u5fd7\u683c\u5f0f\u8c03\u6574**\u4e2d\u8bbe\u7f6e\u533a\u5206\u7528\u6237\u7684\u53ef\u89c2\u6d4b\u6027\u53c2\u6570\u8bf7\u6c42\u5934\uff1a`x-mse-consumer`\uff0c\u5c06\u5176\u5217\u5165\u89c2\u6d4b\u5217\u8868\u3002\u4e4b\u540e\u8fdb\u5165**\u89c2\u6d4b\u5206\u6790-\u65e5\u5fd7\u4e2d\u5fc3**\u4e2d\u8bbe\u7f6e\u4f7f\u7528\u7edf\u8ba1\u56fe\u8868\u529f\u80fd\u5373\u53ef\u5b8c\u6210\u5bf9 API \u7684\u7528\u91cf\u89c2\u6d4b\u548c\u5206\u6790\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u7528\u6237`consumer1`\u4e0e\u7528\u6237`consumer2`\u7684\u5bf9 OpenAI-Curie \u6a21\u578b\u7684\u8c03\u7528\u91cf\u4ee5\u997c\u72b6\u56fe\u5f62\u5f0f\u5448\u73b0\u3002\\n![image.png]( https://img.alicdn.com/imgextra/i1/O1CN01OuAcQD24P0cStcIJE_!!6000000007382-2-tps-2362-864.png)\\n  \\n                           \\n                           \\n## \u52a0\u5165 Higress \u793e\u533a\\n\\n![image.png]( https://img.alicdn.com/imgextra/i2/O1CN01Ahr6qi1vL2e1xPJEy_!!6000000006155-2-tps-1685-1091.png)\\n\\n\u5982\u679c\u60a8\u89c9\u5f97 Higress \u5bf9\u60a8\u6709\u5e2e\u52a9\uff0c\u6b22\u8fce\u524d\u5f80[github: Higress]( https://github.com/alibaba/higress)\u4e3a\u6211\u4eec star \u4e00\u4e0b\uff01"},{"id":"/user-mq","metadata":{"permalink":"/zh-cn/blog/user-mq","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/user-mq.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/user-mq.md","title":"\u7f8e\u6d3d\u667a\u80fd\u5ba2\u670d\u4f7f\u7528 Higress \u7edf\u4e00\u7f51\u5173\u843d\u5730\u5b9e\u8df5","description":"\u7f8e\u6d3d\u5728\u963f\u91cc\u4e91\u4e0a\u91c7\u7528Higress\u4f01\u4e1a\u7248\uff0c\u5728\u5176\u4ed6\u4e91\u91c7\u7528Higress\u5f00\u6e90\u7248\uff0c\u7edf\u4e00\u4e86\u7f51\u5173\u67b6\u6784","date":"2023-07-10T00:00:00.000Z","formattedDate":"2023\u5e747\u670810\u65e5","tags":[],"readingTime":10.615,"hasTruncateMarker":false,"authors":[{"name":"\u53e4\u5efa\u56fd (Larry Koo)"}],"frontMatter":{"title":"\u7f8e\u6d3d\u667a\u80fd\u5ba2\u670d\u4f7f\u7528 Higress \u7edf\u4e00\u7f51\u5173\u843d\u5730\u5b9e\u8df5","keywords":["higress","\u7f8e\u6d3d"],"description":"\u7f8e\u6d3d\u5728\u963f\u91cc\u4e91\u4e0a\u91c7\u7528Higress\u4f01\u4e1a\u7248\uff0c\u5728\u5176\u4ed6\u4e91\u91c7\u7528Higress\u5f00\u6e90\u7248\uff0c\u7edf\u4e00\u4e86\u7f51\u5173\u67b6\u6784","author":"\u53e4\u5efa\u56fd (Larry Koo)","date":"2023-07-10T00:00:00.000Z"},"prevItem":{"title":"Higress\u52a9\u529bAI\u5927\u6a21\u578b\u4f01\u4e1a\u7ea7\u5e94\u7528\u843d\u5730","permalink":"/zh-cn/blog/ai_plugin"},"nextItem":{"title":"Higress \u96c6\u6210 Skywalking \u53ef\u89c2\u6d4b\u6027\u63a2\u7d22","permalink":"/zh-cn/blog/skywalking"}},"content":"## \u5173\u4e8e\u7f8e\u6d3d\\n\\n\u7f8e\u6d3d\u662f\u4e00\u5bb6\u5168\u7403\u667a\u80fd\u4e91\u5ba2\u670d\u670d\u52a1\u5546\uff0c\u63d0\u4f9b\u4e00\u7ad9\u5f0f\u667a\u80fd\u5ba2\u670d\u89e3\u51b3\u65b9\u6848\uff0c\u65d7\u4e0b\u62e5\u6709\u5728\u7ebf\u5ba2\u670d\u3001\u5de5\u5355\u7cfb\u7edf\u3001\u547c\u53eb\u4e2d\u5fc3\u3001\u5ba2\u670d\u673a\u5668\u4eba\u3001\u8bed\u97f3\u673a\u5668\u4eba\u3001\u8425\u9500\u673a\u5668\u4eba\u7b49\u4ea7\u54c1\u53ca\u670d\u52a1\u3002\u7f8e\u6d3d\u6210\u7acb\u4e8e2014\u5e74\uff0c\u603b\u90e8\u4f4d\u4e8e\u6210\u90fd\uff0c\u76ee\u524d\u670d\u52a1\u4f01\u4e1a\u7528\u6237\u5df2\u8d85\u8fc740\u4e07\u5bb6\uff0c\u8986\u76d6\u591a\u4e2a\u884c\u4e1a\u9886\u57df\u3002\u7f8e\u6d3d\u7684\u5ba2\u670d\u7cfb\u7edf\u652f\u6301\u591a\u5e73\u53f0\u4f7f\u7528\uff0c\u5305\u62ecWeb \u7f51\u9875\u7aef\u3001\u624b\u673a\u5ba2\u6237\u7aef\u3001PC \u5ba2\u6237\u7aef\uff0c\u540c\u65f6\u7f8e\u6d3d\u4e5f\u63d0\u4f9b\u4e86\u5f00\u653e API \u5e73\u53f0\u3002\\n\\n## \u9700\u6c42\u80cc\u666f\\n\\n1. \u591a\u6761\u4e1a\u52a1\u7ebf\u4f7f\u7528\u4e86\u4e86\u4e0d\u540c\u7f16\u7a0b\u8bed\u8a00\uff0c\u5728\u5fae\u670d\u52a1\u5316\u6f14\u8fdb\u7684\u8def\u4e0a\u56f0\u96be\u91cd\u91cd\uff1b\\n2. \u5386\u53f2\u67b6\u6784\u4f7f\u7528\u591a\u4e2a\u6d41\u91cf\u8f6c\u53d1\u4e2d\u95f4\u4ef6\u5bfc\u81f4\u6d41\u91cf\u8def\u5f84\u5197\u957f\u3001\u590d\u6742\u4e14\u6545\u969c\u6392\u67e5\u56f0\u96be\uff08LB + OpenResty + Nginx + Caddy + SpringCloud-Gateway\uff09\uff1b\\n3. WebSocket \u957f\u8fde\u63a5\u670d\u52a1\u5728\u591a\u91cd\u8def\u7531\u5c42\u4e0a\u4e0d\u652f\u6301\u70ed\u66f4\u65b0\uff0c\u7ef4\u62a4\u6210\u672c\u9ad8\u3002\\n\\n**\u5386\u53f2\u67b6\u6784\u7684\u6d41\u91cf\u62d3\u6251\u56fe\u5982\u4e0b\uff1a**\\n\\n![](https://img.alicdn.com/imgextra/i4/O1CN01AJitLM1kgbW6yGLmV_!!6000000004713-0-tps-627-517.jpg)\\n\\n## \u9700\u6c42\u76ee\u6807\\n\\n1. \u627e\u5230\u4e00\u4e2a\u7edf\u4e00\u7f51\u5173\uff0c\u80fd\u591f\u4e00\u6b21\u6027\u89e3\u51b3\u6d41\u91cf\u7f51\u5173\u548c\u4e1a\u52a1\u7f51\u5173\u7684\u8def\u7531\u8f6c\u53d1\u9700\u6c42\uff1b\\n2. \u652f\u6301\u8def\u7531\u89c4\u5219\u70ed\u66f4\u65b0\uff0c\u89e3\u51b3 WebSocket \u8fde\u63a5\u5728\u8def\u7531\u66f4\u65b0\u6216\u7f51\u7edc\u6296\u52a8\u65f6\u4ea7\u751f\u7684\u91cd\u8fde\u98ce\u66b4\uff1b\\n3. \u524d\u7f6eAPI \u8bf7\u6c42\u6743\u9650\u6821\u9a8c\u3001\u7b7e\u540d\u6821\u9a8c\u3001WAF \u62e6\u622a\u3001CC \u62e6\u622a\uff1b\\n4. \u53ef\u89c6\u5316\u7edf\u4e00\u7f51\u5173\u7684\u540e\u53f0\u64cd\u4f5c\uff0c\u8ba9\u666e\u901a\u5458\u5de5\u4e5f\u80fd\u4e0a\u624b\uff1b\\n5. \u591a\u4e91\u67b6\u6784\u4e0b\u79c1\u6709\u5316\u90e8\u7f72\u652f\u6301\u3002\\n\\n## \u65b9\u6848\u6a2a\u5411\u5bf9\u6bd4\\n\\n\u901a\u8fc7\u5bf9\u76ee\u524d\u5e02\u9762\u4e0a\u6d41\u884c\u7684\u7f51\u5173\u4ea7\u54c1\u8fdb\u884c\u8be6\u7ec6\u7684\u6a2a\u5411\u5bf9\u6bd4\uff0c\u518d\u7ed3\u5408\u7f8e\u6d3d\u5bf9\u7edf\u4e00\u7f51\u5173\u7684\u9700\u6c42\u76ee\u6807\uff0c\u6211\u4eec\u4ece\u5bf9\u6bd4\u7684\u8868\u683c\u5f53\u4e2d\uff0c\u770b\u5230\u4e86 Higress \u6240\u5e26\u6765\u7684\u6700\u4f73\u5bf9\u6bd4\u7ed3\u679c\u3002\\n\\n\u540c\u65f6\u7f8e\u6d3d\u91cd\u70b9\u5173\u6ce8\u7684\u51e0\u4e2a\u70b9\uff1aK8S Ingress \u652f\u6301\u3001WebSocket\u652f\u6301\u3001Nacos \u670d\u52a1\u53d1\u73b0\u3001\u8def\u7531\u914d\u7f6e\u70ed\u66f4\u65b0\u3001WASM \u63d2\u4ef6\u90fd\u5f97\u5230\u4e86\u5f88\u597d\u7684\u652f\u6301\u3002\\n\\n\\n![](https://img.alicdn.com/imgextra/i1/O1CN01bjoMSi1arSkPgWvVV_!!6000000003383-0-tps-750-470.jpg)\\n\\n## \u4e3a\u4ec0\u4e48\u9009\u62e9 Higress\\n\\n### \u9762\u5411\u591a\u4e91\u67b6\u6784\u53cb\u597d\\n\\nHigress \u5728\u963f\u91cc\u4e91\u4e0a\u6709\u6210\u719f\u7684\u4f01\u4e1a\u7248\u4ea7\u54c1\uff1aMSE \u4e91\u539f\u751f\u7f51\u5173\uff0c\u6211\u4eec\u4ece 2021 \u5e74\u5f00\u59cb\u4f7f\u7528\u8fd9\u6b3e\u4ea7\u54c1\uff0c\u8fd9\u662f\u4e00\u6b3e\u5168\u6258\u7ba1\uff0c\u5b8c\u5168\u514d\u8fd0\u7ef4\u7684 SaaS \u7f51\u5173\u4ea7\u54c1\uff0c\u5e76\u4e14\u5177\u5907\u5f3a\u52b2\u7684\u6027\u80fd\u548c\u4e30\u5bcc\u7684\u529f\u80fd\uff0c\u76f8\u6bd4\u81ea\u5efa\u540c\u541e\u5410\u7684\u7f51\u5173\uff0c\u6574\u4f53\u6210\u672c\u662f\u66f4\u4f4e\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u5728\u963f\u91cc\u4e91\u4e0a\u76f4\u63a5\u4f7f\u7528\u4e86\u8fd9\u6b3e\u4ea7\u54c1\u3002\\n\\n\u7f8e\u6d3d\u9664\u4e86\u963f\u91cc\u4e91\uff0c\u5728\u5176\u4ed6\u4e91\u4e0a\u4e5f\u6709\u90e8\u7f72\u4e1a\u52a1\uff0c\u6211\u4eec\u5e0c\u671b\u80fd\u7edf\u4e00\u591a\u4e91\u7684\u7edf\u4e00\u7f51\u5173\u6280\u672f\u67b6\u6784\uff0c\u5f00\u6e90\u7248 Higress \u6b63\u597d\u7b26\u5408\u6211\u4eec\u7684\u9700\u6c42\uff0c\u76f8\u6bd4\u5546\u4e1a\u7248\uff0c\u5728\u63a7\u5236\u53f0\u529f\u80fd\u4e0a\uff0c\u5f00\u6e90\u7248\u76ee\u524d\u7684\u80fd\u529b\u76f8\u5bf9\u8f83\u5c11\uff0c\u4f46\u5927\u90e8\u5206\u529f\u80fd\u4e5f\u90fd\u53ef\u4ee5\u901a\u8fc7\u81ea\u5df1\u5b9a\u4e49 K8s CRD \u914d\u7f6e\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\uff0c\u5b8c\u5168\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\u3002\\n\\n\\n### \u539f\u751f\u652f\u6301 K8s Ingress\\n\\n\u7f8e\u6d3d\u4ece 2021 \u5e74\u4fbf\u5df2\u7ecf\u5168\u9762\u8fc1\u79fb\u5230 Kubernetes \u8fdb\u884c\u8d44\u6e90\u8c03\u5ea6\uff0c\u9047\u5230\u6700\u5927\u7684\u56f0\u96be\u662f\u5386\u53f2\u7684\u7f51\u5173\u4e2d\u95f4\u4ef6\uff0c\u5728\u5bb9\u5668\u5316\u7684\u67b6\u6784\u91cc\u9762\uff0c\u5404\u79cd\u6c34\u571f\u4e0d\u670d\uff0c\u8981\u4e48\u9700\u8981\u501f\u52a9 Nginx-Ingress-Controller\uff0c\u8981\u4e48\u9700\u8981\u5916\u90e8\u7684 SLB \u8fdb\u884c\u670d\u52a1\u4e4b\u95f4\u7684\u8d1f\u8f7d\u5747\u8861\u4e0e\u7f51\u7edc\u901a\u4fe1\u3002\u8fd9\u5bfc\u81f4\u4e86\u6bd4\u5bb9\u5668\u5316\u4e4b\u524d\u66f4\u52a0\u590d\u6742\u7684\u6d41\u91cf\u8def\u5f84\uff0c\u4e00\u5ea6\u8ba9\u6211\u4eec\u4e0b\u5b9a\u51b3\u5fc3\uff0c\u5fc5\u987b\u3001\u5fc5\u987b\u3001\u5fc5\u987b\u8981\u89e3\u51b3\u7edf\u4e00\u7f51\u5173\u7684\u95ee\u9898\uff0c\u8fd8\u5fc5\u987b\u4e91\u539f\u751f\u7684\u3002\\n\\n2021 \u5e74\u5e95\u5f00\u59cb\uff0c\u6211\u4eec\u5f00\u59cb\u5c1d\u8bd5\u4f7f\u7528\u963f\u91cc\u4e91 MSE \u7f51\u5173 SaaS \u4ea7\u54c1\uff0c\u5f00\u59cb\u5c06\u90e8\u5206\u670d\u52a1\u4ece Nginx \u8def\u7531\u8fc1\u79fb\u5230 MSE \u7f51\u5173\u4e0a\uff0c\u5f88\u5feb\u89e3\u51b3\u4e86Ngxin Configuration \u914d\u7f6e\u7ef4\u62a4\u590d\u6742\uff0c\u6545\u969c\u9891\u53d1\u7684\u95ee\u9898\uff0c\u5c1d\u5230\u751c\u5934\u540e\uff0c\u6211\u4eec\u4fbf\u5f00\u59cb\u8ba1\u5212\u8fdb\u4e00\u6b65\u6269\u5927 MSE \u7f51\u5173\u7684\u4f7f\u7528\uff0c\u7ed3\u5408 Nacos \u548c K8S \u7684\u670d\u52a1\u53d1\u73b0\uff0c\u5c06 80% \u5927\u90e8\u5206\u5bb9\u5668\u5316\u670d\u52a1\u8def\u7531\u8f6c\u53d1\u5168\u90e8\u8fc1\u79fb\u5230\u4e86\u4e91\u539f\u751f\u7f51\u5173\u4e0a\u3002\\n\\n\u8fd9\u5e26\u6765\u7684\u6536\u76ca\u5c31\u5305\u62ec\uff1a\\n\\n1. \u7b80\u5316\u4e86\u6d41\u91cf\u8def\u5f84\uff0c\u516c\u7f51\u6d41\u91cf\u901a\u8fc7 SLB \u76f4\u63a5\u5230\u8fbe\u7f51\u5173\uff0c\u7f51\u5173\u8def\u7531\u76f4\u8fbe\u5bb9\u5668 Pod\uff1b\\n2. \u91ca\u653e\u4e86\u4f7f\u7528 ECS \u81ea\u5efa\u7684 Nginx \u3001OpenResty \u3001Caddy \u670d\u52a1\uff0c\u964d\u4f4e\u4e86\u5927\u91cf\u670d\u52a1\u5668\u6210\u672c\uff1b\\n3. \u670d\u52a1\u53d1\u73b0\u548c\u670d\u52a1\u6cbb\u7406\uff0c\u4ee5\u53ca\u5404\u4e2a\u670d\u52a1\u5f53\u524d\u7684\u5065\u5eb7\u72b6\u6001\u90fd\u4ee5\u53ef\u89c6\u5316\u7684 Dashborad \u5448\u73b0\u51fa\u6765\uff1b\\n\\n### \u63a7\u5236\u9762\u548c\u6570\u636e\u9762\u89e3\u8026\u7684\u67b6\u6784\\n\\n\u63a7\u5236\u9762\u548c\u6570\u636e\u9762\u89e3\u8026\u662f\u4e00\u79cd\u5f88\u597d\u7684\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u628a\u7ba1\u7406\u63a7\u5236\u903b\u8f91\u548c\u8fd0\u884c\u5904\u7406\u903b\u8f91\u5206\u5f00\uff0c\u8fd9\u6837\u53ef\u4ee5\u66f4\u597d\u5730\u7ba1\u7406\u548c\u6269\u5c55\u7cfb\u7edf\u3002\\n\\n1. Console \u8d1f\u8d23\u7ba1\u7406 \u548c Gateway \u8d1f\u8d23\u5904\u7406\u8bf7\u6c42\uff0c\u7075\u6d3b\u53ef\u6269\u5c55\uff0c\u4e92\u8865\u5e72\u6270\uff1b\\n2. \u6574\u4e2a\u7cfb\u7edf\u7684\u6027\u80fd\u548c\u53ef\u7528\u6027\u53ef\u4ee5\u5f97\u5230\u5f88\u597d\u7684\u4fdd\u969c\uff1b\\n3. \u5373\u4f7f\u63a7\u5236\u9762\u51fa\u73b0\u95ee\u9898\uff0c\u6570\u636e\u9762\u4ecd\u7136\u53ef\u4ee5\u7ee7\u7eed\u5904\u7406\u8bf7\u6c42\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\\n\\n\u5728\u7f8e\u6d3d\u5ba2\u670d\u81ea\u5df1\u7684\u4ea7\u54c1\u4e2d\uff0c\u4e5f\u5927\u91cf\u8bd5\u7528\u4e86\u63a7\u5236\u9762\u548c\u6570\u636e\u9762\u5206\u79bb\u7684\u8fd9\u79cd\u67b6\u6784\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u5728\u9009\u62e9 Higress \u7edf\u4e00\u7f51\u5173\u7684\u843d\u5730\u5b9e\u8df5\u4e2d\uff0c\u4e5f\u66f4\u597d\u7684\u53ef\u4ee5\u548c\u7f8e\u6d3d\u4ea7\u54c1\u7684\u67b6\u6784\u8fdb\u884c\u914d\u5408\uff0c\u4f8b\u5982\u63a7\u5236\u53f0\u91c7\u7528\u5fae\u524d\u7aef\u6280\u672f\u7edf\u4e00\u7f8e\u6d3d\u8fd0\u7ef4\u63a7\u5236\u53f0\uff0cHigress \u63a7\u5236\u53f0\uff0cNacos \u63a7\u5236\u53f0\u3002\\n\\n### \u5bb9\u6613\u4e0a\u624b\u7684\u540e\u53f0 Dashboard\\n\\n\u5728\u65e9\u671f\uff0c\u7f8e\u6d3d\u5728 2021 \u5e74\u5f00\u59cb\u4f7f\u7528\u963f\u91cc\u4e91 MSE \u4e91\u539f\u751f\u7f51\u5173\u65f6\uff0c\u5c31\u5df2\u7ecf\u5bf9\u7f51\u5173\u7684\u63a7\u5236\u53f0\u4f7f\u7528\u6709\u4e86\u5f88\u591a\u7684\u7ecf\u9a8c\u57fa\u7840\uff0c\u56e2\u961f\u4e2d QA \u540c\u5b66\u4e5f\u80fd\u719f\u7ec3\u4f7f\u7528\u4e86\u3002\u76ee\u524d\u5728\u5176\u4ed6\u4e91\u4e0a\u7684\u9879\u76ee\uff0c\u79c1\u6709\u5316\u90e8\u7f72\u7684\u5f00\u6e90\u7248Higress\uff0c\u5728\u63a7\u5236\u53f0\u65b9\u9762\u529f\u80fd\u4e0e\u64cd\u4f5c\u548c\u963f\u91cc\u4e91 MSE \u4ea7\u54c1\u7684\u4ea4\u4e92\u4fdd\u6301\u4e00\u81f4\uff0c\u56e2\u961f\u4f7f\u7528\u5f88\u5feb\u4fbf\u4e0a\u624b\u4e86\u3002\\n\\n![](https://img.alicdn.com/imgextra/i4/O1CN01SgNYtt1NcizsTgB5w_!!6000000001591-0-tps-750-300.jpg)\\n\\n\u63d2\u4ef6\u65b9\u9762\uff0c\u7f8e\u6d3d\u4f7f\u7528\u4e86 JWT Auth \u9274\u6743\uff0cKey Rate Limit \u9650\u6d41\uff0cHMAC Auth \u8bf7\u6c42\u7b7e\u540d\uff0cBot Detect \u548c WAF \u529f\u80fd\u6709\u6d89\u53ca\u3002\\n\\n![](https://img.alicdn.com/imgextra/i1/O1CN015fP9mx1lv5ewluuvs_!!6000000004880-0-tps-750-420.jpg)\\n\\n## \u7f8e\u6d3d\u7684\u843d\u5730\u5b9e\u8df5\\n\\n### \u91c7\u7528 Helm \u5728 K8s node \u4e0a \u4e00\u952e\u90e8\u7f72\\n\\n```bash\\nhelm repo add higress.io <https://higress.io/helm-charts>\\nhelm install higress higress.io/higress -n higress-system --create-namespace\\n```\\n\\n### \u5b8c\u5168\u66ff\u4ee3\u4e86 Nginx \u3001OpenResty\u3001Caddy \u3001SLB-Intranet\\n\\n![](https://img.alicdn.com/imgextra/i4/O1CN01ElAB4A1ijgxDUXf9g_!!6000000004449-0-tps-630-532.jpg)\\n![](https://img.alicdn.com/imgextra/i4/O1CN011wDPMy1vpGmaT06Tq_!!6000000006221-0-tps-631-532.jpg)\\n\\n### \u5f7b\u5e95\u89e3\u51b3 WebSocket \u65ad\u7ebf\u91cd\u8fde\u95ee\u9898\\n\\n\u7f8e\u6d3d\u7684\u667a\u80fd\u5ba2\u670d\u4ea7\u54c1\u4fa7\u8bd5\u7528\u4e86 WebSocket \u8fdb\u884c\u957f\u8fde\u63a5\u4fdd\u6301\u548c\u6d88\u606f\u901a\u4fe1\uff0c\u6240\u4ee5\u975e\u5e38\u4f9d\u8d56\u7f51\u7edc\u7684\u7a33\u5b9a\uff0c\u4ee5\u53ca\u66f4\u65b0\u7f51\u5173\u914d\u7f6e\u6240\u5e26\u6765\u7684\u526f\u4f5c\u7528\u3002\u5728\u4f7f\u7528 Nginx + OpenResty \u65b9\u6848\u7684\u671f\u95f4\uff0c\u6bcf\u4e00\u6b21\u7684\u914d\u7f6e\u53d8\u66f4\u90fd\u4f1a\u5e26\u6765\u6781\u5927\u7684\u4ee3\u4ef7\uff0c\u65ad\u7ebf\u91cd\u8fde\u98ce\u66b4\u65f6\u5e38\u53d1\u751f\u3002\u4e00\u6b21\u914d\u7f6e\u53d8\u66f4 Pendding \u6216\u8005\u53d8\u66f4\u5931\u8d25\u5e26\u6765\u7684\u77ac\u65f6\u65ad\u8054\u662f\u53ca\u5176\u75db\u82e6\u7684\u3002\\n\\n![](https://img.alicdn.com/imgextra/i1/O1CN01rvv5Mc1hoRRlBhdO2_!!6000000004324-0-tps-750-440.jpg)\\n\\n\u5728\u8fc1\u79fb\u5230 Higress \u4e0a\u4e4b\u540e\uff0c\u8def\u7531\u914d\u7f6e\u70ed\u66f4\u65b0\u7279\u6027\uff0c\u4e0d\u5728\u9700\u8981\u50cf Nginx \u4e00\u6837\u9700\u8981 Reload Gateway\uff0c\u89e3\u51b3\u914d\u7f6e\u66f4\u65b0 reload \u5e26\u6765\u7684\u65ad\u7ebf\u91cd\u8fde\u98ce\u66b4\u95ee\u9898\u3002\\n\\n\u53e6\u5916\uff0c\u5728 WebSocket Server \u670d\u52a1\u5347\u7ea7\u8fc7\u7a0b\u4e2d\uff0c\u901a\u8fc7\u7ed9 Pod \u6253\u4e0a stage \u6807\u7b7e\uff0c\u5728 Higress \u4fa7\u901a\u8fc7\u6807\u7b7e\u8def\u7531\u8fdb\u884c\u65b0\u8001\u7248\u672c\u65e0\u635f\u6d41\u91cf\u5207\u6362\uff0c\u7ed9\u4ea7\u54c1\u5feb\u901f\u8fed\u4ee3\u5347\u7ea7\u5e26\u4e86\u5de8\u5927\u7684\u6760\u6746\u6548\u5e94\u3002\\n\\n### \u7194\u65ad\u9650\u6d41\\n\\n\u5728\u9762\u5411 2B \u7684 SaaS \u4ea7\u54c1\u4e1a\u52a1\u573a\u666f\u4e2d\uff0c\u7ecf\u5e38\u4f1a\u53d1\u751f\u67d0\u4e00\u4e2a\u5ba2\u6237\u7a81\u53d1\u6d77\u91cf\u6d41\u91cf\uff0c\u5360\u636e\u5927\u91cf\u5e26\u5bbd\uff0c\u5f71\u54cd\u5176\u4ed6\u5ba2\u6237\u6b63\u5e38\u4f7f\u7528\u7684\u60c5\u51b5\uff0c\u8fd9\u65f6\u6211\u4eec\u9700\u8981\u9488\u5bf9\u5ba2\u6237\u89c4\u6a21\u5bf9\u5355\u4e2a\u5ba2\u6237\u7684 API \u5e76\u53d1\u4e0a\u9650\u505a\u7075\u6d3b\u7684\u52a8\u6001\u9650\u6d41\uff0c\u4f7f\u7528 Higress \u7684\u63d2\u4ef6Key Rate Limit \u5c31\u5f88\u597d\u7684\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u6839\u636e\u6d41\u91cf\u5927\u76d8\u968f\u65f6\u8c03\u6574\u9650\u6d41\u6c34\u4f4d\u7ea2\u7ebf\uff0c\u505a\u5230\u7cbe\u51c6\uff0c\u7075\u6d3b\u7684\u9650\u6d41\u3002\\n\\n![](https://img.alicdn.com/imgextra/i3/O1CN01QhTG261lZZ2kbT1qe_!!6000000004833-0-tps-750-467.jpg)\\n\\n## \u7ecf\u9a8c\u603b\u7ed3\\n\\nHigress \u7f51\u5173\u7684\u843d\u5730\uff0c\u7ed9\u4f01\u4e1a\u5168\u9762\u843d\u5730\u4e91\u539f\u751f\u5fae\u670d\u52a1\u67b6\u6784\u63d0\u4f9b\u5f3a\u6709\u529b\u7684\u652f\u6301\uff0c\u5bf9\u6211\u4eec\u6280\u672f\u4eba\u5458\u6765\u8bf4\uff0c\u8fd9\u7edd\u5bf9\u662f\u4e00\u4e2a\u6760\u6746\u7ea7\u522b\u7684\u5f00\u6e90\u4ea7\u54c1\uff0c\u53e6\u5916\uff0c\u5728\u963f\u91cc\u4e91\u4e0a\u53c8\u6709\u5bf9\u7b49\u7684 SaaS \u4ea7\u54c1\uff0c\u8fd9\u6837\u7684\u914d\u5408\uff0c\u5c06\u516c\u6709\u4e91\u548c\u79c1\u6709\u5316\u90e8\u7f72\u7684\u7edf\u4e00\u7f51\u5173\u4e00\u6b21\u6027\u5168\u90e8\u89e3\u51b3\uff0c\u5bf9\u4f01\u4e1a\u6765\u8bf4\u662f\u7edd\u5bf9\u7684\u5229\u597d\u3002\\n\\n1. \u7edf\u4e00\u6d41\u91cf\u7f51\u5173+\u4e1a\u52a1\u7f51\u5173\u80fd\u529b\uff0c\u5b9e\u73b0\u4e86\u7ed9\u4f01\u4e1a\u964d\u672c\uff0c\u4e3a\u7814\u53d1\u589e\u6548\uff1b\\n2. \u4e3a\u4e91\u539f\u751f\u67b6\u6784\u63d0\u4f9b\u5f88\u597d\u7684\u57fa\u5ea7\uff0c\u5728\u5f02\u6784\u8bed\u8a00\u670d\u52a1\u5316\u5c42\u9762\u6392\u9664\u4e86\u7f51\u7edc\u901a\u4fe1\u96be\u9898\uff1b\\n3. \u8def\u7531\u70ed\u66f4\u65b0\u3001\u65e0\u635f\u5347\u7ea7\u3001\u53ef\u89c6\u5316 Console\u3001\u5f00\u653e\u7684\u63d2\u4ef6\u3001\u57fa\u4e8e Kubernetes \u548c Istio\uff0c\u7ed9\u6280\u672f\u6f14\u8fdb\u5e26\u6765\u4e86\u66f4\u591a\u7684\u53ef\u80fd\u6027\u3002\\n\\n\u6700\u540e\uff0c\u6211\u4eec\u795d\u613f Higress \u5728\u4e91\u539f\u751f\u7684\u9053\u8def\u4e0a\u8d8a\u8d70\u8d8a\u8fdc\uff0c\u5927\u5bb6\u4e00\u8d77\u7528\u5f00\u6e90\u3001\u5f00\u653e\u3001\u5206\u4eab\u7684\u5fc3\u6001\u5c06 Higress \u5efa\u8bbe\u5730\u8d8a\u6765\u8d8a\u597d\u3002"},{"id":"/skywalking","metadata":{"permalink":"/zh-cn/blog/skywalking","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/skywalking.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/skywalking.md","title":"Higress \u96c6\u6210 Skywalking \u53ef\u89c2\u6d4b\u6027\u63a2\u7d22","description":"Higress \u96c6\u6210 Skywalking \u53ef\u89c2\u6d4b\u6027\u63a2\u7d22","date":"2023-06-20T00:00:00.000Z","formattedDate":"2023\u5e746\u670820\u65e5","tags":[],"readingTime":13.91,"hasTruncateMarker":false,"authors":[{"name":"Jun"}],"frontMatter":{"title":"Higress \u96c6\u6210 Skywalking \u53ef\u89c2\u6d4b\u6027\u63a2\u7d22","keywords":["higress"],"description":"Higress \u96c6\u6210 Skywalking \u53ef\u89c2\u6d4b\u6027\u63a2\u7d22","author":"Jun","date":"2023-06-20T00:00:00.000Z","custom_edit_url":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/skywalking.md"},"prevItem":{"title":"\u7f8e\u6d3d\u667a\u80fd\u5ba2\u670d\u4f7f\u7528 Higress \u7edf\u4e00\u7f51\u5173\u843d\u5730\u5b9e\u8df5","permalink":"/zh-cn/blog/user-mq"},"nextItem":{"title":"Higress \u5f00\u6e90\u4e4b\u590f\u9879\u76ee\u62a5\u540d","permalink":"/zh-cn/blog/ospp-2023"}},"content":"[Higress](https://higress.io/zh-cn/) \u4e00\u4e2a\u9075\u5faa\u5f00\u6e90Ingress/Gateway API\u6807\u51c6\uff0c\u63d0\u4f9b\u6d41\u91cf\u8c03\u5ea6\u3001\u670d\u52a1\u6cbb\u7406\u3001\u5b89\u5168\u9632\u62a4\u4e09\u5408\u4e00\u7684\u9ad8\u96c6\u6210\u3001\u6613\u4f7f\u7528\u3001\u6613\u6269\u5c55\u3001\u70ed\u66f4\u65b0\u7684\u4e0b\u4e00\u4ee3\u4e91\u539f\u751f\u7f51\u5173\u3002\\n\\n[Skywalking](https://skywalking.apache.org/) \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u53ef\u89c2\u6d4b\u5e73\u53f0\uff0c\u7528\u4e8e\u4ece\u670d\u52a1\u548c\u4e91\u539f\u751f\u57fa\u7840\u8bbe\u65bd\u6536\u96c6\uff0c\u5206\u6790\uff0c \u805a\u5408\u53ca\u53ef\u89c6\u5316\u6570\u636e\u3002\\n\\n[Httpbin](https://github.com/2456868764/httpbin) \u662f\u57fa\u4e8e Gin \u5f00\u53d1\uff0c\u7528\u4e8e\u5feb\u901f\u6d4b\u8bd5\u57fa\u4e8e\u4e91\u539f\u751f\u5fae\u670d\u52a1\u53ef\u89c2\u6d4b\u6027\u548c\u6d41\u91cf\u7ba1\u7406\u7b49\u529f\u80fd\u3002\\n\\n\u672c\u6587\u4ecb\u7ecd Higress \u96c6\u6210 Skywalking \u5b9e\u73b0\u53ef\u89c2\u6d4b\u6027\uff0c\u4e3b\u8981\u5185\u5bb9\u6d89\u53ca\u6574\u4f53\u67b6\u6784\u3001Skywalking \u8c03\u7528\u94fe\u8def\u8ddf\u8e2a\u539f\u7406\u3001Higress \u67b6\u6784\u3001\u4e1a\u52a1\u5e94\u7528\u96c6\u6210 Skywalking\u3001\u672c\u5730\u6d4b\u8bd5\u73af\u5883\u642d\u5efa\u3001Higress \u914d\u7f6e\u3001\u5e94\u7528\u5b89\u88c5\u3001\u8c03\u7528\u94fe\u8def\u8ddf\u8e2a\u914d\u7f6e\u4ee5\u53ca Higress gateway \u6307\u6807\u548c\u76d1\u63a7\u9762\u677f\u3002\\n\\n\u8fd9\u6b21\u53ef\u89c2\u6d4b\u6027\u63a2\u7d22\u76f8\u5173 manifests [\u4e0b\u8f7d\u5730\u5740](https://gitcode.net/-/snippets/3612) \\n\\n## \u4e00\u3001\u6574\u4f53\u67b6\u6784\u56fe\\n\\n![img.png](../../../static/img/blog/skywalking/higress.png)\\n\\n\u6574\u4f53\u5305\u542b\u56db\u5927\u5757\u5185\u5bb9\uff1a\\n- Higress \u7ec4\u4ef6\uff1a    higress-gateway, higress-console, higress-controller\\n- Skywalking \u7ec4\u4ef6\uff1a skywalking dashboard ui, skywalking aop server\\n- \u4e1a\u52a1\u5e94\u7528\u7ec4\u4ef6\uff1a      bff, middle service, backend service\\n- Ingress \u7ec4\u4ef6\uff1a    console.higress.io, skywalking.higress.io, httpbin.example.com\\n\\n## \u4e8c\u3001Skywalking \u8c03\u7528\u94fe\u8def\u8ddf\u8e2a\u539f\u7406\\n\\nSkyWalking\u4e3a\u670d\u52a1(service)\uff0c\u670d\u52a1\u5b9e\u4f8b(service instance)\uff0c\u4ee5\u53ca\u7aef\u70b9(endpoint)\u63d0\u4f9b\u4e86\u53ef\u89c2\u6d4b\u80fd\u529b\u3002\\n\\n- \u670d\u52a1(service)\uff1a\u8868\u793a\u5bf9\u8bf7\u6c42\u63d0\u4f9b\u76f8\u540c\u884c\u4e3a\u7684\u4e00\u7ec4\u5de5\u4f5c\u8d1f\u8f7d\u3002\u5728\u4f7f\u7528\u6253\u70b9\u4ee3\u7406\u6216 SDK \u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5b9a\u4e49\u670d\u52a1\u7684\u540d\u5b57\u3002\\n- \u670d\u52a1\u5b9e\u4f8b(Service Instance)\uff1a\u4e00\u7ec4\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u79f0\u4e3a\u4e00\u4e2a\u5b9e\u4f8b\u3002\\n- \u7aef\u70b9(Endpoint)\uff1a \u5bf9\u4e8e\u7279\u5b9a\u670d\u52a1\u6240\u63a5\u6536\u7684\u8bf7\u6c42\u8def\u5f84\uff0c\u5982 HTTP \u7684 URI \u8def\u5f84\u548c gRPC \u670d\u52a1\u7684\u7c7b\u540d + \u65b9\u6cd5\u7b7e\u540d\u3002\\n- \u8fdb\u7a0b\uff08Process\uff09\uff1a \u64cd\u4f5c\u7cfb\u7edf\u8fdb\u7a0b. \u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u4e00\u4e2a\u670d\u52a1\u5b9e\u4f8b\u548c\u8fdb\u7a0b\u4e0d\u662f\u4e00\u4e00\u5bf9\u5e94\uff0c \u5728k8s\u90e8\u7f72\u4e0b\uff0c\u4e00\u4e2aPOD\u5bf9\u5e94\u591a\u4e2a\u8fdb\u7a0b\u3002\\n\\n### Skywalking \u6574\u4f53\u67b6\u6784\\n\\n![img.png](../../../static/img/blog/skywalking/skywalking1.png)\\n\\n\u4e3b\u8981\u7531\u56db\u4e2a\u6838\u5fc3\u7ec4\u4ef6\u7ec4\u6210\uff1a\\n\\n- \u63a2\u9488: \u63a2\u9488\u7528\u4e8e\u6536\u96c6\u76d1\u6d4b\u6570\u636e\u5305\u62ec\u6307\u6807\uff0c\u94fe\u8def\u8ddf\u8e2a\uff0c\u65e5\u5fd7\u548c\u4e8b\u4ef6\\n- \u6570\u636e\u63a5\u6536\u548c\u805a\u5408: \u5e73\u53f0\u540e\u7aef\u652f\u6301\u6570\u636e\u805a\u5408\uff0c\u6570\u636e\u5206\u6790\u4ee5\u53ca\u9a71\u52a8\u6570\u636e\u6d41\u4ece\u63a2\u9488\u5230\u7528\u6237\u754c\u9762\u7684\u5904\u7406\\n- \u5b58\u50a8: \u901a\u8fc7\u5f00\u653e\u63a5\u53e3\u652f\u6301\u540e\u7aef\u5b58\u50a8\u7cfb\u7edf\u652f\u6301ElasticSearch, H2, MySQL, TiDB, BanyanDB\u7b49\\n- UI:  \u4e00\u4e2a\u5b9a\u5236\u5316\u7684Web\u7cfb\u7edf\uff0c\u7528\u6237\u53ef\u4ee5\u53ef\u89c6\u5316\u67e5\u770b\u548c\u7ba1\u7406 SkyWalking \u6570\u636e\\n\\n### \u5206\u5e03\u5f0f\u94fe\u8def\u8ffd\u8e2a\u539f\u7406\u5206\u6790\\n\\n1. \u5206\u5e03\u5f0f\u94fe\u8def\u4ecb\u7ecd\\n\\n\u5206\u5e03\u5f0f\u94fe\u8def\u8ffd\u8e2a\u662f\u8bb0\u5f55\u6765\u6e90\u4e8e\u7528\u6237\u8bf7\u6c42\u5728\u5404\u4e2a\u7cfb\u7edf\u6216\u8005\u670d\u52a1\u4e2d\u6240\u4f20\u64ad\u7684\u8def\u5f84\u3002\\n\\n> A distributed trace, more commonly known as a trace, records the paths taken by requests (made by an application or end-user) as they propagate through multi-service architectures, like microservice and serverless applications.\\n\\n\u5206\u5e03\u5f0f\u94fe\u8def\u8ffd\u8e2a\u56fe\u793a\u5982\u4e0b\uff1a\\n\\n![img.png](../../../static/img/blog/skywalking/higress13.png)\\n\\n2. Skywalking \u5206\u5e03\u5f0f\u94fe\u8def\u8ffd\u8e2a\\n\\n\u4e3b\u8981\u5305\u542b\u56db\u4e2a\u5185\u5bb9\uff1a\\n\\n- Trace: \u4e00\u4e2a\u5b8c\u6574\u7684\u94fe\u8def\u7531\u591a\u4e2a Segment \u7ec4\u6210\\n- Segment: \u4e00\u4e2a\u8bf7\u6c42\u5728\u4e00\u4e2a\u8fdb\u7a0b\u5185\u7684\u8f68\u8ff9\\n- Span: \u4e00\u4e2a\u8bf7\u6c42\u5728\u67d0\u4e2a\u8fdb\u7a0b\u91cc\u7684\u4e00\u4e2a\u7ec4\u4ef6\u903b\u8f91\u5185\u7684\u8f68\u8ff9, \u6709 Entry Span\uff0c Local Span \u548c Exit Span \u4e09\u7c7b\\n- Span context: \u8de8\u8fdb\u7a0b\u6216\u8005\u670d\u52a1 Trace \u4f20\u9012\uff0c\u8fd9\u91cc\u8ba8\u8bba http \u4f20\u9012\u5934 sw8\\n\\n\u57fa\u672c\u7ec4\u4ef6\u56fe\u793a\u5982\u4e0b\uff1a\\n\\n![img.png](../../../static/img/blog/skywalking/skywalking_trace.png)\\n\\n\u4ece\u4e0a\u56fe\u53ef\u4ee5\u770b\u51fa\uff1a\\n\\n- \u4e00\u4e2a Trace \u5185\u7684\u6240\u6709 span \u7684 Trace ID \u662f\u76f8\u540c\u7684\\n- \u4e00\u4e2a Segment \u4e2d\u6709\u4e00\u4e2a EntrySpan\uff0c\u662f Segment \u5185\u5176\u4ed6 Span \u7684\u6839 Parent\\n- \u540e\u4e00\u4e2a Segment\u7684 Entryspan \u603b\u662f\u4e0e\u524d\u4e00\u4e2a Segment \u4e2d\u7684\u67d0\u4e2a ExitSpan \u5173\u8054\\n\\n3. Skywalking Trace \u7684\u6570\u636e\u534f\u8bae\\n\\n\u5177\u4f53\u6570\u636e\u534f\u8bae\u53c2\u8003 [Skywalking Trace Data Protocol](https://skywalking.apache.org/docs/main/next/en/api/trace-data-protocol-v3/), \u8fd9\u91cc\u4e3b\u8981\u8bb2\u4e00\u4e0b sw8 \u683c\u5f0f\u548c\u7ec4\u6210\u3002\\n\\nsw8 \u683c\u5f0f: XXXXX-XXXXX-XXXX-XXXX\uff0c\u4ee5 - \u5206\u5272\u3002\\n\u6837\u4f8b: 1-MzYzMzM1NDctNTc0YS00MzZlLTgzNWEtNTY1YTQyNzk3YTY3-ZWQ3ODA2ZjYwNTI0MTFlZWE5ZDdmZTFhNTA5YTRmYTk=-1-bWlkZGxl-bWlkZGxlLTZmNGRkN2JmNmMtcWJ4cm0=-L0dFVC9zZXJ2aWNl-aHR0cDovL2JhY2tlbmQv\\n\\n\u5177\u4f53\u5185\u5bb9\u5982\u4e0b\uff1a\\n\\n- \u91c7\u6837\u6807\u8bb0(Sample):  0 \u6216\u8005 1\uff0c 0 \u8868\u793a\u4e0d\u91c7\u6837 1 \u8868\u793a\u91c7\u6837\\n- \u8ddf\u8e2aID(Trace ID): \u5b57\u7b26(BASE64 \u7f16\u7801)\\n- \u7236Sengment ID (Parent trace segment ID): \u5b57\u7b26(BASE64 \u7f16\u7801)\\n- \u7236 Span ID\uff08Parent span ID): \u6574\u578b\\n- \u7236\u670d\u52a1\u540d\u79f0(Parent service): \u5b57\u7b26(BASE64 \u7f16\u7801)\\n- \u7236\u670d\u52a1\u5b9e\u4f8b(Parent service instance): \u5b57\u7b26(BASE64 \u7f16\u7801)\\n- \u7236Endpoint(Parent endpoint): \u5b57\u7b26(BASE64 \u7f16\u7801)\\n- \u76ee\u6807\u5730\u5740\uff1a\u5b57\u7b26(BASE64 \u7f16\u7801)\\n\\n## \u4e09\u3001Higress \u67b6\u6784\\n\\nHigress\u662f\u57fa\u4e8e\u963f\u91cc\u5185\u90e8\u7684Envoy Gateway\u5b9e\u8df5\u6c89\u6dc0\u3001\u4ee5\u5f00\u6e90 Istio + Envoy \u4e3a\u6838\u5fc3\u6784\u5efa\u7684\u4e0b\u4e00\u4ee3\u4e91\u539f\u751f\u7f51\u5173\uff0c\u5b9e\u73b0\u4e86\u6d41\u91cf\u7f51\u5173 + \u5fae\u670d\u52a1\u7f51\u5173 + \u5b89\u5168\u7f51\u5173\u4e09\u5408\u4e00\u7684\u9ad8\u96c6\u6210\u80fd\u529b\uff0c\u6df1\u5ea6\u96c6\u6210Dubbo\u3001Nacos\u3001Sentinel\u7b49\u5fae\u670d\u52a1\u6280\u672f\u6808\uff0c\u80fd\u591f\u5e2e\u52a9\u7528\u6237\u6781\u5927\u7684\u964d\u4f4e\u7f51\u5173\u7684\u90e8\u7f72\u53ca\u8fd0\u7ef4\u6210\u672c\u4e14\u80fd\u529b\u4e0d\u6253\u6298\uff1b\\n\\n\u5728\u6807\u51c6\u4e0a\u5168\u9762\u652f\u6301 Ingress\u4e0e Gateway API\uff0c\u79ef\u6781\u62e5\u62b1\u4e91\u539f\u751f\u4e0b\u7684\u6807\u51c6API\u89c4\u8303\uff1b\\n\\n\u540c\u65f6\uff0cHigress Controller\u4e5f\u652f\u6301Nginx Ingress\u5e73\u6ed1\u8fc1\u79fb\uff0c\u5e2e\u52a9\u7528\u6237\u96f6\u6210\u672c\u5feb\u901f\u8fc1\u79fb\u5230Higress\u3002\\n\\n![img.png](../../../static/img/blog/skywalking/higress12.png)\\n\\n## \u56db\u3001\u4e1a\u52a1\u5e94\u7528\u96c6\u6210 Skywalking\\n\\n\u4e1a\u52a1\u5e94\u7528\u901a\u8fc7\u4e0e [go2sky](https://github.com/SkyAPM/go2sky) \u9879\u76ee\u96c6\u6210 SkyWalking \u76d1\u63a7 Golang \u5e94\u7528\u7a0b\u5e8f\uff0c\u4e3b\u8981\u901a\u8fc7 Gin middleware \u548c Http \u8bf7\u6c42\u624b\u52a8\u57cb\u70b9\u3002\\n\\n1\u3001\u96c6\u6210 Gin middleware\\n```golang\\nfunc middleware(engine *gin.Engine, tracer *go2sky.Tracer) gin.HandlerFunc {\\n\\tif engine == nil || tracer == nil {\\n\\t\\treturn func(c *gin.Context) {\\n\\t\\t\\tc.Next()\\n\\t\\t}\\n\\t}\\n\\treturn func(c *gin.Context) {\\n\\t\\tif strings.HasPrefix(c.Request.URL.String(), skipProbPrefix) || strings.HasPrefix(c.Request.URL.String(), skipMetricsPrefix) {\\n\\t\\t\\tc.Next()\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tspan, ctx, err := tracer.CreateEntrySpan(c.Request.Context(), getOperationName(c), func(key string) (string, error) {\\n\\t\\t\\treturn c.Request.Header.Get(key), nil\\n\\t\\t})\\n\\t\\tif err != nil {\\n\\t\\t\\tc.Next()\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tspan.SetComponent(componentIDGINHttpServer)\\n\\t\\tspan.Tag(go2sky.TagHTTPMethod, c.Request.Method)\\n\\t\\tspan.Tag(go2sky.TagURL, c.Request.Host+c.Request.URL.Path)\\n\\t\\tspan.SetSpanLayer(agentv3.SpanLayer_Http)\\n\\n\\t\\tc.Request = c.Request.WithContext(ctx)\\n\\n\\t\\tc.Next()\\n\\n\\t\\tif len(c.Errors) > 0 {\\n\\t\\t\\tspan.Error(time.Now(), c.Errors.String())\\n\\t\\t}\\n\\t\\tspan.Tag(go2sky.TagStatusCode, strconv.Itoa(c.Writer.Status()))\\n\\t\\tspan.End()\\n\\t}\\n}\\n\\nfunc getOperationName(c *gin.Context) string {\\n\\treturn fmt.Sprintf(\\"/%s%s\\", c.Request.Method, c.FullPath())\\n}\\n\\n```\\n\\n2\u3001Http\u8bf7\u6c42\u624b\u52a8\u57cb\u70b9\\n\\n```golang\\nfunc traceHttpCall(c *gin.Context, req *http.Request, url string, fn func(req *http.Request) (*http.Response, error)) (*http.Response, error) {\\n\\ttracer := go2sky.GetGlobalTracer()\\n\\tif tracer == nil {\\n\\t\\tresp, err := fn(req)\\n\\t\\treturn resp, err\\n\\t}\\n\\n\\treqSpan, err := go2sky.GetGlobalTracer().CreateExitSpan(c.Request.Context(), \\"invoke\\", url, func(headerKey, headerValue string) error {\\n\\t\\treq.Header.Set(headerKey, headerValue)\\n\\t\\treturn nil\\n\\t})\\n\\t\\n\\treqSpan.SetComponent(2)\\n\\treqSpan.SetSpanLayer(v3.SpanLayer_Http)\\n\\tresp, err2 := fn(req)\\n\\treqSpan.Tag(go2sky.TagHTTPMethod, http.MethodGet)\\n\\treqSpan.Tag(go2sky.TagURL, url)\\n\\treqSpan.End()\\n\\treturn resp, err2\\n\\n}\\n```\\n\\n\\n## \u4e94\u3001\u672c\u5730\u6d4b\u8bd5\u73af\u5883\u642d\u5efa\\n\\n1. \u672c\u5730\u5b89\u88c5 kubectl, kind, helm\\n\\n\u53ef\u4ee5\u53c2\u8003 Higress [\u5feb\u901f\u5f00\u59cb](https://higress.io/zh-cn/docs/user/quickstart)\u5b89\u88c5 kubectl, kind\u3002\\nhelm \u5b89\u88c5\u53c2\u8003[\u5b89\u88c5\u6587\u6863](https://helm.sh/zh/docs/intro/install/)\\n\\n2. \u5b89\u88c5 higress \u548c istio CRD\\n\\n\u53ef\u4ee5\u53c2\u8003 higress [\u5feb\u901f\u5f00\u59cb](https://higress.io/zh-cn/docs/user/quickstart) \u548c [\u5b89\u88c5\u90e8\u7f72](https://higress.io/zh-cn/docs/ops/deploy-by-helm) \u6765\u90e8\u7f72\uff0c\u8fd9\u91cc\u9700\u8981\u5b89\u88c5  Istio CRD\u3002\\n\\n\u8fd9\u91cc\u63d0\u4f9b\u4e00\u952e\u5b89\u88c5\u811a\u672c local-env-setup.sh\uff0c\u8fd0\u884c local-env-setup.sh \u5b89\u88c5 Higress\\n\\n```shell\\n./local-env-setup.sh --crd\\n```\\n\\n3. \u90e8\u7f72 Skywalking\uff0c\u4e1a\u52a1\u5e94\u7528\u548c Ingress\\n\\n```shell\\n$ export KUBECONFIG=${HOME}/.kube/config_higress\\n$ kubectl apply -f skywalking.yaml\\n$ kubectl apply -f app.yaml\\n$ kubectl apply -f ingress.yaml\\n```\\n\\n\u68c0\u67e5 POD \u8fd0\u884c\u72b6\u6001\u548c Ingress \u72b6\u6001\\n\\n```shell\\n$ export KUBECONFIG=${HOME}/.kube/config_higress\\n\\n$ kubectl get pods -n higress-system \\n\\nNAME                                         READY   STATUS    RESTARTS   AGE\\nhigress-console-6f554978dc-cclg7             1/1     Running   0          100m\\nhigress-console-grafana-7495766db4-4flq5     1/1     Running   0          131m\\nhigress-console-prometheus-6d7bdccfb-hxtsq   1/1     Running   0          131m\\nhigress-controller-689c5b965f-7wsmt          2/2     Running   0          131m\\nhigress-gateway-59966b45d9-z7ltd             1/1     Running   0          131m\\n\\n$ kubectl get pods -n op-system\\n\\nNAME                                        READY   STATUS    RESTARTS   AGE\\nskywalking-oap-dashboard-65f496ccc9-dr96l   1/1     Running   0          99m\\nskywalking-oap-server-859694656b-p8vcq      1/1     Running   0          99m\\n\\n$ kubectl get pods -n app-system\\n\\nNAME                       READY   STATUS    RESTARTS   AGE\\nbackend-6b9549bc64-f98tr   1/1     Running   0          99m\\nbackend-6b9549bc64-x2btl   1/1     Running   0          99m\\nbff-766967f8db-8ght7       1/1     Running   0          99m\\nbff-766967f8db-gflbh       1/1     Running   0          99m\\nmiddle-6f4dd7bf6c-qdjqj    1/1     Running   0          99m\\nmiddle-6f4dd7bf6c-stzf4    1/1     Running   0          99m\\n\\n$ kubectl get svc -n app-system\\n\\nNAME      TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE\\nbackend   ClusterIP   10.96.179.140   <none>        80/TCP    99m\\nbff       ClusterIP   10.96.121.62    <none>        80/TCP    99m\\nmiddle    ClusterIP   10.96.55.8      <none>        80/TCP    99m\\n\\n\\n$ kubectl get ingress -n higress-system\\n\\nNAME                         CLASS     HOSTS                   ADDRESS   PORTS   AGE\\nhigress-console              higress   console.higress.io                80      34m\\nhigress-console-grafana      higress   console.higress.io                80      34m\\nhigress-console-prometheus   higress   console.higress.io                80      34m\\nhttpbin                      higress   httpbin.example.com               80      8s\\nskywalking-dashboard         higress   skywalking.higress.io             80      8s\\n```\\n\\n4. \u6d4b\u8bd5 Higress Console, Skywalking Dashboard, Bff \u670d\u52a1\\n\\n1\uff09\u7f16\u8f91 /etc/hosts \u6587\u4ef6\u6dfb\u52a0\u4ee5\u4e0b\u4e09\u4e2a\u57df\u540d\\n\\n```shell\\n127.0.0.1 console.higress.io\\n127.0.0.1 skywalking.higress.io\\n127.0.0.1 httpbin.example.com\\n```\\n2\uff09\u6253\u5f00 higress-gateway \u7aef\u53e3\u8f6c\u53d1\\n```shell\\n$ export KUBECONFIG=${HOME}/.kube/config_higress\\n$ kubectl -n higress-system port-forward service/higress-gateway 8080:80\\n```\\n3\uff09\u901a\u8fc7\u6d4f\u89c8\u5668\u6253\u5f00\u8bbf\u95ee\u4e0a\u9762\u4e09\u4e2a\u57df\u540d\\n\\nHigress \u63a7\u5236\u53f0: [http://console.higress.io:8080](http://console.higress.io:8080)\u3002\u9996\u6b21\u8bbf\u95ee\u63a7\u5236\u53f0\u65f6\u9700\u8981\u5148\u521d\u59cb\u5316\u7ba1\u7406\u5458\u7528\u6237\u3002\u521d\u59cb\u5316\u5b8c\u6210\u540e\u4f7f\u7528\u5bf9\u5e94\u7684\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55\u5373\u53ef\u3002\\n\\n![img.png](../../../static/img/blog/skywalking/higress1.png)\\n\\nSkywalking Dashboard: http://skywalking.higress.io:8080\\n\\n![img.png](../../../static/img/blog/skywalking/higress2.png)\\n\\nBff \u670d\u52a1\uff1a http://httpbin.example.com:8080/hostname\\n\\n![img.png](../../../static/img/blog/skywalking/higress3.png)\\n\\n\\n## \u516d\u3001Higress \u96c6\u6210 Skywalking \u8c03\u7528\u94fe\u8def\u8ddf\u8e2a\u914d\u7f6e\\n\\n\u901a\u8fc7\u4fee\u6539 Higress configmap \u5168\u5c40\u914d\u7f6e higress-config \u6765\u6fc0\u6d3b Higress \u96c6\u6210 Skywalking \u8c03\u7528\u94fe\u8def\u8ddf\u8e2a\u3002\\n\\n```shell\\n$ export KUBECONFIG=${HOME}/.kube/config_higress\\n$ kubectl edit configmap higgress-config -n higress-system\\n```\\n\\n\u5728 data \u4e0b\u589e\u52a0 higress \u914d\u7f6e\u9879\u7136\u540e\u4fdd\u5b58\uff0c\u5177\u4f53\u914d\u7f6e\u5185\u5bb9\u5982\u4e0b\uff1a\\n\\n```shell\\ndata:\\n  higress: |-\\n    tracing:\\n      enable: true\\n      sampling: 100\\n      timeout: 500\\n      skywalking:\\n       service: skywalking-oap-server.op-system.svc.cluster.local\\n       port: 11800\\n```\\n\\n## \u4e03\u3001Skywalking \u94fe\u8def\u8ddf\u8e2a\\n\\n### \u8fd0\u884c\u538b\u6d4b\u811a\u672c\\n```shell\\nfor i in $(seq 1 1000)\\ndo\\n    curl -v -H \\"Host:httpbin.example.com\\" http://127.0.0.1:8080/hostname\\n    curl -v -H \\"Host:httpbin.example.com\\" http://127.0.0.1:8080/\\n    curl -v -H \\"Host:httpbin.example.com\\" http://127.0.0.1:8080/service?services=middle,backend\\ndone\\n```\\n\\n\\n### \u8c03\u7528 bff \u670d\u52a1 /service \u63a5\u53e3\u6765\u6a21\u62df\u8c03\u7528\u94fe\u8def\\n\\n```shell\\ncurl -v -H \\"Host:httpbin.example.com\\" http://127.0.0.1:8080/service?services=middle,backend\\n```\\n\\n\u90e8\u5206\u8fd4\u56de\u54cd\u5e94\u4f53\u60c5\u51b5\u5982\u4e0b\uff1a\\n\\n```json\\n{\\n  \\"args\\": {\\n  },\\n  \\"form\\": {\\n  },\\n  \\"headers\\": {\\n    \\"accept-encoding\\": \\"gzip\\",\\n    \\"sw8\\": \\"1-MzYzMzM1NDctNTc0YS00MzZlLTgzNWEtNTY1YTQyNzk3YTY3-ZWQ3ODA2ZjYwNTI0MTFlZWE5ZDdmZTFhNTA5YTRmYTk=-1-bWlkZGxl-bWlkZGxlLTZmNGRkN2JmNmMtcWJ4cm0=-L0dFVC9zZXJ2aWNl-aHR0cDovL2JhY2tlbmQv\\",\\n    \\"sw8-correlation\\": \\"\\",\\n    \\"user-agent\\": \\"Go-http-client/1.1\\",\\n    \\"x-httpbin-trace-host\\": \\"bff-766967f8db-jwn2g/middle-6f4dd7bf6c-qbxrm/backend-6b9549bc64-8twnx\\",\\n    \\"x-httpbin-trace-service\\": \\"bff/middle/backend\\",\\n    \\"x-request-id\\": \\"e5a1b250-ebe3-931d-91d7-90e3ee2fc867\\"\\n  },\\n  \\"method\\": \\"GET\\",\\n  \\"origin\\": \\"\\",\\n  \\"url\\": \\"/\\",\\n  \\"envs\\": {\\n    \\"NODE_NAME\\": \\"higress-worker2\\",\\n    \\"PATH\\": \\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\\",\\n    \\"POD_IP\\": \\"10.244.1.7\\",\\n    \\"POD_NAME\\": \\"backend-6b9549bc64-8twnx\\",\\n    \\"POD_NAMESPACE\\": \\"app-system\\",\\n    \\"SERVICE_ACCOUNT\\": \\"backend\\",\\n    \\"SERVICE_NAME\\": \\"backend\\",\\n    \\"VERSION\\": \\"v1\\"\\n  },\\n  \\"host_name\\": \\"backend-6b9549bc64-8twnx\\",\\n  \\"body\\": \\"\\"\\n}\\n```\\n\\n\u54cd\u5e94\u5934\u4e2d\u548c\u8c03\u7528\u94fe\u8def\u8ddf\u8e2a\u76f8\u5173\u6709\u5982\u4e0b\uff1a\\n\\n```shell\\n\\"sw8\\": \\"1-MzYzMzM1NDctNTc0YS00MzZlLTgzNWEtNTY1YTQyNzk3YTY3-ZWQ3ODA2ZjYwNTI0MTFlZWE5ZDdmZTFhNTA5YTRmYTk=-1-bWlkZGxl-bWlkZGxlLTZmNGRkN2JmNmMtcWJ4cm0=-L0dFVC9zZXJ2aWNl-aHR0cDovL2JhY2tlbmQv\\",\\n\\"x-httpbin-trace-host\\": \\"bff-766967f8db-jwn2g/middle-6f4dd7bf6c-qbxrm/backend-6b9549bc64-8twnx\\",\\n\\"x-httpbin-trace-service\\": \\"bff/middle/backend\\",\\n```\\n\\n\u5176\u4e2d\uff1a\\n- sw8:  Skywalking \u7528\u4e8e\u8ddf\u8e2a\u7684 Http Header\\n- x-httpbin-trace-host: \u8c03\u7528\u94fe\u8def\u7ecf\u8fc7 POD_NAME\\n- x-httpbin-trace-service: \u8c03\u7528\u94fe\u8def\u7ecf\u8fc7 SERVICE_NAME\\n\\n\u5728 Skywalking dashboard \u4e2d\u67e5\u770b\u5982\u4e0b\uff1a\\n- \u670d\u52a1\u622a\u56fe\\n\\n![img.png](../../../static/img/blog/skywalking/higress4-1.png)\\n\\n- \u8c03\u7528\u94fe\u8def\u622a\u56fe\\n\\n![img.png](../../../static/img/blog/skywalking/higress4.png)\\n\\n- \u8c03\u7528\u94fe\u8def\u62d3\u6251\u622a\u56fe\\n\\n![img.png](../../../static/img/blog/skywalking/higress5.png)\\n\\n## \u516b\u3001Higress gateway \u6307\u6807\u548c\u76d1\u63a7\u9762\u677f\\n\\n\u53ef\u4ee5\u901a\u8fc7\u5ea6\u91cf\u5404\u4e2a\u7ec4\u4ef6\u7684\u6027\u80fd\u6307\u6807\uff0c\u4f8b\u5982\u54cd\u5e94\u65f6\u95f4\u3001\u541e\u5410\u91cf\u3001\u9519\u8bef\u7387\u3001\u8d44\u6e90\u4f7f\u7528\u7387\u7b49\u6307\u6807\u6765\u4e86\u89e3\u7cfb\u7edf\u7684\u72b6\u6001\u548c\u6027\u80fd\u3002\\n\\n\u6307\u6807\u6570\u636e\u5305\u542b\u6307\u6807\u540d\u79f0\uff0c\u6307\u6807\u6807\u7b7e\uff0c\u548c\u6307\u6807\u503c\uff0c\u4e0b\u9762\u662f envoy_cluster_upstream_cx_total upstream\uff08\u603b\u8fde\u63a5\u6570\uff09\u90e8\u5206\u6307\u6807\u6570\u636e\uff0c\\n\\n\u5176\u4e2d envoy_cluster_upstream_cx_total \u662f\u6307\u6807\u540d\u79f0\uff0ccluster_name \u662f\u6307\u6807\u6807\u7b7e\uff0c16 \u662f\u6307\u6807\u503c\u3002\\n```shell\\n# TYPE envoy_cluster_upstream_cx_total counter\\nenvoy_cluster_upstream_cx_total{cluster_name=\\"outbound|80||bff.app-system.svc.cluster.local\\"} 16\\n```\\n\\nHigress \u6307\u6807\u6570\u636e\u5927\u4f53\u53ef\u4ee5\u5206\u4e3a\u4e09\u7c7b:\\n- Downstream \u4e0b\u6e38: \u6307\u6807\u4e0e\u5916\u6765\u7684\u8fde\u63a5/\u8bf7\u6c42\u6709\u5173\uff0c\u4e3b\u8981\u7531\u4fa6\u542c\u5668\uff0cHTTP\u8fde\u63a5\u7ba1\u7406\u5668\u7b49\\n- UpStream \u4e0a\u6e38: \u6307\u6807\u4e0e\u5916\u5411\u7684\u8fde\u63a5/\u8bf7\u6c42\u6709\u5173\uff0c\u4e3b\u8981\u7531\u8fde\u63a5\u6c60\uff0c\u8def\u7531\u5668\uff0c\u8fc7\u6ee4\u5668\uff0c\u7194\u65ad\u7b49\\n- Server \u8d1f\u8f7d: \u6307\u6807\u4fe1\u606f\u8bb0\u5f55 Higress gateway \u670d\u52a1\u5668\u5b9e\u4f8b\u7684\u8d1f\u8f7d\u7b49\\n\\nHigress \u6307\u6807\u6570\u636e\u7c7b\u578b\u4e3b\u8981\u6709\u4e09\u7c7b:\\n- Counter: \u65e0\u7b26\u53f7\u6574\u6570\uff0c\u53ea\u4f1a\u589e\u52a0\u800c\u4e0d\u4f1a\u51cf\u5c11\u3002\u4f8b\u5982\uff0c\u603b\u8bf7\u6c42\\n- Gauge: \u589e\u52a0\u548c\u51cf\u5c11\u7684\u65e0\u7b26\u53f7\u6574\u6570\u3002\u4f8b\u5982\uff0c\u5f53\u524d\u6d3b\u52a8\u7684\u8bf7\u6c42\\n- Histogram: \u4f5c\u4e3a\u6307\u6807\u6d41\u7684\u4e00\u90e8\u5206\u7684\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u7136\u540e\u7531\u6536\u96c6\u5668\u805a\u5408\u4ee5\u6700\u7ec8\u4ea7\u751f\u6c47\u603b\u7684\u767e\u5206\u4f4d\u503c(percentile\uff0c\u5373\u5e73\u5e38\u8bf4\u7684 P99/P50/Pxx)\u3002\u4f8b\u5982\uff0cUpstream \u54cd\u5e94\u65f6\u95f4\\n\\n\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u83b7\u53d6 Higress gateway \u652f\u6301\u7684\u6307\u6807\u548c\u7c7b\u578b\\n\\n```shell\\n$ export HIGRESS_GATEWAY_POD=$(kubectl get pods -l app=higress-gateway -o \'jsonpath={.items[0].metadata.name}\' -n higress-system)\\n$ kubectl exec \\"$HIGRESS_GATEWAY_POD\\"  -n higress-system  -- curl -sS http://127.0.0.1:15020/stats/prometheus | grep \\"# TYPE\\"  \\n```\\n\u90e8\u5206\u6307\u6807\u5185\u5bb9\u5982\u4e0b\uff1a\\n```shell\\n...\\n# TYPE envoy_cluster_upstream_cx_total counter\\n# TYPE envoy_cluster_upstream_cx_tx_bytes_total counter\\n# TYPE envoy_cluster_upstream_flow_control_backed_up_total counter\\n# TYPE envoy_cluster_upstream_flow_control_drained_total counter\\n# TYPE envoy_cluster_upstream_flow_control_paused_reading_total counter\\n# TYPE envoy_cluster_upstream_flow_control_resumed_reading_total counter\\n# TYPE envoy_cluster_upstream_internal_redirect_failed_total counter\\n# TYPE envoy_cluster_upstream_internal_redirect_succeeded_total counter\\n# TYPE envoy_cluster_upstream_rq counter\\n# TYPE envoy_cluster_upstream_rq_101 counter\\n# TYPE envoy_cluster_upstream_rq_200 counter\\n# TYPE envoy_cluster_upstream_rq_201 counter\\n# TYPE envoy_cluster_upstream_rq_301 counter\\n# TYPE envoy_cluster_upstream_rq_302 counter\\n# TYPE envoy_cluster_upstream_rq_304 counter\\n# TYPE envoy_cluster_upstream_rq_401 counter\\n# TYPE envoy_cluster_upstream_rq_404 counter\\n# TYPE envoy_cluster_upstream_rq_cancelled counter\\n# TYPE envoy_cluster_upstream_rq_completed counter\\n# TYPE envoy_cluster_upstream_rq_maintenance_mode counter\\n# TYPE envoy_cluster_upstream_rq_max_duration_reached counter\\n# TYPE envoy_cluster_upstream_rq_pending_failure_eject counter\\n# TYPE envoy_cluster_upstream_rq_pending_overflow counter\\n# TYPE envoy_cluster_upstream_rq_pending_total counter\\n# TYPE envoy_cluster_upstream_rq_per_try_idle_timeout counter\\n# TYPE envoy_cluster_upstream_rq_per_try_timeout counter\\n# TYPE envoy_cluster_upstream_rq_retry counter\\n# TYPE envoy_cluster_upstream_rq_retry_backoff_exponential counter\\n# TYPE envoy_cluster_upstream_rq_retry_backoff_ratelimited counter\\n# TYPE envoy_cluster_upstream_rq_retry_limit_exceeded counter\\n# TYPE envoy_cluster_upstream_rq_retry_overflow counter\\n# TYPE envoy_cluster_upstream_rq_retry_success counter\\n# TYPE envoy_cluster_upstream_rq_rx_reset counter\\n# TYPE envoy_cluster_upstream_rq_timeout counter\\n# TYPE envoy_cluster_upstream_rq_total counter\\n# TYPE envoy_cluster_upstream_rq_tx_reset counter\\n...\\n# TYPE envoy_http_downstream_cx_total counter\\n# TYPE envoy_http_downstream_cx_tx_bytes_total counter\\n# TYPE envoy_http_downstream_cx_upgrades_total counter\\n# TYPE envoy_http_downstream_flow_control_paused_reading_total counter\\n# TYPE envoy_http_downstream_flow_control_resumed_reading_total counter\\n# TYPE envoy_http_downstream_rq counter\\n# TYPE envoy_http_downstream_rq_completed counter\\n# TYPE envoy_http_downstream_rq_failed_path_normalization counter\\n# TYPE envoy_http_downstream_rq_header_timeout counter\\n# TYPE envoy_http_downstream_rq_http1_total counter\\n# TYPE envoy_http_downstream_rq_http2_total counter\\n# TYPE envoy_http_downstream_rq_http3_total counter\\n# TYPE envoy_http_downstream_rq_idle_timeout counter\\n# TYPE envoy_http_downstream_rq_max_duration_reached counter\\n# TYPE envoy_http_downstream_rq_non_relative_path counter\\n# TYPE envoy_http_downstream_rq_overload_close counter\\n# TYPE envoy_http_downstream_rq_redirected_with_normalized_path counter\\n# TYPE envoy_http_downstream_rq_rejected_via_ip_detection counter\\n# TYPE envoy_http_downstream_rq_response_before_rq_complete counter\\n# TYPE envoy_http_downstream_rq_rx_reset counter\\n# TYPE envoy_http_downstream_rq_timeout counter\\n# TYPE envoy_http_downstream_rq_too_large counter\\n# TYPE envoy_http_downstream_rq_total counter\\n# TYPE envoy_http_downstream_rq_tx_reset counter\\n# TYPE envoy_http_downstream_rq_ws_on_non_ws_route counter\\n...\\n```\\n\\n\u5177\u4f53\u6307\u6807\u5b9a\u4e49\u53c2\u8003\u5982\u4e0b\uff1a\\n- [cluster manager](https://www.envoyproxy.io/docs/envoy/latest/configuration/upstream/cluster_manager/cluster_stats)\\n- [http connection manager](https://www.envoyproxy.io/docs/envoy/latest/configuration/http/http_conn_man/stats)\\n- [listeners](https://www.envoyproxy.io/docs/envoy/latest/configuration/listeners/stats)\\n- [server](https://www.envoyproxy.io/docs/envoy/latest/configuration/observability/statistics)\\n\\n\\n\u5982\u4f55\u67e5\u770b Higress \u6307\u6807\u6570\u636e\uff1a\\n\\n- \u901a\u8fc7 http://console.higress.io:8080/dashboard \u67e5\u770b Higress gateway \u76d1\u63a7\u9762\u677f\\n- \u901a\u8fc7 Skywalking Dashboard \u67e5\u770b Higress gateway \u76d1\u63a7\u6570\u636e\\n\\n\u901a\u8fc7 Skywalking Dashboard \u67e5\u770b Higress gateway \u76d1\u63a7\u6570\u636e\u90e8\u5206\u622a\u56fe\u5982\u4e0b\uff1a\\n\\n![img.png](../../../static/img/blog/skywalking/higress14.png)\\n![img.png](../../../static/img/blog/skywalking/higress15.png)\\n![img.png](../../../static/img/blog/skywalking/higress16.png)\\n\\n## \u53c2\u8003\u6587\u6863\\n- https://istio.io/latest/docs/tasks/observability/distributed-tracing/skywalking/\\n- http://peter.bourgon.org/blog/2017/02/21/metrics-tracing-and-logging.html\\n- https://skywalking.apache.org/docs/main/next/en/api/x-process-propagation-headers-v3/\\n- https://skywalking.apache.org/docs/main/next/en/api/trace-data-protocol-v3/"},{"id":"/ospp-2023","metadata":{"permalink":"/zh-cn/blog/ospp-2023","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/ospp-2023.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/ospp-2023.md","title":"Higress \u5f00\u6e90\u4e4b\u590f\u9879\u76ee\u62a5\u540d","description":"Higress \u662f\u57fa\u4e8e\u963f\u91cc\u5185\u90e8\u4e24\u5e74\u591a\u7684\u5b9e\u8df5\u6c89\u6dc0\uff0c\u4ee5\u5f00\u6e90 Istio \u4e0e Envoy \u4e3a\u6838\u5fc3\u6784\u5efa\u7684\u4e0b\u4e00\u4ee3\u4e91\u539f\u751f\u7f51\u5173","date":"2023-05-09T00:00:00.000Z","formattedDate":"2023\u5e745\u67089\u65e5","tags":[],"readingTime":8.635,"hasTruncateMarker":false,"authors":[{"name":"\u6f84\u6f6d"}],"frontMatter":{"title":"Higress \u5f00\u6e90\u4e4b\u590f\u9879\u76ee\u62a5\u540d","keywords":["higress","summer-ospp"],"description":"Higress \u662f\u57fa\u4e8e\u963f\u91cc\u5185\u90e8\u4e24\u5e74\u591a\u7684\u5b9e\u8df5\u6c89\u6dc0\uff0c\u4ee5\u5f00\u6e90 Istio \u4e0e Envoy \u4e3a\u6838\u5fc3\u6784\u5efa\u7684\u4e0b\u4e00\u4ee3\u4e91\u539f\u751f\u7f51\u5173","author":"\u6f84\u6f6d","date":"2023-05-09T00:00:00.000Z"},"prevItem":{"title":"Higress \u96c6\u6210 Skywalking \u53ef\u89c2\u6d4b\u6027\u63a2\u7d22","permalink":"/zh-cn/blog/skywalking"},"nextItem":{"title":"\u4e0a\u7ebf\u63a7\u5236\u53f0\uff0c\u964d\u4f4e\u4f7f\u7528\u95e8\u69db \uff5c Higress 1.0.0 RC \u7248\u672c\u53d1\u5e03","permalink":"/zh-cn/blog/release-100"}},"content":"## \u5f00\u6e90\u4e4b\u590f\u4ecb\u7ecd\\n\\n\u5f00\u6e90\u4e4b\u590f\u662f\u7531\u4e2d\u79d1\u9662\u8f6f\u4ef6\u6240\u201c\u5f00\u6e90\u8f6f\u4ef6\u4f9b\u5e94\u94fe\u70b9\u4eae\u8ba1\u5212\u201d\u53d1\u8d77\u5e76\u957f\u671f\u652f\u6301\u7684\u4e00\u9879\u6691\u671f\u5f00\u6e90\u6d3b\u52a8\uff0c\u65e8\u5728\u9f13\u52b1\u5728\u6821\u5b66\u751f\u79ef\u6781\u53c2\u4e0e\u5f00\u6e90\u8f6f\u4ef6\u7684\u5f00\u53d1\u7ef4\u62a4\uff0c\u57f9\u517b\u548c\u53d1\u6398\u66f4\u591a\u4f18\u79c0\u7684\u5f00\u53d1\u8005\uff0c\u4fc3\u8fdb\u4f18\u79c0\u5f00\u6e90\u8f6f\u4ef6\u793e\u533a\u7684\u84ec\u52c3\u53d1\u5c55\uff0c\u52a9\u529b\u5f00\u6e90\u8f6f\u4ef6\u4f9b\u5e94\u94fe\u5efa\u8bbe\u3002\\n\\n\u76ee\u524d[\u5f00\u6e90\u4e4b\u590f\u5b98\u7f51](https://summer-ospp.ac.cn)\u5df2\u7ecf\u5f00\u542f\u4e86\u5b66\u751f\u62a5\u540d\uff0c\u53ea\u8981\u4f60\u6ee1\u8db3\u4ee5\u4e0b\u8981\u6c42\u5373\u53ef\u8fdb\u884c\u9879\u76ee\u7533\u8bf7\uff1a\\n\\n- \u672c\u6d3b\u52a8\u9762\u5411\u5e74\u6ee1 18 \u5468\u5c81\u5728\u6821\u5b66\u751f\u3002\\n- \u6691\u671f\u5373\u5c06\u6bd5\u4e1a\u7684\u5b66\u751f\uff0c\u53ea\u8981\u5728\u7533\u8bf7\u65f6\u5b66\u751f\u8bc1\u5904\u5728\u6709\u6548\u671f\u5185\uff0c\u5c31\u53ef\u4ee5\u63d0\u4ea4\u7533\u8bf7\u3002\\n- \u4e2d\u56fd\u7c4d\u5b66\u751f\u53c2\u4e0e\u6d3b\u52a8\u9700\u63d0\u4f9b\u8eab\u4efd\u8bc1\u3001\u5b66\u751f\u8bc1\u3001\u6559\u80b2\u90e8\u5b66\u7c4d\u5728\u7ebf\u9a8c\u8bc1\u62a5\u544a\uff08\u5b66\u4fe1\u7f51\uff09\u6216\u5728\u8bfb\u8bc1\u660e\u3002\\n- \u5916\u7c4d\u5b66\u751f\u53c2\u4e0e\u6d3b\u52a8\u9700\u63d0\u4f9b\u62a4\u7167\uff0c\u540c\u65f6\u63d0\u4f9b\u5f55\u53d6\u901a\u77e5\u4e66\u3001\u5b66\u751f\u5361\u3001\u5728\u8bfb\u8bc1\u660e\u7b49\u6587\u4ef6\u7528\u4e8e\u8bc1\u660e\u5b66\u751f\u8eab\u4efd\u3002\\n\\n\u53c2\u4e0e\u9879\u76ee\u4e0d\u4ec5\u53ef\u4ee5\u4e3a\u5f00\u6e90\u4e16\u754c\u505a\u51fa\u81ea\u5df1\u7684\u8d21\u732e\uff0c\u8fd8\u80fd\u83b7\u5f97\u4e30\u539a\u7684\u7ed3\u9879\u5956\u91d1\uff08\u57fa\u7840\u96be\u5ea68000 RMB/\u8fdb\u9636\u96be\u5ea612000 RMB\uff09\uff0c\u9879\u76ee\u7ecf\u9a8c\u4e5f\u4f1a\u6210\u4e3a\u4f60\u6bd5\u4e1a\u7b80\u5386\u4e0a\u7684\u4eae\u70b9\uff0c\u5feb\u6765\u62a5\u540d\u5427\uff01\\n\\n\u62a5\u540d\u622a\u6b62\u65f6\u95f4\u4e3a 6 \u6708 3 \u65e5 15 \u70b9\uff0c\u5177\u4f53\u53c2\u8003\u5b98\u7f51\u6d3b\u52a8\u6d41\u7a0b\u548c\u53c2\u4e0e\u6307\u5357\u4ecb\u7ecd\uff1a\\n\\n![](https://img.alicdn.com/imgextra/i4/O1CN01gxAj9N27FL4twpxbV_!!6000000007767-0-tps-2768-1114.jpg)\\n\\n\\n## Higress \u4ecb\u7ecd\\n\\nHigress \u662f\u57fa\u4e8e\u963f\u91cc\u5185\u90e8\u4e24\u5e74\u591a\u7684\u5b9e\u8df5\u6c89\u6dc0\uff0c\u4ee5\u5f00\u6e90 Istio \u4e0e Envoy \u4e3a\u6838\u5fc3\u6784\u5efa\u7684\u4e0b\u4e00\u4ee3\u4e91\u539f\u751f\u7f51\u5173\u3002Higress \u5b9e\u73b0\u4e86\u5b89\u5168\u9632\u62a4\u7f51\u5173\u3001\u6d41\u91cf\u7f51\u5173\u3001\u5fae\u670d\u52a1\u7f51\u5173\u4e09\u5c42\u7f51\u5173\u5408\u4e00\uff0c\u53ef\u4ee5\u663e\u8457\u964d\u4f4e\u7f51\u5173\u7684\u90e8\u7f72\u548c\u8fd0\u7ef4\u6210\u672c\u3002\\n\\n![](https://img.alicdn.com/imgextra/i1/O1CN01iO9ph825juHbOIg75_!!6000000007563-2-tps-2483-2024.png)\\n\\nHigress \u5728\u963f\u91cc\u5185\u90e8\u7684\u8bde\u751f\u548c\u6f14\u8fdb\u5386\u7a0b\u53ef\u4ee5\u770b\u8fd9\u7bc7\u6587\u7ae0:\\n\\n[\u963f\u91cc\u5df4\u5df4\u91cd\u78c5\u5f00\u6e90\u4e91\u539f\u751f\u7f51\u5173: Higress](https://mp.weixin.qq.com/s/dgvd9TslzhX1ZuUNIH2ZXg)\\n\\nHigress \u5f00\u6e90\u534a\u5e74\u65f6\u95f4\uff0cGitHub star \u6570\u5df2\u7ecf\u7834\u5343\uff0c\u5728\u4e0a\u4e2a\u6708 Higress \u5df2\u7ecf Release \u51fa\u4e86\u7b2c\u4e00\u4e2a RC \u7248\u672c\uff0c\u4f5c\u4e3a\u6b63\u5f0f GA \u7684\u5019\u9009\u53d1\u5e03\u7248\u672c\uff0c\u8be6\u60c5\u53ef\u4ee5\u67e5\u770b\u8fd9\u7bc7\u6587\u7ae0:\\n\\n[\u4e0a\u7ebf\u63a7\u5236\u53f0\uff0c\u964d\u4f4e\u4f7f\u7528\u95e8\u69db\uff5cHigress 1.0.0 RC \u7248\u672c\u53d1\u5e03](https://mp.weixin.qq.com/s/ogy-xXXLEgzw6otaIAT6Dw)\\n\\n\u5728\u672c\u6b21\u5f00\u6e90\u4e4b\u590f\u6d3b\u52a8\u4e2d\uff0cHigress \u6709\u4e24\u4e2a\u8fdb\u9636\u96be\u5ea6\u7684\u9879\u76ee\u53ef\u4ee5\u7533\u8bf7\uff0c\u6b22\u8fce\u5404\u4f4d\u540c\u5b66\u8e0a\u8dc3\u62a5\u540d\u3002\\n\\n## \u9879\u76ee\u4ecb\u7ecd\\n\\n### \u9879\u76ee\u4e00\uff1aHigress Wasm \u63d2\u4ef6\u6784\u5efa/\u8c03\u8bd5/\u90e8\u7f72\u7684\u547d\u4ee4\u884c\u5b9e\u73b0\\n\\nHigress \u63d0\u4f9b\u4e86\u5f88\u65b9\u4fbf\u7684 Wasm \u63d2\u4ef6\u6269\u5c55\u6846\u67b6\uff0c\u5177\u4f53\u53ef\u4ee5\u67e5\u770b\u8fd9\u7bc7\u6587\u7ae0\uff1a [30\u884c\u4ee3\u7801\u5199\u4e00\u4e2aWasm Go\u63d2\u4ef6](https://higress.io/zh-cn/blog/30-line-wasm)\\n\\n\u66f4\u8be6\u7ec6\u7684\u63d2\u4ef6\u5f00\u53d1\u548c\u8c03\u8bd5\u6d41\u7a0b\u53ef\u4ee5\u67e5\u770b\u8fd9\u7bc7\u6587\u7ae0\uff1a[\u4f7f\u7528 Go \u8bed\u8a00\u5f00\u53d1 WASM \u63d2\u4ef6](https://higress.io/zh-cn/docs/user/wasm-go)\\n\\n\u8fd9\u91cc\u5bf9\u63d2\u4ef6\u7684\u751f\u6548\u673a\u5236\u7b80\u5355\u505a\u4e2a\u8bf4\u660e\uff1a\\n\\n![](https://img.alicdn.com/imgextra/i4/O1CN01PO4HYC1h7qYHonHHZ_!!6000000004231-2-tps-1100-537.png)\\n\\n1. \u7528\u6237\u5c06\u4ee3\u7801\u7f16\u8bd1\u6210 wasm \u6587\u4ef6\\n2. \u7528\u6237\u5c06 wasm \u6587\u4ef6\u6784\u5efa\u6210 oci \u955c\u50cf\\n3. \u7528\u6237\u5c06 oci \u955c\u50cf\u63a8\u9001\u81f3\u955c\u50cf\u4ed3\u5e93\\n4. \u7528\u6237\u521b\u5efa WasmPlugin \u8d44\u6e90\\n5. Istio watch \u5230 WasmPlugin \u8d44\u6e90\u7684\u53d8\u5316\\n6. Higress Gateway \u4e2d\u7684 xDS proxy \u8fdb\u7a0b\u4ece Istio \u83b7\u53d6\u5230\u914d\u7f6e\uff0c\u53d1\u73b0\u63d2\u4ef6\u7684\u955c\u50cf\u5730\u5740\\n7. xDS proxy \u4ece\u955c\u50cf\u4ed3\u5e93\u62c9\u53d6\u955c\u50cf\\n8. xDS proxy \u4ece\u955c\u50cf\u4e2d\u63d0\u53d6\u51fa wasm \u6587\u4ef6\\n9. Higress Gateway \u4e2d\u7684 envoy \u8fdb\u7a0b\u4ece xDS proxy \u83b7\u53d6\u5230\u914d\u7f6e\uff0c\u53d1\u73b0 wasm \u6587\u4ef6\u7684\u672c\u5730\u8def\u5f84\\n10. envoy \u4ece\u672c\u5730\u6587\u4ef6\u4e2d\u52a0\u8f7d wasm \u6587\u4ef6\\n\\n\u8fd9\u91cc envoy \u83b7\u53d6\u914d\u7f6e\u5e76\u52a0\u8f7d wasm \u6587\u4ef6\u4f7f\u7528\u5230\u4e86 ECDS (Extension Config Discovery Service)\u7684\u673a\u5236\uff0c\u5b9e\u73b0\u4e86 wasm \u6587\u4ef6\u66f4\u65b0\uff0c\u76f4\u63a5\u70ed\u52a0\u8f7d\uff0c\u4e0d\u4f1a\u5bfc\u81f4\u4efb\u4f55\u8fde\u63a5\u4e2d\u65ad\uff0c\u4e1a\u52a1\u6d41\u91cf\u5b8c\u5168\u65e0\u635f\u3002\\n\\n\u8fd9\u4e2a\u9879\u76ee\u7684\u521d\u8877\u662f\u5e0c\u671b\u80fd\u57fa\u4e8e Higress \u7684 CLI \u547d\u4ee4\u884c\u5de5\u5177(hgctl) \u6765\u8fdb\u4e00\u6b65\u7b80\u5316 Higress Wasm \u63d2\u4ef6\u7684\u5f00\u53d1\u8c03\u8bd5\u548c\u5b89\u88c5\u90e8\u7f72\u6b65\u9aa4\uff0c\u4f7f\u4e4b\u66f4\u5bb9\u6613\u4e0a\u624b\u4f7f\u7528\u3002\\n\\n\u9700\u8981\u5b9e\u73b0\u7684 hgctl \u547d\u4ee4\u5982\u4e0b\uff1a\\n\\n- hgctl plugin build\uff1a\u6784\u5efa wasm OCI \u955c\u50cf\u5e76\u63a8\u9001\u5230\u6307\u5b9a\u4ed3\u5e93\\n- hgctl plugin test\uff1a\u542f\u52a8 docker compose \u6d4b\u8bd5\u63d2\u4ef6\u529f\u80fd\\n- hgctl plugin install/uninstall \uff1a\u5728\u5f53\u524dhigress\u96c6\u7fa4\u4e2d\u5b89\u88c5\u6216\u5378\u8f7d\u63d2\u4ef6\\n- hgctl plugin config\uff1a\u4fee\u6539\u5236\u5b9a\u63d2\u4ef6\u7684\u914d\u7f6e\\n\\nHigress Wasm \u63d2\u4ef6\u914d\u7f6e\u57fa\u4e8e Openapi Specification \uff08OAS 3.0\uff09\u8fdb\u884c\u7ea6\u675f\uff0c\u9700\u8981\u80fd\u4ece\u4ee3\u7801\u4e2d\u89e3\u6790\u51fa\u63d2\u4ef6\u914d\u7f6e\u5b57\u6bb5\u683c\u5f0f\uff0c\u81ea\u52a8\u751f\u6210\u5bf9\u5e94\u7684 OAS \u7ea6\u675f\uff0c\u7528\u4e8e\u6dfb\u52a0\u5230 OCI \u955c\u50cf\u4e2d\uff0c\u5e76\u540c\u65f6\u7528\u4e8e install/uninstall/config \u7b49\u547d\u4ee4\u7684\u53c2\u6570\u914d\u7f6e\u6821\u9a8c\\n\\n### \u9879\u76ee\u4e8c\uff1a\u57fa\u4e8e Wasm \u5b9e\u73b0 OIDC \u8ba4\u8bc1\u63d2\u4ef6\\n\\nHigress \u4f5c\u4e3a\u4e00\u4e2a\u4e91\u539f\u751f\u7f51\u5173\uff0c\u9700\u8981\u5b9e\u73b0 OIDC \u8ba4\u8bc1\u7684\u80fd\u529b\uff0c\u65b9\u4fbf\u7528\u6237\u5bf9\u63a5\u5916\u90e8\u8ba4\u8bc1\u670d\u52a1\u3002\\n\\nOIDC \uff08OpenID Connect\uff09 \u662f\u57fa\u4e8e OAuth 2.0 \u7684\u8eab\u4efd\u8ba4\u8bc1\u534f\u8bae\uff0c\u53ef\u4ee5\u7528\u4e8e\u5b9e\u73b0 SSO\uff08Single Sign On\uff09\u5355\u70b9\u767b\u5f55\uff0c\u5373\u901a\u8fc7\u7f51\u5173\u7edf\u4e00\u5b8c\u6210\u7528\u6237\u7684\u8eab\u4efd\u8ba4\u8bc1\uff0c\u5728\u8eab\u4efd\u8ba4\u8bc1\u6210\u529f\u540e\uff0c\u518d\u5c06\u8d44\u6e90\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u540e\u7aef\u670d\u52a1\u3002\\n\\n![](https://summer-resource.obs.cn-north-4.myhuaweicloud.com/image_1682322347641.png?AccessKeyId=PVWAQ81YUWFDVEUNOSXR&Expires=1768722347&Signature=uaKg4CAupPRGPdz%2BtRT1qcc5SeI%3D)\\n\\n\u6d41\u7a0b\u7b80\u4ecb\u5982\u4e0b\uff1a\\n\\n1. \u5ba2\u6237\u7aef\u5411\u7f51\u5173\u53d1\u8d77\u8ba4\u8bc1\u8bf7\u6c42\u3002\\n2. \u7f51\u5173\u5c06\u8ba4\u8bc1\u8bf7\u6c42\u76f4\u63a5\u8f6c\u53d1\u5230\u7ed9\u8ba4\u8bc1\u670d\u52a1\u3002\\n3. \u8ba4\u8bc1\u670d\u52a1\u8bfb\u53d6\u8bf7\u6c42\u4e2d\u7684\u9a8c\u8bc1\u4fe1\u606f\uff08\u4f8b\u5982\u7528\u6237\u540d\u3001\u5bc6\u7801\uff09\u8fdb\u884c\u9a8c\u8bc1\uff0c\u9a8c\u8bc1\u901a\u8fc7\u540e\u8fd4\u56deCode\u7ed9\u7f51\u5173\u3002\\n4. \u7f51\u5173\u5c06\u643a\u5e26Code\u7684\u5e94\u7b54\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\\n5. \u5ba2\u6237\u7aef\u5411\u7f51\u5173\u8bf7\u6c42\u56de\u8c03\u63a5\u53e3\uff0c\u8bf7\u6c42\u4e2d\u643a\u5e26Code\u3002\\n6. \u7f51\u5173\u8bf7\u6c42\u8ba4\u8bc1\u670d\u52a1\u9881\u53d1Token\uff0c\u8bf7\u6c42\u4e2d\u643a\u5e26Code\u3001Client ID\u3001Client Secret\u3002\\n7. \u8ba4\u8bc1\u670d\u52a1\u9a8c\u8bc1\u5408\u6cd5\u6027\uff0c\u5e76\u8fd4\u56deID Token\u3002\\n8. \u8ba4\u8bc1\u6210\u529f\uff0c\u7f51\u5173\u5c06\u643a\u5e26ID Token\u7684\u5e94\u7b54\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\\n9. \u5ba2\u6237\u7aef\u5411\u7f51\u5173\u53d1\u8d77\u4e1a\u52a1\u8bf7\u6c42\uff0c\u8bf7\u6c42\u4e2d\u643a\u5e26ID Token\uff0c\u7f51\u5173\u6821\u9a8c\u8bf7\u6c42\u4e2d\u662f\u5426\u643a\u5e26ID Token\u548c\u5408\u6cd5\u6027\u3002\\n10. \u7f51\u5173\u6821\u9a8c\u5ba2\u6237\u7aef\u7684\u4e1a\u52a1\u8bf7\u6c42\u5408\u6cd5\uff0c\u5c06\u8bf7\u6c42\u900f\u4f20\u7ed9\u4e1a\u52a1\u670d\u52a1\u3002\\n11. \u4e1a\u52a1\u670d\u52a1\u8fdb\u884c\u4e1a\u52a1\u5904\u7406\u540e\u5e94\u7b54\u3002\\n12. \u7f51\u5173\u5c06\u4e1a\u52a1\u5e94\u7b54\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\\n\\n\u76ee\u524d Higress \u4e5f\u53ef\u4ee5\u57fa\u4e8e Envoy \u7684 Ext Authz \u673a\u5236\u5bf9\u63a5\u5916\u7f6e\u7684 oauth2-proxy \u6765\u5b9e\u73b0\u9274\u6743\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u65b9\u6848\u4e00\u65b9\u9762\u6709\u989d\u5916\u7684\u8bf7\u6c42\u5f00\u9500\uff0c\u53e6\u4e00\u65b9\u9762 oauth2-proxy \u53ea\u80fd\u4f5c\u4e00\u7ec4 OIDC \u914d\u7f6e\uff0c\u65e0\u6cd5\u5bf9\u63a5\u591a\u4e2a\u4e0d\u540c\u7684\u8ba4\u8bc1\u670d\u52a1\\n\\n\\n## \u52a0\u5165\u793e\u533a\\n\\nGitHub\uff1ahttps://github.com/alibaba/higress\\n\\n\u5b98\u7f51: https://higress.io\\n\\n\u5bf9\u4e8e\u62a5\u540d\u65b9\u5f0f\u6709\u4efb\u4f55\u7591\u95ee\uff0c\u6216\u8005\u5bf9\u67d0\u4e00\u4e2a\u4efb\u52a1\u975e\u5e38\u611f\u5174\u8da3\uff0c\u5e76\u4e14\u60f3\u8981\u6df1\u5165\u4e86\u89e3\u7684\u540c\u5b66\uff0c\u6b22\u8fce\u626b\u7801\u6dfb\u52a0\u5fae\u4fe1\uff0c\u5907\u6ce8\u5f00\u6e90\u4e4b\u590f\\n\\n![](https://img.alicdn.com/imgextra/i3/O1CN01bkpHik1yZBhbnhyTf_!!6000000006592-2-tps-500-500.png)\\n\\n## \u76f8\u5173\u9879\u76ee\u63a8\u8350\\n\\n- \u5bf9\u4e8e**\u5fae\u670d\u52a1\u6ce8\u518c\u53d1\u73b0\u548c\u914d\u7f6e\u7ba1\u7406**\u6709\u5174\u8da3\u7684\u540c\u5b66\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u586b\u62a5 [Nacos](https://nacos.io/zh-cn/blog/iscas2023.html) \u5f00\u6e90\u4e4b\u590f\uff1b\\n- \u5bf9\u4e8e**\u5fae\u670d\u52a1\u5206\u5e03\u5f0f\u4e8b\u52a1**\u6709\u5174\u8da3\u7684\u540c\u5b66\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u586b\u62a5 [Seata](https://summer-ospp.ac.cn/org/orgdetail/064c15df-705c-483a-8fc8-02831370db14?lang=zh) \u5f00\u6e90\u4e4b\u590f\uff1b\\n- \u5bf9\u4e8e**\u5fae\u670d\u52a1\u6846\u67b6\u548cRPC\u6846\u67b6**\u6709\u5174\u8da3\u7684\u540c\u5b66\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u586b\u62a5 [Spring Cloud Alibaba](https://summer-ospp.ac.cn/org/orgdetail/41d68399-ed48-4d6d-9d4d-3ff4128dc132?lang=zh) \u548c [Dubbo](https://summer-ospp.ac.cn/org/orgdetail/a7f6e2ad-4acc-47f8-9471-4e54b9a166a6?lang=zh) \u5f00\u6e90\u4e4b\u590f\uff1b\\n- \u5bf9\u4e8e**\u5206\u5e03\u5f0f\u9ad8\u53ef\u7528\u9632\u62a4**\u6709\u5174\u8da3\u7684\u540c\u5b66\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u586b\u62a5 [Sentinel](https://summer-ospp.ac.cn/org/orgdetail/5e879522-bd90-4a8b-bf8b-b11aea48626b?lang=zh) \u5f00\u6e90\u4e4b\u590f\uff1b\\n- \u5bf9\u4e8e**\u5fae\u670d\u52a1\u6cbb\u7406**\u6709\u5174\u8da3\u7684\u540c\u5b66\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u586b\u62a5 [OpenSergo](https://summer-ospp.ac.cn/org/orgdetail/aaff4eec-11b1-4375-997d-5eea8f51762b?lang=zh) \u5f00\u6e90\u4e4b\u590f\u3002"},{"id":"/release-100","metadata":{"permalink":"/zh-cn/blog/release-100","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/release-100.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/release-100.md","title":"\u4e0a\u7ebf\u63a7\u5236\u53f0\uff0c\u964d\u4f4e\u4f7f\u7528\u95e8\u69db \uff5c Higress 1.0.0 RC \u7248\u672c\u53d1\u5e03","description":"\u5386\u65f6 5 \u4e2a\u591a\u6708\uff0cHigress \u4e91\u539f\u751f\u7f51\u5173\u5f00\u6e90\u7684\u7b2c\u4e00\u4e2a\u91cd\u8981\u91cc\u7a0b\u7891\u8fbe\u6210\u4e86","date":"2023-04-10T00:00:00.000Z","formattedDate":"2023\u5e744\u670810\u65e5","tags":[],"readingTime":6.395,"hasTruncateMarker":false,"authors":[{"name":"\u6f84\u6f6d"}],"frontMatter":{"title":"\u4e0a\u7ebf\u63a7\u5236\u53f0\uff0c\u964d\u4f4e\u4f7f\u7528\u95e8\u69db \uff5c Higress 1.0.0 RC \u7248\u672c\u53d1\u5e03","keywords":["higress","GA"],"description":"\u5386\u65f6 5 \u4e2a\u591a\u6708\uff0cHigress \u4e91\u539f\u751f\u7f51\u5173\u5f00\u6e90\u7684\u7b2c\u4e00\u4e2a\u91cd\u8981\u91cc\u7a0b\u7891\u8fbe\u6210\u4e86","author":"\u6f84\u6f6d","date":"2023-04-10T00:00:00.000Z"},"prevItem":{"title":"Higress \u5f00\u6e90\u4e4b\u590f\u9879\u76ee\u62a5\u540d","permalink":"/zh-cn/blog/ospp-2023"},"nextItem":{"title":"UU\u8dd1\u817f\u57fa\u4e8eHigress\u7684\u4e91\u539f\u751f\u7f51\u5173\u5b9e\u8df5","permalink":"/zh-cn/blog/user-uu"}},"content":"## \u524d\u8a00\\n\\n\u5386\u65f6 5 \u4e2a\u591a\u6708\uff0cHigress \u63a8\u51fa\u4e86\u9996\u4e2a RC \uff08Release Candidate\uff0c\u5373\u6b63\u5f0f\u53d1\u5e03\u7684\u5019\u9009\uff09\u7248\u672c 1.0.0-rc\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u63a7\u5236\u53f0\uff0c\u5f00\u7bb1\u5373\u7528\u5730\u4f7f\u7528\u4e91\u539f\u751f\u7f51\u5173\u3002\\n\\n\u9009\u7528 Higress \u4f5c\u4e3a\u4e91\u539f\u751f\u7f51\u5173\u7684\u6838\u5fc3\u4f18\u52bf\u5982\u4e0b\uff1a\\n\\n- **\u6613\u7528\u6027**\\n\\n  \u201c\u4e91\u539f\u751f\u201d\u5df2\u7ecf\u4e0d\u518d\u662f\u4e00\u4e2a\u65b0\u9c9c\u8bcd\uff0c\u4f46\u4f01\u4e1a\u5bf9\u4e91\u539f\u751f\u6280\u672f\u7684\u5b66\u4e60\u4f7f\u7528\u6210\u672c\u4ecd\u6709\u8bb8\u591a\u987e\u8651\uff0c\u5bf9\u4e91\u539f\u751f\u65b0\u6807\u51c6\u7684\u8ffd\u8d76\u53c8\u6709\u5f88\u591a\u7126\u8651\uff1b\\n\\n  Higress \u540c\u65f6\u63d0\u4f9b\u4e86\u672c\u5730\u5b89\u88c5/\u751f\u4ea7\u90e8\u7f72\u7684 [quickstart](https://higress.io/zh-cn/docs/user/quickstart)\uff0c\u53ef\u4ee5\u4e00\u952e\u90e8\u7f72\uff0c\u5e76\u901a\u8fc7\u63a7\u5236\u53f0\u64cd\u4f5c\u5feb\u901f\u4e0a\u624b\uff1b\u57fa\u4e8e\u7b80\u5355\u6613\u7528\u7684\u63a7\u5236\u53f0\uff0cHigress \u53ef\u4ee5\u5c01\u88c5 Ingress/Gateway API \u7684\u6807\u51c6\u7ec6\u8282\uff0c\u6839\u6cbb\u6280\u672f\u8ffd\u8d76\u7126\u8651\u3002\\n\\n- **\u6807\u51c6\u5316**\\n\\n  K8s \u5e26\u6765\u4e86\u4e91\u539f\u751f\u7684\u8def\u7531\u6807\u51c6 Ingress/Gateway API\uff0c\u5982\u540c POSIX \u5b9a\u4e49 Unix \u53ef\u79fb\u690d\u64cd\u4f5c\u7cfb\u7edf\u6807\u51c6\uff0c\u5386\u65f6 35 \u5e74\u7ecf\u4e45\u4e0d\u8870\uff0c\u4e91\u539f\u751f\u7684\u8def\u7531\u6807\u51c6\u7684\u751f\u547d\u5468\u671f\u4e00\u5b9a\u4f1a\u8fdc\u8d85\u8fc7 K8s \u672c\u8eab\uff1b\\n\\n  Higress \u7ed3\u5408\u963f\u91cc\u5185\u90e8\u5b9e\u8df5\u4ee5\u53ca\u963f\u91cc\u4e91\u4ea7\u54c1\u6c89\u6dc0\uff0c\u79ef\u7d2f\u4e86\u57fa\u4e8e Ingress API \u7684\u4e30\u5bcc\u7684\u8def\u7531\u7b56\u7565\u6269\u5c55\u80fd\u529b\uff0c\u540c\u65f6\u8fd8\u517c\u5bb9\u5927\u90e8\u5206 Nginx Ingress \u80fd\u529b\uff0c\u8fd9\u4e9b\u80fd\u529b\u540e\u7eed\u4e5f\u5c06\u5728 Gateway API \u4e0a\u652f\u6301\u3002\\n\\n- **\u9ad8\u96c6\u6210**\\n\\n  \u4f01\u4e1a\u5185\u6709\u5927\u91cf\u4f20\u7edf\u67b6\u6784\u90e8\u7f72\u7684\u670d\u52a1\uff0c\u4f1a\u6210\u4e3a\u5411\u4e91\u539f\u751f\u67b6\u6784\u6f14\u8fdb\u7684\u6280\u672f\u8d1f\u62c5\uff0c\u8981\u6c42\u4e91\u539f\u751f\u7f51\u5173\u5177\u5907\u5bf9\u63a5\u5f02\u6784\u670d\u52a1\u67b6\u6784\u7684\u80fd\u529b\uff1b\\n\\n  \u57fa\u4e8e Higress \u63d0\u4f9b\u7684\u591a\u79cd\u670d\u52a1\u53d1\u73b0\u673a\u5236\uff0c\u7f51\u5173\u8def\u7531\u4e0d\u4ec5\u53ef\u4ee5\u8f6c\u53d1\u5230 K8s \u670d\u52a1\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u914d\u7f6e IP \u8f6c\u53d1\u5230\u5230\u7269\u7406\u673a\u4e0a\u7684\u670d\u52a1\uff1b\u57fa\u4e8e Nacos/ZooKeeper \u7b49\u6ce8\u518c\u4e2d\u5fc3\u5bf9\u63a5\uff0c\u8fd8\u53ef\u4ee5\u8f7b\u677e\u5b9e\u73b0 [Spring Cloud](https://higress.io/zh-cn/docs/user/spring-cloud) \u548c [Dubbo](https://higress.io/zh-cn/docs/user/dubbo) \u5fae\u670d\u52a1\u7684\u8def\u7531\uff0c\u65e0\u8bba\u5176\u662f\u5426\u90e8\u7f72\u5728 K8s \u5185\u3002\\n  \\n- **\u6613\u6269\u5c55**\\n\\n  \u57fa\u4e8e\u6269\u5c55\u673a\u5236\u8fdb\u884c\u4e8c\u6b21\u5f00\u53d1\u7684\u80fd\u529b\uff0c\u662f\u4e91\u539f\u751f\u7f51\u5173\u5728\u4e0d\u540c\u4e1a\u52a1\u573a\u666f\u4e0b\u90fd\u80fd\u9002\u914d\u843d\u5730\u7684\u5173\u952e\uff1b\\n  \\n  Higress\u63d0\u4f9b\u4e86\u7075\u6d3b\u7684\u63d2\u4ef6\u6269\u5c55\u673a\u5236\uff0c\u76ee\u524d\u63d2\u4ef6\u5e02\u573a\u5df2\u7ecf\u63a8\u51fa\u591a\u4e2a\u5b98\u65b9\u63d2\u4ef6\uff0c\u5e76\u652f\u6301\u7528\u6237\u901a\u8fc7\u63a7\u5236\u53f0\u76f4\u63a5\u4e0a\u4f20\u81ea\u5df1\u5f00\u53d1\u7684\u63d2\u4ef6\uff0c\u540c\u65f6\u5f00\u6e90\u793e\u533a\u7684\u63d2\u4ef6\u5e02\u573a\u751f\u6001\u4e5f\u5728\u4e0d\u65ad\u5efa\u8bbe\u4e2d\u3002\\n  \\n  \\n- **\u70ed\u66f4\u65b0**\\n\\n  \u4f20\u7edf Nginx \u66f4\u65b0\u89c4\u5219\u9700\u8981 reload \u4f1a\u5bfc\u81f4\u94fe\u63a5\u6296\u52a8\uff0c\u5bfc\u81f4\u6d41\u91cf\u635f\u5931\uff0c\u5bf9\u5b9e\u65f6\u901a\u4fe1\u3001\u89c6\u9891\u3001IOT\u65e0\u6cd5\u5bb9\u5fcd\uff1b\\n\\n  \u5bf9\u4e8e\u8def\u7531\u89c4\u5219\uff0cWasm \u63d2\u4ef6\u903b\u8f91\u66f4\u65b0\uff0c\u4ee5\u53ca\u8bc1\u4e66\u6539\u52a8\u7b49\u7b49\uff0cHigress \u5168\u90e8\u652f\u6301\u70ed\u66f4\u65b0\uff0c\u4e0d\u4f1a\u9020\u6210\u4efb\u4f55\u8fde\u63a5\u6296\u52a8\u3002\\n\\n\\n### \u4f01\u4e1a\u843d\u5730\u652f\u6301\\n\\n\u5728 RC \u7248\u672c\u9636\u6bb5\u4f7f\u7528 Higress \u7684\u4f01\u4e1a\u7528\u6237\uff0c\u793e\u533a\u4f1a\u5728\u843d\u5730\u9636\u6bb5\u63d0\u4f9b\u66f4\u591a\u5e2e\u52a9\uff0c\u6211\u4eec\u5efa\u7acb\u4e86 Higress \u4f01\u4e1a\u843d\u5730\u7fa4\uff0c\u53ef\u4ee5\u8054\u7cfb\u6211(\u5fae\u4fe1:nomadao \u9489\u9489:chengtanzty)\uff0c\u4f1a\u5c06\u4f60\u52a0\u8fdb\u7fa4\uff0c\u7fa4\u91cc\u6709\u793e\u533a\u6838\u5fc3\u7814\u53d1\u540c\u5b66\uff0c\u53ef\u4ee5\u63d0\u4f9b\u66f4\u53ca\u65f6\u7684\u54cd\u5e94\u548c\u5e2e\u52a9\u3002\\n\\n\\n### \u5b89\u88c5\u5347\u7ea7\u65b9\u5f0f\\n\\n\u5b89\u88c5 RC \u7248\u672c\uff0c\u9700\u8981 helm [\u5b89\u88c5](https://higress.io/zh-cn/docs/user/quickstart)\u6216[\u5347\u7ea7](https://higress.io/zh-cn/docs/ops/upgrade)\u65f6\u9700\u8981\u6307\u5b9a`--devel`\u53c2\u6570\uff0c\u4f8b\u5982\uff1a`helm upgrade higress -n higress-system --devel`\\n\\n1.0.0 RC \u7248\u672c\u5df2\u7ecf\u5728\u793e\u533a\u5c0f\u4f19\u4f34\u7684\u534f\u4f5c\u4e0b\u5b8c\u6210\u4e86\u591a\u8f6e\u6d4b\u8bd5\u548c\u4fee\u590d\u5de5\u4f5c\uff0c\u6b22\u8fce\u5927\u5bb6\u4f7f\u7528\u3002\u6700\u7ec8\u7684\u6b63\u5f0f\u7248\u672c\uff0c\u4e5f\u5c06\u5728\u8fd1\u671f\u5f88\u5feb\u63a8\u51fa\u3002\\n\\n\\n## \u63a7\u5236\u53f0\u529f\u80fd\u901f\u89c8\\n\\n- **\u4e30\u5bcc\u7684\u53ef\u89c2\u6d4b**\\n\\n  \u63d0\u4f9b\u5f00\u7bb1\u5373\u7528\u7684\u53ef\u89c2\u6d4b\uff0cGrafana&Prometheus \u53ef\u4ee5\u4f7f\u7528\u5185\u7f6e\u7684\u4e5f\u53ef\u5bf9\u63a5\u81ea\u5efa\u7684\uff0c\u5177\u4f53\u53ef\u4ee5\u53c2\u8003[\u6587\u6863](https://higress.io/zh-cn/docs/user/prometheus)\\n\\n  ![](https://img.alicdn.com/imgextra/i1/O1CN016n7gBU1UCnrfOBOZC_!!6000000002482-1-tps-1778-1012.gif)\\n    \\n\\n- **\u63d2\u4ef6\u6269\u5c55\u673a\u5236**\\n\\n  \u5b98\u65b9\u63d0\u4f9b\u4e86\u591a\u79cd\u63d2\u4ef6\uff0c\u7528\u6237\u4e5f\u53ef\u4ee5[\u5f00\u53d1](https://higress.io/zh-cn/docs/user/wasm-go)\u81ea\u5df1\u7684\u63d2\u4ef6\uff0c\u6784\u5efa\u6210 docker/oci [\u955c\u50cf](https://higress.io/zh-cn/docs/plugins/custom)\u540e\u5728\u63a7\u5236\u53f0\u914d\u7f6e\uff0c\u53ef\u4ee5\u5b9e\u65f6\u53d8\u66f4\u63d2\u4ef6\u903b\u8f91\uff0c\u5bf9\u6d41\u91cf\u5b8c\u5168\u65e0\u635f\u3002\\n\\n  ![](https://img.alicdn.com/imgextra/i2/O1CN01t7XqQB1s6R8cM5ZRS_!!6000000005717-1-tps-1778-1012.gif)\\n\\n\\n- **\u591a\u79cd\u670d\u52a1\u53d1\u73b0**\\n\\n  \u9ed8\u8ba4\u63d0\u4f9b K8s Service \u670d\u52a1\u53d1\u73b0\uff0c\u901a\u8fc7\u914d\u7f6e\u53ef\u4ee5\u5bf9\u63a5 Nacos/ZooKeeper \u7b49\u6ce8\u518c\u4e2d\u5fc3\u5b9e\u73b0\u670d\u52a1\u53d1\u73b0\uff0c\u4e5f\u53ef\u4ee5\u57fa\u4e8e\u9759\u6001 IP \u6216\u8005 DNS \u6765\u53d1\u73b0\\n\\n  ![](https://img.alicdn.com/imgextra/i2/O1CN0142CxRS1of0ZKg5soq_!!6000000005251-1-tps-1778-1012.gif)\\n    \\n\\n- **\u57df\u540d\u548c\u8bc1\u4e66**\\n\\n  \u53ef\u4ee5\u521b\u5efa\u7ba1\u7406 TLS \u8bc1\u4e66\uff0c\u5e76\u914d\u7f6e\u57df\u540d\u7684 HTTP/HTTPS \u884c\u4e3a\uff0c\u57df\u540d\u7b56\u7565\u91cc\u652f\u6301\u5bf9\u7279\u5b9a\u57df\u540d\u751f\u6548\u63d2\u4ef6\\n\\n  ![](https://img.alicdn.com/imgextra/i4/O1CN01eQhgZD1ggMonjdj9u_!!6000000004171-1-tps-1778-1012.gif)\\n\\n\\n- **\u4e30\u5bcc\u7684\u8def\u7531\u80fd\u529b**\\n\\n  \u57fa\u4e8e\u4e0a\u9762\u914d\u7f6e\u7684\u670d\u52a1\u53d1\u73b0\u673a\u5236\uff0c\u53d1\u73b0\u7684\u670d\u52a1\u4f1a\u51fa\u73b0\u5728\u670d\u52a1\u5217\u8868\u4e2d\uff1b\u521b\u5efa\u8def\u7531\u65f6\uff0c\u9009\u62e9\u57df\u540d\uff0c\u5b9a\u4e49\u8def\u7531\u5339\u914d\u673a\u5236\uff0c\u518d\u9009\u62e9\u76ee\u6807\u670d\u52a1\u8fdb\u884c\u8def\u7531\uff1b\u8def\u7531\u7b56\u7565\u91cc\u652f\u6301\u5bf9\u7279\u5b9a\u8def\u7531\u751f\u6548\u63d2\u4ef6\\n\\n  ![](https://img.alicdn.com/imgextra/i3/O1CN01lExhus1IvR4Q8kGmY_!!6000000000955-1-tps-1778-1012.gif)\\n\\n\\n### \u8fdb\u9636\u4f7f\u7528\\n\\nHigress \u63a7\u5236\u53f0\u7684\u529f\u80fd\u8fd8\u5728\u4e0d\u65ad\u4e30\u5bcc\u548c\u6f14\u8fdb\u4e2d\uff0c\u5f53\u524d\u8fd8\u6709\u5f88\u591a Higress Ingress \u6ce8\u89e3\u7684\u80fd\u529b\u6ca1\u6709\u652f\u6301\uff0c\u5982\u679c\u6709\u8fd9\u90e8\u5206\u6df1\u5ea6\u4f7f\u7528\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u53c2\u8003[\u8fd9\u7bc7\u6587\u6863](https://higress.io/zh-cn/docs/user/annotation-use-case)\u8fdb\u884c\u8fdb\u9636\u914d\u7f6e\\n\\n\u5982\u679c\u5e0c\u671b\u4f7f\u7528 Istio \u7684\u80fd\u529b\u8fdb\u884c\u6d41\u91cf\u6cbb\u7406\uff0c\u53ef\u4ee5\u53c2\u8003[\u8fd9\u7bc7\u6587\u6863](https://higress.io/zh-cn/docs/ops/deploy-by-helm)\u7684\u652f\u6301 Istio CRD \u4e00\u8282\u3002\u57fa\u4e8e Istio \u7684 [EnvoyFilter API](https://istio.io/latest/docs/reference/config/networking/envoy-filter/) \u53ef\u4ee5\u5b9e\u73b0\u66f4\u591a\u7ec6\u7c92\u5ea6\u7684\u7ba1\u63a7\u80fd\u529b\u3002\\n\\n\\n\\n## \u793e\u533a\\n\\n\u6b22\u8fce\u8ba4\u9886 Higress Issue \u4efb\u52a1\uff1ahttps://github.com/alibaba/higress/issues?q=is%3Aopen+is%3Aissue+label%3A%22help+wanted%22\\n\\n\u5b8c\u6210\u4e00\u5b9a\u6570\u91cf\u7684 Issues \u5c31\u53ef\u4ee5\u6210\u4e3a Higress Committer\uff0c\u4e5f\u6709\u673a\u4f1a\u83b7\u5f97\u5f00\u6e90\u793e\u533a\u7684\u793c\u7269\u548c\u8363\u8a89\ud83c\udfc6\\n\\n\u6b22\u8fce\u52a0\u5165 Higress \u793e\u533a\u7fa4\uff0c\u53ca\u65f6\u4e86\u89e3\u66f4\u591a Higress \u52a8\u5411\uff1a\\n\\n![](https://img.alicdn.com/imgextra/i2/O1CN0171Hg8d1XMMz4eFo3b_!!6000000002909-0-tps-720-405.jpg)"},{"id":"/user-uu","metadata":{"permalink":"/zh-cn/blog/user-uu","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/user-uu.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/user-uu.md","title":"UU\u8dd1\u817f\u57fa\u4e8eHigress\u7684\u4e91\u539f\u751f\u7f51\u5173\u5b9e\u8df5","description":"\u4ecb\u7ecdUU\u8dd1\u817f\u7684\u4e91\u539f\u751f\u7f51\u5173\u63a2\u7d22\u4e4b\u8def","date":"2023-03-30T00:00:00.000Z","formattedDate":"2023\u5e743\u670830\u65e5","tags":[],"readingTime":3.285,"hasTruncateMarker":false,"authors":[{"name":"\u738b\u5fb7\u51b2"}],"frontMatter":{"title":"UU\u8dd1\u817f\u57fa\u4e8eHigress\u7684\u4e91\u539f\u751f\u7f51\u5173\u5b9e\u8df5","keywords":["higress","UU\u8dd1\u817f"],"description":"\u4ecb\u7ecdUU\u8dd1\u817f\u7684\u4e91\u539f\u751f\u7f51\u5173\u63a2\u7d22\u4e4b\u8def","author":"\u738b\u5fb7\u51b2","date":"2023-03-30T00:00:00.000Z"},"prevItem":{"title":"\u4e0a\u7ebf\u63a7\u5236\u53f0\uff0c\u964d\u4f4e\u4f7f\u7528\u95e8\u69db \uff5c Higress 1.0.0 RC \u7248\u672c\u53d1\u5e03","permalink":"/zh-cn/blog/release-100"},"nextItem":{"title":"Higress 0.7.0 \u7248\u672c\u53d1\u5e03\uff1aGA \u8fdb\u5165\u5012\u8ba1\u65f6","permalink":"/zh-cn/blog/release-070"}},"content":"## UU\u8dd1\u817f\u4ecb\u7ecd\\n\\nUU\u8dd1\u817f\u96b6\u5c5e\u4e8e\u90d1\u5dde\u65f6\u7a7a\u96a7\u9053\u4fe1\u606f\u6280\u672f\u6709\u9650\u516c\u53f8\uff0c\u662f\u66f4\u4e13\u4e1a\u7684\u540c\u57ce\u5373\u65f6\u751f\u6d3b\u670d\u52a1\u5e73\u53f0\uff0c\u4ee5\u5171\u4eab\u52b3\u52a8\u529b\u4e0e\u65f6\u95f4\u4e3a\u4f17\u5305\u7406\u5ff5\uff0c\u4eba\u4eba\u90fd\u53ef\u6ce8\u518c\u6210\u4e3a\u8dd1\u817f\u5e08\u5085\uff0c\u5e76\u4e3a\u9644\u8fd1\u7684\u4eba\u63d0\u4f9b\u5e2e\u53d6\u9001\u3001\u5e2e\u4e70\u3001\u5168\u80fd\u5e2e\u3001\u5e2e\u6392\u961f\u7b49\u591a\u6837\u5316\u540c\u57ce\u5373\u65f6\u670d\u52a1\uff0c\u4e3a\u4e2d\u5c0f\u4f01\u4e1a\u3001\u7535\u5546\u3001\u672c\u5730\u5546\u6237\u63d0\u4f9b\u5b89\u5168\u4e13\u4e1a\u7684\u9ad8\u7aef\u914d\u9001\u670d\u52a1\u3002UU\u8dd1\u817f\u79c9\u627f\u201c\u8ba9\u751f\u6d3b\u66f4\u7f8e\u597d\u201d\u7684\u7406\u5ff5\uff0c\u4e0d\u65ad\u521b\u65b0\u3001\u4e0d\u65ad\u8fdb\u6b65\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u66f4\u52a0\u4f18\u8d28\u7684\u670d\u52a1\u4f53\u9a8c\u3002\\n\\n## \u80cc\u666f\u9700\u6c42\\n\\nUU\u8dd1\u817f\u5bf9\u4e8e\u4e91\u539f\u751f\u7f51\u5173\u7684\u8981\u6c42\u662f\uff0c\u80fd\u540c\u65f6\u6ee1\u8db3\u6d41\u91cf\u7f51\u5173\uff0c\u5fae\u670d\u52a1\u7f51\u5173\uff0c\u4ee5\u53ca\u5b89\u5168\u7f51\u5173\u7684\u573a\u666f\u8bc9\u6c42\uff0c\u7528\u4e00\u4e2a\u7f51\u5173\u6765\u89e3\u51b3\u4e4b\u524d\u9700\u8981\u90e8\u7f72\u591a\u4e2a\u7f51\u5173\u624d\u80fd\u89e3\u51b3\u7684\u95ee\u9898\uff1a\\n\\n1. \u5177\u5907\u9ad8\u53ef\u9760\u6027\u548c\u9ad8\u6027\u80fd\uff0c\u53ef\u4ee5\u66ff\u4ee3\u4e4b\u524d\u90e8\u7f72\u7684 **Nginx Ingress \u6d41\u91cf\u7f51\u5173**\\n2. \u540c\u65f6\u652f\u6301 K8s \u751f\u6001\u548c\u4f20\u7edf\u5fae\u670d\u52a1\u751f\u6001\u63a5\u5165\uff0c\u652f\u6301\uff08HTTP\u8f6cDubbo\uff09\u534f\u8bae\u8f6c\u6362\uff0c\u53ef\u4ee5\u66ff\u4ee3\u4e4b\u524d\u90e8\u7f72\u7684 **Spring Cloud Gateway \u5fae\u670d\u52a1\u7f51\u5173**\\n3. \u80fd\u591f\u652f\u6301\u5728\u7f51\u5173\u5165\u53e3\u5904\u5b8c\u6210\u9274\u6743\uff0c\u907f\u514d\u6bcf\u4e2a\u540e\u7aef\u670d\u52a1\u91cd\u590d\u5b9e\u73b0\u9274\u6743\u529f\u80fd\uff0c\u5b9e\u73b0**\u5b89\u5168\u7f51\u5173**\u7684\u80fd\u529b\\n4. \u5177\u5907\u6613\u7528\u7684\u63a7\u5236\u53f0\u8fdb\u884c API \u7684\u6cbb\u7406\uff0c\u4ee5\u53ca\u5177\u5907\u4e30\u5bcc\u7684\u53ef\u89c2\u6d4b\u6307\u6807\\n\\n\\n## \u8fc1\u79fb Higress \u524d\u7684\u67b6\u6784\\n\\n![old-arch](https://img.alicdn.com/imgextra/i1/O1CN016p6RZz21KwDVA9Gz5_!!6000000006967-2-tps-1014-431.png)\\n\\n\u4e4b\u524d\u5b58\u5728\u7684\u4e3b\u8981\u75db\u70b9\uff1a\\n\\n1. Spring Cloud Gateway \u81ea\u8eab\u53c2\u6570\u8c03\u6574\u6539\u52a8\u9700\u8981\u91cd\u65b0\u90e8\u7f72\u5f71\u54cd\u6d41\u91cf\uff0c\u4e14\u52a8\u6001\u8def\u7531\u9700\u8981\u8fdb\u884c\u590d\u6742\u7684\u914d\u7f6e\uff0c\u5305\u62ec\u8def\u7531\u89c4\u5219\uff0c\u5bb9\u6613\u51fa\u73b0\u914d\u7f6e\u9519\u8bef\u5bfc\u81f4\u7cfb\u7edf\u5f02\u5e38\\n2. \u8fd0\u7ef4\u9700\u8981\u540c\u65f6\u7ef4\u62a4 Nginx Ingress \u548c Spring Cloud Gateway\uff0c\u9762\u5bf9\u6d41\u91cf\u9ad8\u5cf0\u8fdb\u884c\u8fdb\u884c\u6269\u5bb9\u76f8\u5173\u64cd\u4f5c\u65f6\uff0c\u8fd0\u7ef4\u8d1f\u62c5\u6bd4\u8f83\u91cd\uff0c\u800c\u4e14\u8fd9\u6837\u4e24\u5c42\u7f51\u5173\u7684\u8bf7\u6c42\u7684\u94fe\u8def\u8f83\u957f\uff0c\u53ef\u7528\u6027\u4f4e\u3001\u6210\u672c\u9ad8\\n\\n\\n## \u8fc1\u79fb Higress \u540e\u7684\u67b6\u6784\\n\\n![new-arch](https://img.alicdn.com/imgextra/i3/O1CN01tCWvwN22sCbD7DmqA_!!6000000007175-2-tps-1014-420.png)\\n\\nHigress\u4e91\u539f\u751f\u7f51\u5173\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u3001\u8def\u7531\u3001\u5b89\u5168\u8ba4\u8bc1\u7b49\u529f\u80fd\u3002\u901a\u8fc7\u7f51\u5173\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u7edf\u4e00\u5165\u53e3\uff0c\u5e76\u5bf9\u8bf7\u6c42\u8fdb\u884c\u9274\u6743\u3001\u9650\u6d41\u548c\u76d1\u63a7\u7b49\u64cd\u4f5c\uff0c\u7528\u7b80\u5355\u7684\u67b6\u6784\u4fdd\u8bc1\u4e86\u6574\u4f53\u7cfb\u7edf\u7684\u7a33\u5b9a\u6027\u548c\u53ef\u9760\u6027\u3002\\n\\n1. \u5408\u5e76\u6d41\u91cf\u7f51\u5173\uff08K8s Nginx Ingress\uff09\u548c\u5fae\u670d\u52a1\u7f51\u5173\uff08Spring Cloud Gateway \uff09\uff0c\u964d\u4f4e\u7f51\u5173\u6210\u672c\uff0c\u9ad8\u6027\u80fd\u670d\u52a1\uff1b\\n2. \u540c\u65f6\u652f\u6301 K8s service \u548c Nacos \u670d\u52a1\u6ce8\u518c\u53d1\u73b0\uff0c\u6ee1\u8db3\u6280\u672f\u9700\u6c42\u5bf9 K8s \u751f\u6001\u548c\u4f20\u7edf\u5fae\u670d\u52a1\u751f\u6001\u63a5\u5165\u3002\\n3. Nginx Ingress \u5b8c\u7f8e\u8fc1\u79fb\u5230 Higress\uff0c\u5341\u5206\u4e1d\u6ed1"},{"id":"/release-070","metadata":{"permalink":"/zh-cn/blog/release-070","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/release-070.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/release-070.md","title":"Higress 0.7.0 \u7248\u672c\u53d1\u5e03\uff1aGA \u8fdb\u5165\u5012\u8ba1\u65f6","description":"Higress 0.7.0 \u7248\u672c\u4ecb\u7ecd","date":"2023-03-20T00:00:00.000Z","formattedDate":"2023\u5e743\u670820\u65e5","tags":[],"readingTime":4.31,"hasTruncateMarker":false,"authors":[{"name":"\u6f84\u6f6d"}],"frontMatter":{"title":"Higress 0.7.0 \u7248\u672c\u53d1\u5e03\uff1aGA \u8fdb\u5165\u5012\u8ba1\u65f6","keywords":["higress"],"description":"Higress 0.7.0 \u7248\u672c\u4ecb\u7ecd","author":"\u6f84\u6f6d","date":"2023-03-20T00:00:00.000Z"},"prevItem":{"title":"UU\u8dd1\u817f\u57fa\u4e8eHigress\u7684\u4e91\u539f\u751f\u7f51\u5173\u5b9e\u8df5","permalink":"/zh-cn/blog/user-uu"},"nextItem":{"title":"Higress + Nacos \u5fae\u670d\u52a1\u7f51\u5173\u6700\u4f73\u5b9e\u8df5","permalink":"/zh-cn/blog/nacos"}},"content":"## \u8fdb\u5c55\u6982\u8981\\n\\n1. Higress \u63a7\u5236\u53f0\u6b63\u5f0f release\uff0c\u6db5\u76d6 Higress \u7684\u670d\u52a1/\u8def\u7531/\u57df\u540d/\u8bc1\u4e66\u7ba1\u7406\u80fd\u529b\uff0c\u5e76\u63d0\u4f9b\u5f00\u7bb1\u5373\u7528\u7684\u53ef\u89c2\u6d4b\u529f\u80fd\\n2. \u5b89\u88c5/\u5347\u7ea7 Higress \u65f6\u652f\u6301\u81ea\u52a8\u5b89\u88c5\u5bf9\u5e94\u7248\u672c\u7684 Higress Console\uff0c\u907f\u514d\u7248\u672c\u4e0d\u9002\u914d\u7684\u95ee\u9898\\n3. \u652f\u6301\u5f00\u542f Istio API\uff0c\u5b9e\u73b0\u66f4\u591a\u590d\u6742\u7684\u529f\u80fd\uff0c\u5e76\u4e14\u4e5f\u53ef\u4ee5\u7528\u4e8e\u5e73\u6ed1\u66ff\u6362 Istio Ingress Gateway\\n\\n\\n## \u7248\u672c\u7279\u6027\\n\\n### Higress \u63a7\u5236\u53f0\\n\\n\u73b0\u5728\u901a\u8fc7 helm \u547d\u4ee4\u5b89\u88c5 Higress \u65f6\u5c06\u81ea\u52a8\u5b89\u88c5\u5bf9\u5e94\u7248\u672c\u7684 Higress Console, \u8fd9\u91cc\u901a\u8fc7 `higress-console.domain` \u53c2\u6570\uff0c\u53ef\u4ee5\u6307\u5b9a\u63a7\u5236\u53f0\u7684\u57df\u540d\u3002\\n\\n```bash\\n# \u5df2\u7ecf\u6dfb\u52a0\u8fc7 repo \u7684\uff0c\u8bf7\u6267\u884c helm repo update\\nhelm repo add higress.io https://higress.io/helm-charts\\nhelm install higress -n higress-system higress.io/higress --create-namespace --render-subchart-notes --set higress-console.domain=console.higress.io\\n```\\n\\n![image](/img/user/quickstart/zh-cn/console-credentials.png)\\n\\n\u6ce8\u610f\uff1a\u5b89\u88c5\u5b8c\u6210\u540e\u4f1a\u8f93\u51fa\u4e00\u6bb5\u6587\u672c\uff0c\u5176\u4e2d\u5305\u542b\u83b7\u53d6\u63a7\u5236\u53f0\u767b\u5f55\u4fe1\u606f\u7684\u547d\u4ee4\u3002\u8bf7\u6267\u884c\u8be5\u547d\u4ee4\u5e76\u8bb0\u5f55\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002\\n\\n![image](/img/user/quickstart/zh-cn/login.png)\\n\\n\u6b63\u5f0f\u73af\u5883\u90e8\u7f72\u65f6\uff0c\u5efa\u8bae\u63a7\u5236\u53f0\u5f00\u542f\u5f3a\u5236 HTTPS \u8bbf\u95ee\uff0c\u5177\u4f53\u64cd\u4f5c\u65b9\u5f0f\u662f\uff0c\u5728 higress-system \u547d\u540d\u7a7a\u95f4\u4e0b\u5148\u521b\u5efa\u597d TLS \u8bc1\u4e66\u548c\u79c1\u94a5\u5bf9\u5e94\u7684 secret\uff0c\u4f8b\u5982\uff1a\\n\\n```yaml\\napiVersion: v1\\nkind: Secret\\ntype: kubernetes.io/tls\\ndata:\\n  tls.crt: -----BEGIN CERTIFICATE-----...\\n  tls.key: -----BEGIN RSA PRIVATE KEY-----...\\nmetadata:\\n  name: my-tls-secret\\n  namespace: higress-system\\n```\\n\\n\u7136\u540e\u901a\u8fc7\u4e0b\u9762 helm \u547d\u4ee4\u5f00\u542f\u5f3a\u5236 HTTPS \u8bbf\u95ee\\n\\n```bash\\nhelm upgrade higress -n higress-system higress.io/higress --set higress-console.tlsSecretName=my-tls-secret\\n```\\n\\n\u5982\u679c\u5e0c\u671b\u542f\u7528 Higress \u81ea\u5e26\u7684 Prometheus&Grafana\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762 helm \u547d\u4ee4\u8fdb\u884c\u5b89\u88c5\uff1a\\n\\n```bash\\nhelm upgrade higress -n higress-system higress.io/higress --set higress-console.o11y.enabled=true\\n```\\n\\n\u8fd9\u6837 Higress \u63a7\u5236\u53f0\u5c31\u53ef\u4ee5\u770b\u5230\u81ea\u5e26\u7684\u53ef\u89c2\u6d4b\u5927\u76d8\u4e86\uff1a\\n\\n![image](https://img.alicdn.com/imgextra/i3/O1CN01bUCXjy275GLq7ralt_!!6000000007745-0-tps-3532-2022.jpg)\\n\\n\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5bf9\u63a5\u5df2\u6709\u7684 Prometheus&Grafana\uff0c\u4f7f\u7528\u8fd9\u4efd Higress \u5b98\u65b9\u63d0\u4f9b\u7684 Dashboard \u914d\u7f6e\u5373\u53ef\uff1ahttps://higress.io/grafana/dashboard.json\\n\\n\u53ef\u4ee5\u767b\u9646 Higress \u63a7\u5236\u53f0 Demo \u8bd5\u7528\u73b0\u6709\u6240\u6709\u529f\u80fd: http://demo.higress.io\\n\\n### \u5f00\u542f Istio API\\n\\n\u901a\u8fc7\u5f00\u542f Istio API\uff0c\u53ef\u4ee5\u5b9e\u73b0\u4f7f\u7528 Higress \u5e73\u6ed1\u66ff\u6362 Istio Ingress Gateway\uff0c\u5177\u4f53 helm \u547d\u4ee4\u5982\u4e0b\uff1a\\n\\n```bash\\nhelm upgrade higress -n higress-system higress.io/higress --set global.enableIstioAPI=true\\n```\\n\\n\u57fa\u4e8e Istio API\uff0c\u53ef\u4ee5\u5b9e\u73b0\u76ee\u524d Higress \u8fd8\u672a\u63d0\u4f9b\u76f8\u5e94 Ingress \u6ce8\u89e3\u7684\u80fd\u529b\uff0c\u4f8b\u5982\u57fa\u4e8e Istio EnvoyFilter \u6765\u5b9e\u73b0 HTTP to Dubbo \u7684\u534f\u8bae\u8f6c\u6362\u914d\u7f6e\u65b9\u5f0f\uff1a\\n\\n```yaml\\napiVersion: networking.istio.io/v1alpha3\\nkind: EnvoyFilter\\nmetadata:\\n  name: http-dubbo-transcoder\\n  namespace: higress-system\\nspec:\\n  configPatches:\\n  - applyTo: HTTP_FILTER\\n    match:\\n      context: GATEWAY\\n      listener:\\n        filterChain:\\n          filter:\\n            name: envoy.filters.network.http_connection_manager\\n            subFilter:\\n              name: envoy.filters.http.router\\n    patch:\\n      operation: INSERT_BEFORE\\n      value:\\n        name: envoy.filters.http.http_dubbo_transcoder\\n        typed_config:\\n          \'@type\': type.googleapis.com/udpa.type.v1.TypedStruct\\n          type_url: type.googleapis.com/envoy.extensions.filters.http.http_dubbo_transcoder.v3.HttpDubboTranscoder\\n  - applyTo: HTTP_ROUTE\\n    match:\\n      context: GATEWAY\\n      routeConfiguration:\\n        vhost:\\n          route:\\n            name: test\\n    patch:\\n      operation: MERGE\\n      value:\\n        route:\\n          upgrade_configs:\\n          - connect_config:\\n              allow_post: true\\n            upgrade_type: CONNECT\\n        typed_per_filter_config:\\n          envoy.filters.http.http_dubbo_transcoder:\\n            \'@type\': type.googleapis.com/udpa.type.v1.TypedStruct\\n            type_url: type.googleapis.com/envoy.extensions.filters.http.http_dubbo_transcoder.v3.HttpDubboTranscoder\\n            value:\\n              request_validation_options:\\n                reject_unknown_method: true\\n                reject_unknown_query_parameters: true\\n              services_mapping:\\n              - group: dev\\n                method_mapping:\\n                - name: sayName\\n                  parameter_mapping:\\n                  - extract_key: p\\n                    extract_key_spec: ALL_QUERY_PARAMETER\\n                    mapping_type: java.lang.String\\n                  passthrough_setting:\\n                    passthrough_all_headers: true\\n                  path_matcher:\\n                    match_http_method_spec: ALL_GET\\n                    match_pattern: /dubbo/hello\\n                name: com.alibaba.nacos.example.dubbo.service.DemoService\\n                version: 1.0.0\\n              url_unescape_spec: ALL_CHARACTERS_EXCEPT_RESERVED\\n```\\n\\n\u4e0a\u8ff0\u914d\u7f6e\u6bd4\u8f83\u590d\u6742\uff0c\u539f\u56e0\u662f\u4e3a\u4e86\u65b9\u4fbf Envoy \u6570\u636e\u9762\u7a0b\u5e8f\u903b\u8f91\u5904\u7406\u800c\u8bbe\u8ba1\u7684 Schema\u3002\u76ee\u524d Higress \u793e\u533a\u5df2\u7ecf\u5728\u8bbe\u8ba1\u66f4\u65b9\u4fbf Ingress \u914d\u7f6e\u4f7f\u7528\u7684 CRD\uff0c\u540e\u7eed\u4e5f\u4f1a\u5728 Higress \u63a7\u5236\u53f0\u4e0a\u63d0\u4f9b\u5bf9\u5e94\u7684\u914d\u7f6e\u529f\u80fd\u3002\\n\\n\\n## GA \u7248\u672c\u89c4\u5212\\n\\nHigress \u9884\u8ba1\u5c06\u57283\u6708\u5e95/4\u6708\u521d\u53d1\u5e03\u9996\u4e2a GA \u7248\u672c, \u8fd9\u4e2a\u7248\u672c\u7684\u4e3b\u8981\u89c4\u5212\u5982\u4e0b\uff1a\\n\\n1. \u5b9e\u73b0 HTTP to Dubbo \u534f\u8bae\u8f6c\u6362\u7684\u63a7\u5236\u9762\u914d\u7f6e\u7b80\u5316\\n2. Higress \u63a7\u5236\u53f0\u63d0\u4f9b Wasm \u63d2\u4ef6\u80fd\u529b\uff0c\u652f\u6301\u914d\u7f6e\u81ea\u5b9a\u4e49\u63d2\u4ef6\\n3. \u63a8\u51fa\u7b2c\u4e00\u7248 Higress Admin API\uff0c\u53ef\u4ee5\u88ab\u5176\u4ed6\u5e73\u53f0/\u5de5\u5177\u96c6\u6210\\n4. \u5168\u9762\u5b8c\u5584 Higress \u5b98\u7f51\u6587\u6863\uff0c\u8986\u76d6 Higress \u5168\u90e8\u529f\u80fd\u7684\u8be6\u7ec6\u8bf4\u660e\\n\\n\\n## Higress \u793e\u533a\\n\\n\u6b22\u8fce\u8ba4\u9886 Higress Issue \u4efb\u52a1\uff1ahttps://github.com/alibaba/higress/issues?q=is%3Aopen+is%3Aissue+label%3A%22help+wanted%22\\n\\n\u5b8c\u6210\u4e00\u5b9a\u6570\u91cf\u7684 Issues \u5c31\u53ef\u4ee5\u6210\u4e3a Higress Committer\uff0c\u4e5f\u6709\u673a\u4f1a\u83b7\u5f97\u5f00\u6e90\u793e\u533a\u7684\u793c\u7269\u548c\u8363\u8a89\ud83c\udfc6\\n\\n\u6b22\u8fce\u52a0\u5165 Higress \u793e\u533a\u7fa4\uff0c\u53ca\u65f6\u4e86\u89e3\u66f4\u591a Higress \u52a8\u5411\uff1a\\n\\n![](https://img.alicdn.com/imgextra/i4/O1CN01xutJV11aSGvdgBHpC_!!6000000003328-0-tps-720-405.jpg)"},{"id":"/nacos","metadata":{"permalink":"/zh-cn/blog/nacos","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/nacos.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/nacos.md","title":"Higress + Nacos \u5fae\u670d\u52a1\u7f51\u5173\u6700\u4f73\u5b9e\u8df5","description":"Higress\uff1aNacos\u7684\u6700\u4f73\u62cd\u6863","date":"2023-01-10T00:00:00.000Z","formattedDate":"2023\u5e741\u670810\u65e5","tags":[],"readingTime":12.81,"hasTruncateMarker":true,"authors":[{"name":"\u6f84\u6f6d"}],"frontMatter":{"title":"Higress + Nacos \u5fae\u670d\u52a1\u7f51\u5173\u6700\u4f73\u5b9e\u8df5","keywords":["higress","wasm"],"description":"Higress\uff1aNacos\u7684\u6700\u4f73\u62cd\u6863","author":"\u6f84\u6f6d","date":"2023-01-10T00:00:00.000Z","custom_edit_url":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/nacos.md"},"prevItem":{"title":"Higress 0.7.0 \u7248\u672c\u53d1\u5e03\uff1aGA \u8fdb\u5165\u5012\u8ba1\u65f6","permalink":"/zh-cn/blog/release-070"},"nextItem":{"title":"30\u884c\u4ee3\u7801\u5199\u4e00\u4e2aWasm Go\u63d2\u4ef6","permalink":"/zh-cn/blog/30-line-wasm"}},"content":"## \u524d\u8a00\\n\u5728\u53bb\u5e7411\u6708\u7684\u4e91\u6816\u5927\u4f1a\u4e0a\uff0c\u6211\u4eec\u5f00\u6e90\u4e86\u4e91\u539f\u751f\u7f51\u5173 Higress\uff0c\u65f6\u9694\u6570\u6708\uff0cHigress \u7684 Github \u9879\u76ee([https://github.com/alibaba/higress](https://github.com/alibaba/higress))\u5df2\u7ecf\u6536\u83b7\u4e86\u8fd1 1k+ star\uff0c\u4ee5\u53ca\u5927\u91cf\u793e\u533a\u5c0f\u4f19\u4f34\u7684\u5173\u6ce8\u3002\\n\x3c!--truncate--\x3e\\n\u5728\u793e\u533a\u7684\u4ea4\u6d41\u4e2d\u6211\u4eec\u53d1\u73b0\u6709\u4e0d\u5c11\u5fae\u670d\u52a1\u5f00\u53d1\u8005\u5728\u4f7f\u7528\u5982 Spring Cloud Gateway/Zuul \u7b49\u5fae\u670d\u52a1\u7f51\u5173\u5bf9\u63a5 Nacos \u6ce8\u518c\u4e2d\u5fc3\u5b9e\u73b0\u5fae\u670d\u52a1\u7684\u8def\u7531\uff0c\u5e76\u4e14\u5e0c\u671b\u4e86\u89e3\u8fc1\u79fb\u5230 Higress \u7f51\u5173\u80fd\u5e26\u6765\u54ea\u4e9b\u597d\u5904\u3002\\n\u672c\u6587\u5c06\u4ecb\u7ecd Higress \u7ec4\u5408 Nacos \u4f5c\u4e3a\u5fae\u670d\u52a1\u7f51\u5173\u80fd\u529b\uff0c\u5e76\u4ecb\u7ecd\u5fae\u670d\u52a1\u7f51\u5173\u53d1\u5c55\u7684\u4e24\u4e2a\u8d8b\u52bf\uff0c\u4e3a\u7f51\u5173\u7684\u9009\u578b\u6307\u660e\u9053\u8def\uff1a\\n\\n\\n\\n- \u8d8b\u52bf\u4e00\uff1a\u7edf\u4e00 API \u6807\u51c6\uff0c\u5411\u4e91\u539f\u751f\u5fae\u670d\u52a1\u67b6\u6784\u6f14\u8fdb\\n- \u8d8b\u52bf\u4e8c\uff1a\u5408\u5e76\u5b89\u5168&\u6d41\u91cf\u7f51\u5173\uff0c\u5411 DevSecOps \u6f14\u8fdb\\n## Higress\uff1aNacos\u7684\u6700\u4f73\u62cd\u6863\\n![image.png](https://img.alicdn.com/imgextra/i2/O1CN01Ww9gDw1PwXJUlwwRy_!!6000000001905-2-tps-1200-475.png)\\nHigress \u548c Nacos \u5176\u5b9e\u662f\u5e08\u51fa\u540c\u95e8\u2014\u2014\u963f\u91cc\u4e2d\u95f4\u4ef6\u56e2\u961f\u3002\u5728 Higress \u652f\u6491\u963f\u91cc\u5185\u90e8\u4e1a\u52a1\u7684\u9636\u6bb5\uff0cHigress \u5c31\u5df2\u7ecf\u642d\u914d Nacos \u4f5c\u4e3a\u5fae\u670d\u52a1\u7f51\u5173\u4f7f\u7528\uff0c\u51ed\u501f\u9ad8\u6027\u80fd\u652f\u6491\u4e86\u53cc\u5341\u4e00\u7684\u6d2a\u5cf0\u6d41\u91cf\uff1b\u5230\u4e86\u4e91\u4ea7\u54c1\u5546\u4e1a\u5316\u9636\u6bb5\uff0cHigress \u548c Nacos \u7ee7\u7eed\u57fa\u4e8e\u963f\u91cc\u4e91 MSE\uff08Microservices Engine\uff09\u4ea7\u54c1\uff0c\u7d27\u5bc6\u534f\u4f5c\u6f14\u8fdb\u4ea7\u54c1\u529f\u80fd\uff1bHigress \u5f00\u6e90\u4e4b\u540e\uff0c\u5982\u679c\u60f3\u8981\u81ea\u5efa\u5fae\u670d\u52a1\u7f51\u5173\uff0c\u9009\u62e9 Higress \u914d\u5408 Nacos \u4f7f\u7528\uff0c\u5177\u5907\u4ee5\u4e0b\u4f18\u52bf\uff1a\\n\\n1. \u5bf9\u6bd4 Spring Cloud Gateway/Zuul \u7b49\u4f20\u7edf Java \u5fae\u670d\u52a1\u7f51\u5173\u6027\u80fd\u9ad8\u51fa 2-4 \u500d\uff0c\u53ef\u4ee5\u663e\u8457\u964d\u4f4e\u8d44\u6e90\u6210\u672c\\n2. \u4f5c\u4e3a\u4e91\u539f\u751f\u7f51\u5173\uff0c\u5b9e\u73b0\u4e86 Ingress/Gateway API \u6807\u51c6\uff0c\u517c\u5bb9 Nginx Ingress \u5927\u90e8\u5206\u6ce8\u89e3\uff0c\u652f\u6301\u4e1a\u52a1\u6e10\u8fdb\u5f0f\u5411\u57fa\u4e8e K8s \u7684\u5fae\u670d\u52a1\u67b6\u6784\u6f14\u8fdb\\n3. \u4e0e Dubbo/OpenSergo/Sentinel \u7b49\u5f00\u6e90\u5fae\u670d\u52a1\u751f\u6001\u6df1\u5ea6\u6574\u5408\uff0c\u63d0\u4f9b\u6700\u4f73\u5b9e\u8df5\\n\\n\u8fd9\u91cc\u9ed8\u8ba4\u5df2\u7ecf\u5b89\u88c5\u597d Higress\uff0c\u642d\u914d Nacos \u4f7f\u7528\u7684\u5177\u4f53\u65b9\u5f0f\u5982\u4e0b\uff1a\\n### \u914d\u7f6e\u670d\u52a1\u6765\u6e90\\n```yaml\\napiVersion: networking.higress.io/v1\\nkind: McpBridge\\nmetadata:\\n  name: default\\n  namespace: higress-system\\nspec:\\n  registries:\\n    # \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3a \u201cproduction\u201d \u7684\u670d\u52a1\u6765\u6e90\\n  - name: production\\n    # \u6ce8\u518c\u4e2d\u5fc3\u7c7b\u578b\u662f Nacos 2.x\uff0c\u652f\u6301 gRPC \u534f\u8bae\\n    type: nacos2  \\n    # \u6ce8\u518c\u4e2d\u5fc3\u7684\u8bbf\u95ee\u5730\u5740\uff0c\u53ef\u4ee5\u662f\u57df\u540d\u6216\u8005IP\\n    domain: 192.xxx.xx.32\\n    # \u6ce8\u518c\u4e2d\u5fc3\u7684\u8bbf\u95ee\u7aef\u53e3\uff0cNacos \u9ed8\u8ba4\u90fd\u662f 8848\\n    port: 8848\\n    # Nacos \u547d\u540d\u7a7a\u95f4 ID\\n    nacosNamespaceId: d8ac64f3-xxxx-xxxx-xxxx-47a814ecf358    \\n    # Nacos \u670d\u52a1\u5206\u7ec4\\n    nacosGroups:\\n    - DEFAULT_GROUP\\n    # \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3a \u201cuat\u201d \u7684\u670d\u52a1\u6765\u6e90\\n  - name: uat\\n    # \u6ce8\u518c\u4e2d\u5fc3\u7c7b\u578b\u662f Nacos 1.x\uff0c\u53ea\u652f\u6301 HTTP \u534f\u8bae\\n    type: nacos\\n    # \u6ce8\u518c\u4e2d\u5fc3\u7684\u8bbf\u95ee\u5730\u5740\uff0c\u53ef\u4ee5\u662f\u57df\u540d\u6216\u8005IP\\n    domain: 192.xxx.xx.31\\n    # \u6ce8\u518c\u4e2d\u5fc3\u7684\u8bbf\u95ee\u7aef\u53e3\uff0cNacos \u9ed8\u8ba4\u90fd\u662f 8848\\n    port: 8848\\n    # Nacos \u547d\u540d\u7a7a\u95f4 ID\\n    nacosNamespaceId: 98ac6df3-xxxx-xxxx-xxxx-ab98115dfde4    \\n    # Nacos \u670d\u52a1\u5206\u7ec4\\n    nacosGroups:\\n    - DEFAULT_GROUP    \\n```\\n\u6211\u4eec\u901a\u8fc7 McpBridge \u8d44\u6e90\u914d\u7f6e\u4e86\u4e24\u4e2a\u670d\u52a1\u6765\u6e90\uff0c\u5206\u522b\u53d6\u540d \u201cproduction\u201d\u548c\u201cuat\u201d\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f Higress \u5bf9\u63a5 Nacos \u540c\u65f6\u652f\u6301 HTTP \u548c gRPC \u4e24\u79cd\u534f\u8bae\uff0c\u5efa\u8bae\u5c06 Nacos \u5347\u7ea7\u5230 2.x \u7248\u672c\uff0c\u8fd9\u6837\u53ef\u4ee5\u5728\u4e0a\u8ff0\u914d\u7f6e\u7684 type \u4e2d\u6307\u5b9a \u201cnacos2\u201d \u4f7f\u7528 gRPC \u534f\u8bae\uff0c\u4ece\u800c\u66f4\u5feb\u901f\u5730\u611f\u77e5\u5230\u670d\u52a1\u53d8\u5316\uff0c\u5e76\u6d88\u8017\u66f4\u5c11\u7684 Nacos \u670d\u52a1\u7aef\u8d44\u6e90\u3002\\n\u57fa\u4e8e McpBridge \u4e2d\u7684 registries \u6570\u7ec4\u914d\u7f6e\uff0cHigress \u53ef\u4ee5\u8f7b\u677e\u5bf9\u63a5\u591a\u4e2a\u4e14\u4e0d\u540c\u7c7b\u578b\u7684\u670d\u52a1\u6765\u6e90\uff08Nacos/Zookeeper/Eureka/Consul/...\uff09\uff0c\u8fd9\u91cc\u5bf9\u4e8e Nacos \u7c7b\u578b\u7684\u670d\u52a1\u6765\u6e90\uff0c\u652f\u6301\u914d\u7f6e\u591a\u4e2a\u4e0d\u540c\u547d\u540d\u7a7a\u95f4\uff0c\u4ece\u800c\u5b9e\u73b0\u4e0d\u540c\u547d\u540d\u7a7a\u95f4\u7684\u5fae\u670d\u52a1\u53ef\u4ee5\u5171\u7528\u4e00\u4e2a\u7f51\u5173\uff0c\u964d\u4f4e\u81ea\u5efa\u5fae\u670d\u52a1\u7f51\u5173\u7684\u8d44\u6e90\u6210\u672c\u5f00\u9500\u3002\\n### \u914d\u7f6e Ingress \\n```yaml\\napiVersion: networking.k8s.io/v1\\nkind: Ingress\\nmetadata:\\n  annotations:\\n    higress.io/destination: service-provider.DEFAULT-GROUP.d8ac64f3-xxxx-xxxx-xxxx-47a814ecf358.nacos\\n  name: demo\\n  namespace: default\\nspec:\\n  rules:\\n  - http:\\n      paths:\\n      - backend:\\n          resource:\\n            apiGroup: networking.higress.io\\n            kind: McpBridge\\n            name: default\\n        path: /\\n        pathType: Prefix\\n```\\n\u548c\u5e38\u89c1\u7684 Ingress \u5728 backend \u4e2d\u5b9a\u4e49 service \u4e0d\u540c\uff0c\u8fd9\u91cc\u57fa\u4e8e Ingress \u7684 resource backend \u5c06\u4e0a\u9762\u5b9a\u4e49\u670d\u52a1\u6765\u6e90\u7684 McpBridge \u8fdb\u884c\u5173\u8054\u3002\u5e76\u901a\u8fc7\u6ce8\u89e3`higress.io/destination`\u6307\u5b9a\u8def\u7531\u6700\u7ec8\u8981\u8f6c\u53d1\u5230\u7684\u76ee\u6807\u670d\u52a1\u3002\u5bf9\u4e8e Nacos \u6765\u6e90\u7684\u670d\u52a1\uff0c\u8fd9\u91cc\u7684\u76ee\u6807\u670d\u52a1\u683c\u5f0f\u4e3a\uff1a\u201c\u670d\u52a1\u540d\u79f0.\u670d\u52a1\u5206\u7ec4.\u547d\u540d\u7a7a\u95f4ID.nacos\u201d\uff0c\u6ce8\u610f\u8fd9\u91cc\u9700\u8981\u9075\u5faa DNS \u57df\u540d\u683c\u5f0f\uff0c\u56e0\u6b64\u670d\u52a1\u5206\u7ec4\u4e2d\u7684\u4e0b\u5212\u7ebf\'_\'\u88ab\u8f6c\u6362\u6210\u4e86\u6a2a\u6760\'-\'\u3002\\n### \u4e30\u5bcc\u7684\u5fae\u670d\u52a1\u7f51\u5173\u80fd\u529b\\nHigress \u5728\u5fae\u670d\u52a1\u53d1\u73b0\u7684\u57fa\u7840\u4e0a\uff0c\u63d0\u4f9b\u4e86\u591a\u79cd\u5b9e\u7528\u7684\u5fae\u670d\u52a1\u7f51\u5173\u80fd\u529b\uff0c\u8fd9\u91cc\u4ee5\u201c\u7070\u5ea6\u53d1\u5e03\u201d\u548c\u201c\u81ea\u5b9a\u4e49\u6269\u5c55\u201d\u8fdb\u884c\u4e3e\u4f8b\uff0c\u66f4\u591a\u80fd\u529b\u53ef\u4ee5\u70b9\u51fb\u539f\u6587\u53c2\u8003 Higress \u5b98\u7f51\u6587\u6863\u8fdb\u884c\u4e86\u89e3\u3002\\n#### \u7070\u5ea6\u53d1\u5e03\\nHigress \u5b8c\u5168\u517c\u5bb9\u4e86 Nginx Ingress \u7684\u91d1\u4e1d\u96c0\uff08Canary\uff09\u76f8\u5173\u6ce8\u89e3\uff0c\u5982\u4e0b\u6240\u793a\uff0c\u53ef\u4ee5\u5c06\u5e26\u6709HTTP Header\u4e3ax-user-id: 100\u7684\u8bf7\u6c42\u6d41\u91cf\u8def\u7531\u5230\u7070\u5ea6\u670d\u52a1\u4e2d\u3002\\n```yaml\\napiVersion: networking.k8s.io/v1\\nkind: Ingress\\nmetadata:\\n  annotations:\\n    higress.io/destination: service-provider.DEFAULT-GROUP.98ac6df3-xxxx-xxxx-xxxx-ab98115dfde4.nacos\\n    nginx.ingress.kubernetes.io/canary: \'true\'\\n    nginx.ingress.kubernetes.io/canary-by-header: x-user-id\\n    nginx.ingress.kubernetes.io/canary-by-header-value: \'100\'\\n  name: demo-uat\\n  namespace: default\\nspec:\\n  rules:\\n  - http:\\n      paths:\\n      - backend:\\n          resource:\\n            apiGroup: networking.higress.io\\n            kind: McpBridge\\n            name: default\\n        path: /\\n        pathType: Prefix\\n```\\n\u60a8\u8fd8\u53ef\u4ee5\u57fa\u4e8e OpenKruise Rollout \u8ba9\u7070\u5ea6\u53d1\u5e03\u548c\u670d\u52a1\u90e8\u7f72\u8fc7\u7a0b\u8054\u52a8\uff0c\u4ece\u800c\u5b9e\u73b0\u6e10\u8fdb\u5f0f\u4ea4\u4ed8\uff0c\u5177\u4f53\u53ef\u4ee5\u53c2\u8003\u8fd9\u7bc7\u6587\u7ae0[\u300aHigress & Kruise Rollout: \u6e10\u8fdb\u5f0f\u4ea4\u4ed8\u4e3a\u5e94\u7528\u53d1\u5e03\u4fdd\u9a7e\u62a4\u822a\u300b](https://mp.weixin.qq.com/s/vqwAUITNq9_twYHWX_5ZDg)\\n#### \u81ea\u5b9a\u4e49\u6269\u5c55\\n\u4f5c\u4e3a\u5fae\u670d\u52a1\u7f51\u5173\uff0c\u9700\u8981\u5728\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\u627f\u62c5\u90e8\u5206\u901a\u7528\u903b\u8f91\u7684\u5904\u7406\uff0c\u4f8b\u5982\u8ba4\u8bc1\u9274\u6743\uff0c\u5b89\u5168\u9632\u62a4\u7b49\u3002\u901a\u7528\u7684\u903b\u8f91\u65e0\u6cd5\u6ee1\u8db3\u591a\u6837\u6027\u7684\u4e1a\u52a1\u573a\u666f\uff0cHigress \u53ef\u4ee5\u652f\u6301\u5f00\u53d1\u8005\u6dfb\u52a0\u81ea\u5b9a\u4e49\u5904\u7406\u903b\u8f91\u3002\u4e0e Spring Cloud Gateway \u7b49\u4f20\u7edf\u5fae\u670d\u52a1\u7f51\u5173\u9700\u8981\u5f00\u53d1\u8005\u81ea\u5df1\u5728 Gateway \u4ee3\u7801\u4e2d\u52a0 Filter \u4e0d\u540c\uff0cHigress \u652f\u6301\u5f00\u53d1\u8005\u4f7f\u7528\u591a\u79cd\u8bed\u8a00\u7f16\u5199 Wasm \u63d2\u4ef6\uff0c\u5e76\u52a8\u6001\u52a0\u8f7d\u751f\u6548\uff0c\u63d2\u4ef6\u751f\u6548\u8fc7\u7a0b\u65e0\u9700\u91cd\u542f\u7f51\u5173\uff0c\u53d8\u66f4\u63d2\u4ef6\u903b\u8f91\u5bf9\u6d41\u91cf\u5b8c\u5168\u65e0\u635f\u3002\\n\u4e0b\u4f8b\u662f\u4e00\u4e2a\u5c4f\u853d\u7279\u5b9a\u8bf7\u6c42\u7684 Wasm \u63d2\u4ef6\uff0c\u5f53\u8bf7\u6c42 url \u4e2d\u51fa\u73b0 \u201cswagger.html\u201d \u65f6\u5c06\u88ab\u76f4\u63a5\u62d2\u7edd\u8bbf\u95ee\uff0c\u63d2\u4ef6\u5b9e\u73b0\u4ee3\u7801\u53c2\u8003\uff1a[https://github.com/alibaba/higress/tree/main/plugins/wasm-go/extensions/request-block](https://github.com/alibaba/higress/tree/main/plugins/wasm-go/extensions/request-block)\\n```yaml\\napiVersion: extensions.higress.io/v1alpha1\\nkind: WasmPlugin\\nmetadata:\\n  name: request-block\\n  namespace: higress-system\\nspec:\\n  defaultConfig:\\n    block_urls:\\n    - \\"swagger.html\\"\\n  url: oci://higress-registry.cn-hangzhou.cr.aliyuncs.com/plugins/demo:1.0.0\\n```\\nWasm \u63d2\u4ef6\u7684\u5f00\u53d1&\u7f16\u8bd1&\u955c\u50cf\u63a8\u9001\u65b9\u5f0f\u53ef\u4ee5\u53c2\u8003\u8fd9\u7bc7\u6587\u7ae0[\u300aHigress \u5b9e\u6218\uff1a30 \u884c\u4ee3\u7801\u5199\u4e00\u4e2a Wasm Go\u63d2\u4ef6\u300b](https://mp.weixin.qq.com/s/eoPlaOgRm7u5wJAxhbVGGg)\\n## \u5fae\u670d\u52a1\u7f51\u5173\u53d1\u5c55\u8d8b\u52bf\\n### \u8d8b\u52bf\u4e00\uff1a\u7edf\u4e00 API \u6807\u51c6\uff0c\u5411\u4e91\u539f\u751f\u5fae\u670d\u52a1\u67b6\u6784\u6f14\u8fdb\\n\u57fa\u4e8e\u4e00\u5957 API \u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u5b9e\u73b0\uff0c\u65e2\u8ba9\u7528\u6237\u4e0d\u88ab\u5177\u4f53\u5b9e\u73b0\u9501\u5b9a\uff0c\u53c8\u6865\u63a5\u4e86\u6280\u672f\u6f14\u8fdb\u7684\u9e3f\u6c9f\u3002API \u53ef\u4ee5\u8bf4\u662f\u6574\u4e2a\u4e91\u539f\u751f\u67b6\u6784\u7684\u57fa\u77f3\uff0c\u6216\u8bb8\u6709\u4e00\u5929 K8s \u4f1a\u6d88\u5931\uff0c\u4f46\u662f\u9762\u5411\u62bd\u8c61\u7684 API \u6807\u51c6\u5b9a\u4f1a\u957f\u5b58\u3002\u5728\u6d41\u91cf\u7f51\u5173\u9886\u57df\uff0cIngress API \u5df2\u7ecf\u6210\u4e3a\u6807\u51c6\u3002\u800c\u5bf9\u4e8e\u5fae\u670d\u52a1\u7f51\u5173\u7b49\u66f4\u590d\u6742\u7684\u4f7f\u7528\u573a\u666f\uff0cIngress \u53d7\u9650\u4e8e\u5176\u7b80\u5355\u7684\u534f\u8bae\u5b57\u6bb5\uff0c\u9700\u8981\u901a\u8fc7 Ingress \u6ce8\u89e3\u7b49\u65b9\u5f0f\u8fdb\u884c\u80fd\u529b\u6269\u5c55\uff0c\u96be\u4ee5\u88ab\u6807\u51c6\u5316\u3002\u56e0\u6b64\u8bf8\u5982 Contour\u3001Emissary\u3001Kong\u3001APISIX \u7b49\u90fd\u5b9a\u4e49\u4e86\u81ea\u5df1\u7684 HTTP \u8def\u7531\u7b49 CRD\uff0c\u7f51\u5173\u7684 API \u5b9a\u4e49\u5f00\u59cb\u5448\u73b0\u788e\u7247\u5316\u3002\\n\u8fd9\u4e00\u80cc\u666f\u4e4b\u4e0b\uff0cGateway API \u5e94\u8fd0\u800c\u751f\uff0c\u5e76\u4e14\u5728\u8fc7\u53bb\u7684\u4e00\u5e74\u91cc\u4ece alpha \u6f14\u8fdb\u5230\u4e86 beta \u9636\u6bb5\u3002\u867d\u7136\u76ee\u524d Gateway API \u8fd8\u672a\u5b9a\u7a3f\uff0c\u534f\u8bae\u4ecd\u4f1a\u53d1\u751f\u53d8\u52a8\uff0c\u4e0d\u5efa\u8bae\u7528\u4e8e\u751f\u4ea7\uff0c\u4f46 API \u7edf\u4e00\u8d8b\u52bf\u5df2\u7ecf\u4e0d\u53ef\u963b\u6321\uff0c\u53ea\u662f\u65f6\u95f4\u7684\u95ee\u9898\u3002\u4e0b\u56fe\u662f Gateway API \u7684\u4e00\u4e2a\u7528\u4f8b\u573a\u666f\uff0c\u4e0d\u540c\u4e8e Ingress API\uff0c\u5c06\u96c6\u7fa4\u8fd0\u7ef4\u548c\u4e1a\u52a1\u8fd0\u7ef4\u7684\u804c\u8d23\u8fdb\u884c\u4e86\u5212\u5206\uff0c\u8fd9\u6837\u4e1a\u52a1\u5f00\u53d1\u4eba\u5458\u4e0d\u518d\u9700\u8981\u5173\u5fc3\u7f51\u7ad9\u8bc1\u4e66\u7b49\u96c6\u7fa4\u7ea7\u7684\u7ec6\u8282\uff0c\u53ea\u4e13\u6ce8\u4e8e\u4e1a\u52a1\u672c\u8eab\u7684 DevOps\uff0c\u96c6\u7fa4\u8fd0\u7ef4\u4efb\u52a1\u53ef\u4ee5\u4ea4\u7ed9 SRE \u4eba\u5458\u8fdb\u884c\u7edf\u4e00\u5904\u7406\u3002\\n![image.png](https://img.alicdn.com/imgextra/i3/O1CN01jDsDrv1zaqj82YkYP_!!6000000006731-2-tps-2735-1519.png)\\nHigress \u76ee\u524d\u91c7\u7528 Ingress \u6ce8\u89e3\u7684\u80fd\u529b\u6765\u5b9e\u73b0\u80fd\u529b\u6269\u5c55\uff0c\u5e76\u517c\u5bb9\u4e86 Nginx Ingress \u5927\u90e8\u5206\u5e38\u7528\u6ce8\u89e3\uff0c\u4e14\u5177\u5907\u5e73\u6ed1\u8fc1\u79fb\u5230 Gateway API \u7684\u80fd\u529b\u3002\\nHigress \u4e3a\u4f20\u7edf\u5fae\u670d\u52a1\u67b6\u6784\uff0c\u63d0\u4f9b\u4e86\u6e10\u8fdb\u5f0f\u7684\u65b9\u5f0f\uff0c\u5411\u57fa\u4e8e K8s \u7684\u4e91\u539f\u751f\u5fae\u670d\u52a1\u67b6\u6784\u6f14\u8fdb\uff1a\u53ef\u4ee5\u901a\u8fc7 Nacos \u53d1\u73b0\u90e8\u7f72\u5728 K8s \u4e4b\u5916\u7684\u670d\u52a1\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u7f51\u5173\u540e\u7aef\u5fae\u670d\u52a1\u53ef\u4ee5\u548c K8s \u89e3\u8026\uff0c\u4e1a\u52a1\u56e2\u961f\u53ef\u4ee5\u5c06\u5fae\u670d\u52a1\u9010\u4e2a\u8fc1\u79fb\u81f3 K8s\uff0c\u800c\u4e0d\u7528\u62c5\u5fc3\u7f51\u5173\u5c42\u7684\u6d41\u91cf\u5f71\u54cd\u3002\\n\u4ece\u4f20\u7edf\u5fae\u670d\u52a1\u7f51\u5173\u8fc1\u79fb\u5230 Higress\uff0c\u518d\u6e10\u8fdb\u5f0f\u5b8c\u6210\u6574\u4e2a\u5fae\u670d\u52a1\u67b6\u6784\u7684\u4e91\u539f\u751f\u5316\uff0c\u662f\u4e00\u4e2a\u660e\u667a\u7684\u9009\u62e9\u3002\\n### \u8d8b\u52bf\u4e8c\uff1a\u5408\u5e76\u5b89\u5168&\u6d41\u91cf\u7f51\u5173\uff0c\u5411 DevSecOps \u6f14\u8fdb\\nHigress \u63d0\u51fa\u4e86\u5c06\u5b89\u5168\u3001\u6d41\u91cf\u3001\u5fae\u670d\u52a1\u7f51\u5173\u4e09\u5408\u4e00\u7684\u6982\u5ff5\uff0c\u9996\u5148\u6765\u770b\u4e00\u4e2a\u5178\u578b\u7684\u591a\u5c42\u7f51\u5173\u67b6\u6784\uff1a\\n![](https://img.alicdn.com/imgextra/i2/O1CN0178hdNj25QDDnqmISC_!!6000000007520-2-tps-1318-198.png)\\n\u5728\u8fd9\u4e2a\u67b6\u6784\u4e2d\uff0c\u7528 WAF \u7f51\u5173\u5b9e\u73b0\u5b89\u5168\u80fd\u529b\uff0cIngress \u7f51\u5173\u5b9e\u73b0\u96c6\u7fa4\u5165\u53e3\u7f51\u5173\u80fd\u529b\uff08\u975e K8s \u573a\u666f\u6216\u4f1a\u90e8\u7f72\u4e00\u5c42 Nginx\uff09\uff0cSCG\uff08Spring Cloud Gateway\uff09 \u5b9e\u73b0\u5fae\u670d\u52a1\u7f51\u5173\u80fd\u529b\u3002\u8fd9\u6837\u7684\u67b6\u6784\u4e0b\uff0c\u9700\u8981\u5bf9\u6bcf\u4e00\u5c42\u7f51\u5173\u90fd\u8fdb\u884c\u5bb9\u91cf\u8bc4\u4f30\uff0c\u6bcf\u4e00\u5c42\u7f51\u5173\u90fd\u662f\u6f5c\u5728\u7684\u74f6\u9888\u70b9\uff0c\u90fd\u53ef\u80fd\u9700\u8981\u8fdb\u884c\u6269\u5bb9\u3002\u8fd9\u6837\u9020\u6210\u7684\u8d44\u6e90\u6210\u672c\u548c\u8fd0\u7ef4\u4eba\u529b\u6210\u672c\u90fd\u662f\u5de8\u5927\u7684\u3002\u5e76\u4e14\u6bcf\u591a\u4e00\u5c42\u7f51\u5173\uff0c\u5c31\u591a\u4e00\u5c42\u53ef\u7528\u6027\u98ce\u9669\u3002\u4e00\u65e6\u51fa\u73b0\u53ef\u7528\u6027\u95ee\u9898\uff0c\u591a\u5c42\u7f51\u5173\u4f1a\u5bfc\u81f4\u95ee\u9898\u5b9a\u4f4d\u590d\u6742\u5ea6\u663e\u8457\u4e0a\u5347\uff0c\u5bf9\u5e94\u7684\u5e73\u5747\u6545\u969c\u6062\u590d\u65f6\u95f4\uff08MTTR\uff09\u5c06\u5927\u5e45\u589e\u52a0\u3002\\n![](https://img.alicdn.com/imgextra/i1/O1CN01BnAVqH1SCE73I5l85_!!6000000002210-2-tps-1318-198.png)\\n\u91c7\u7528\u4e09\u5408\u4e00\u7684\u67b6\u6784\u4e2d\uff0c\u53ef\u4ee5\u663e\u8457\u964d\u4f4e\u6210\u672c\uff0c\u5e76\u63d0\u9ad8\u7cfb\u7edf\u6574\u4f53\u53ef\u7528\u6027\u3002\u540c\u65f6\u8fd9\u4e5f\u7b26\u5408 DevSecOps \u7684\u5fae\u670d\u52a1\u6f14\u8fdb\u8d8b\u52bf\uff0c\u5fae\u670d\u52a1\u5f00\u53d1\u8005\u53ef\u4ee5\u66f4\u591a\u5730\u4ece\u4e1a\u52a1\u63a5\u53e3\u89c6\u89d2\u5173\u6ce8\u5b89\u5168\u6027\uff0c\u800c\u4e0d\u662f\u91c7\u7528\u6240\u6709\u8def\u7531\u4e00\u5200\u5207\u7684 WAF \u9632\u62a4\u6a21\u5f0f\u3002\\n\u6280\u672f\u67b6\u6784\u6f14\u8fdb\u7684\u80cc\u540e\u662f\u7ec4\u7ec7\u67b6\u6784\u6f14\u8fdb\uff0c\u8fd9\u4e5f\u662f\u5fae\u670d\u52a1 DevOps \u4e00\u76f4\u5728\u5f3a\u8c03\u7684\uff0c\u8981\u56f4\u7ed5\u5f00\u53d1\u8005\u4e3a\u6838\u5fc3\uff0c\u4ece\u800c\u63d0\u5347\u5fae\u670d\u52a1\u5f00\u53d1\u6548\u7387\u3002\u5411 DevSecOps \u6f14\u8fdb\u5e76\u6ca1\u6709\u6377\u5f84\uff0c\u4f9d\u7136\u9700\u8981\u5f00\u53d1\u89d2\u8272\u548c\u8fd0\u7ef4\u89d2\u8272\u4e4b\u95f4\u7684\u53cc\u5411\u5954\u8d74\uff0c\u6253\u7834\u4f20\u7edf\u5f00\u53d1\u4e0e\u8fd0\u7ef4\u4e4b\u95f4\u7684\u58c1\u5792\uff0c\u5f62\u6210\u4ece\u5f00\u53d1\u3001\u90e8\u7f72\u3001\u5b89\u5168\u8fd0\u8425\u8fd9\u6837\u4e00\u4e2a\u5168\u529f\u80fd\u5316\u7684\u654f\u6377\u56e2\u961f\u3002\\n\u901a\u8fc7 Higress \u5c06\u7f51\u5173\u5408\u5e76\u4f5c\u4e3a\u5411 DevSecOps \u6f14\u8fdb\u7684\u6293\u624b\uff0c\u662f\u4e00\u4e2a\u660e\u667a\u7684\u9009\u62e9\u3002\\n## \u53c2\u4e0e Higress \u793e\u533a\\nHigress \u5f00\u6e90\u8d21\u732e\u5c0f\u7ec4\u6b63\u5728\u706b\u70ed\u62db\u52df\u8d21\u732e\u8005\u3002\u5982\u679c\u60a8\u6709\u65f6\u95f4\uff0c\u6709\u70ed\u60c5\uff0c\u6709\u610f\u613f\uff0c\u6b22\u8fce\u8054\u7cfb\u793e\u533a\u52a0\u5165\u5f00\u6e90\u8d21\u732e\u5c0f\u7ec4\uff0c\u4e00\u8d77\u5171\u540c\u5b8c\u5584 Higress\uff0c\u4e00\u8d77\u4e3b\u5bfc\u4e0b\u4e00\u4ee3\u4e91\u539f\u751f\u7f51\u5173\u7684\u8bbe\u8ba1\u548c\u5b9e\u73b0\u3002\\n\u793e\u533a\u5b98\u7f51\uff08\u70b9\u51fb\u201c\u9605\u8bfb\u539f\u6587\u201d\u8df3\u8f6c\uff09: [https://higress.io](https://higress.io)\\n\u793e\u533a\u5f00\u53d1\u8005\u7fa4\uff1a\\n![image.png](https://img.alicdn.com/imgextra/i1/O1CN01Zc7yGt1p0zYq3OCwj_!!6000000005299-2-tps-979-1280.png)\\n\u793e\u533a\u4ea4\u6d41\u7fa4\uff1a\\n![higress-comm.png](https://img.alicdn.com/imgextra/i2/O1CN01Ebh7P021yKGBaP35B_!!6000000007053-2-tps-720-405.png)"},{"id":"/30-line-wasm","metadata":{"permalink":"/zh-cn/blog/30-line-wasm","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/30-line-wasm.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/30-line-wasm.md","title":"30\u884c\u4ee3\u7801\u5199\u4e00\u4e2aWasm Go\u63d2\u4ef6","description":"\u5bf9\u300aHigress \u5f00\u6e90\u80cc\u540e\u7684\u53d1\u5c55\u5386\u7a0b\u548c\u4e0a\u624b Demo \u6f14\u793a\u300b\u76f4\u64ad\u6f14\u793a demo \u7684\u8be6\u7ec6\u8bf4\u660e","date":"2022-11-22T00:00:00.000Z","formattedDate":"2022\u5e7411\u670822\u65e5","tags":[],"readingTime":13.055,"hasTruncateMarker":true,"authors":[{"name":"\u6f84\u6f6d"}],"frontMatter":{"title":"30\u884c\u4ee3\u7801\u5199\u4e00\u4e2aWasm Go\u63d2\u4ef6","keywords":["higress","wasm"],"description":"\u5bf9\u300aHigress \u5f00\u6e90\u80cc\u540e\u7684\u53d1\u5c55\u5386\u7a0b\u548c\u4e0a\u624b Demo \u6f14\u793a\u300b\u76f4\u64ad\u6f14\u793a demo \u7684\u8be6\u7ec6\u8bf4\u660e","author":"\u6f84\u6f6d","date":"2022-11-22T00:00:00.000Z","custom_edit_url":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/30-line-wasm.md"},"prevItem":{"title":"Higress + Nacos \u5fae\u670d\u52a1\u7f51\u5173\u6700\u4f73\u5b9e\u8df5","permalink":"/zh-cn/blog/nacos"},"nextItem":{"title":"\u6b22\u8fce\u62a5\u540dHigress\u9996\u6b21\u7ebf\u4e0bMeetup","permalink":"/zh-cn/blog/first-meetup"}},"content":"## \u524d\u8a00\\n\u572811\u670815\u53f7\u7684\u76f4\u64ad \u300aHigress \u5f00\u6e90\u80cc\u540e\u7684\u53d1\u5c55\u5386\u7a0b\u548c\u4e0a\u624b Demo \u6f14\u793a\u300b\u4e2d\uff0c\u4e3a\u5927\u5bb6\u6f14\u793a\u4e86 Higress \u7684 Wasm \u63d2\u4ef6\u5982\u4f55\u9762\u5411 Ingress \u8d44\u6e90\u8fdb\u884c\u914d\u7f6e\u751f\u6548\uff0c\u672c\u6587\u5bf9\u5f53\u5929\u7684 Demo \u8fdb\u884c\u4e00\u4e2a\u56de\u987e\uff0c\u5e76\u8bf4\u660e\u80cc\u540e\u7684\u539f\u7406\u673a\u5236\u3002\\n\x3c!--truncate--\x3e\\n\u672c\u6587\u4e2d Demo \u8fd0\u884c\u7684\u524d\u63d0\uff0c\u9700\u8981\u5728 K8s \u96c6\u7fa4\u4e2d\u5b89\u88c5\u4e86 Higress\uff0c\u5e76\u751f\u6548\u4e86\u4e0b\u9762\u8fd9\u4efd quickstart \u914d\u7f6e\uff1a\\n[https://higress.io/samples/quickstart.yaml](https://higress.io/samples/quickstart.yaml)\\n\u8fd9\u4e2a Demo \u8981\u5b9e\u73b0\u7684\u529f\u80fd\u662f\u4e00\u4e2a Mock \u5e94\u7b54\u7684\u529f\u80fd\uff0c\u9700\u8981\u5b9e\u73b0\u6839\u636e\u914d\u7f6e\u7684\u5185\u5bb9\uff0c\u8fd4\u56de HTTP \u5e94\u7b54\u3002\\n\u672c\u6587\u4f1a\u6309\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\u4ecb\u7ecd\uff1a\\n\\n- \u7f16\u5199\u4ee3\u7801\uff1a\u4ee3\u7801\u903b\u8f91\u89e3\u6790\\n- \u751f\u6548\u63d2\u4ef6\uff1a\u8bf4\u660e\u4ee3\u7801\u5982\u4f55\u8fdb\u884c\u7f16\u8bd1\u6253\u5305\u5e76\u90e8\u7f72\u751f\u6548\\n- \u6d4b\u8bd5\u63d2\u4ef6\u529f\u80fd\uff1a\u8bf4\u660e\u5168\u5c40\u7c92\u5ea6\uff0c\u8def\u7531/\u57df\u540d\u7ea7\u7c92\u5ea6\u5982\u4f55\u751f\u6548\\n- \u63d2\u4ef6\u751f\u6548\u539f\u7406\uff1a\u5bf9\u6574\u4f53\u6d41\u7a0b\u8fdb\u884c\u56de\u987e\uff0c\u8bf4\u660e\u63d2\u4ef6\u751f\u6548\u7684\u539f\u7406\\n- \u4e09\u4e2a\u9769\u547d\u6027\u7684\u7279\u6027\uff1a\u4ecb\u7ecd Wasm \u63d2\u4ef6\u673a\u5236\u4e3a\u7f51\u5173\u63d2\u4ef6\u5f00\u53d1\u5e26\u6765\u7684\u53d8\u9769\\n## \u7f16\u5199\u4ee3\u7801\\n\\n```\\npackage main\\n\\nimport (\\n    . \\"github.com/alibaba/higress/plugins/wasm-go/pkg/wrapper\\"\\n    \\"github.com/tetratelabs/proxy-wasm-go-sdk/proxywasm\\"\\n    \\"github.com/tetratelabs/proxy-wasm-go-sdk/proxywasm/types\\"\\n    \\"github.com/tidwall/gjson\\"\\n)\\n\\nfunc main() {\\n    SetCtx(\\n        \\"my-plugin\\",\\n        ParseConfigBy(parseConfig),\\n        ProcessRequestHeadersBy(onHttpRequestHeaders),\\n    )\\n}\\n\\ntype MyConfig struct {\\n    content string\\n}\\n\\nfunc parseConfig(json gjson.Result, config *MyConfig, log Log) error {\\n    config.content = json.Get(\\"content\\").String()\\n    return nil\\n}\\n\\nfunc onHttpRequestHeaders(ctx HttpContext, config MyConfig, log Log) types.Action {\\n    proxywasm.SendHttpResponse(200, nil, []byte(config.content), -1)\\n    return types.ActionContinue\\n}\\n```\\n\u4e0a\u9762\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u5230\u4e09\u4e2a\u51fd\u6570\uff1a\\n\\n- main\uff1a\u63d2\u4ef6\u901a\u8fc7 main \u51fd\u6570\u5b9a\u4e49\u63d2\u4ef6\u4e0a\u4e0b\u6587\uff0c\u5305\u62ec\u63d2\u4ef6\u540d\u79f0\uff0c\u7528\u4e8e\u89e3\u6790\u914d\u7f6e\u7684\u51fd\u6570\uff0c\u4ee5\u53ca\u7528\u4e8e\u5904\u7406\u8bf7\u6c42/\u5e94\u7b54\u7684\u51fd\u6570\\n- parseConfig\uff1a\u8fd9\u4e2a\u51fd\u6570\u901a\u8fc7\u5728 SetCtx \u4e2d\u6307\u5b9a\u7684 ParseConfigBy \u88ab\u6302\u8f7d\u5230\u63d2\u4ef6\u914d\u7f6e\u89e3\u6790\u9636\u6bb5\uff0c\u4f20\u5165\u7684\u4e09\u4e2a\u53c2\u6570\u5206\u522b\u662f\uff1a\\n   - json\uff1a\u4f20\u5165\u63d2\u4ef6\u7684\u914d\u7f6e\uff0c\u5c06\u7edf\u4e00\u5e8f\u5217\u5316\u4e3a\u4e00\u4e2a json \u5b57\u5178\u5bf9\u8c61\uff0c\u63d0\u4f9b parseConfig \u8fdb\u884c\u89e3\u6790\\n   - config\uff1aparseConfig \u5c06\u89e3\u6790\u540e\u7684\u63d2\u4ef6\u914d\u7f6e\u8f93\u51fa\u5230\u8fd9\u4e2a MyConfig \u5bf9\u8c61\\n   - log\uff1a\u63d0\u4f9b\u65e5\u5fd7\u8f93\u51fa\u63a5\u53e3\\n- onHttpRequestHeaders\uff1a\u51fd\u6570\u4e2d\u8c03\u7528\u7684 proxywasm.SendHttpResponse\uff0c\u7528\u4e8e\u5b9e\u73b0\u76f4\u63a5\u8fd4\u56de HTTP \u5e94\u7b54\uff0c\u8fd9\u4e2a\u51fd\u6570\u901a\u8fc7\u5728 SetCtx \u4e2d\u6307\u5b9a\u7684 ProcessRequestHeadersBy \u88ab\u6302\u8f7d\u5230\u89e3\u6790\u8bf7\u6c42 Header \u7684\u6267\u884c\u9636\u6bb5\uff0c\u5176\u4ed6\u7684\u6302\u8f7d\u65b9\u5f0f\u8fd8\u6709\uff1a\\n   - ProcessRequestBodyBy\uff1a\u6302\u8f7d\u5230\u89e3\u6790\u8bf7\u6c42 Body \u7684\u6267\u884c\u9636\u6bb5\\n   - ProcessResponseHeadersBy\uff1a\u6302\u8f7d\u5230\u6784\u9020\u5e94\u7b54 Header \u7684\u6267\u884c\u9636\u6bb5\\n   - ProcessResponseBodyBy\uff1a\u6302\u8f7d\u5230\u6784\u9020\u5e94\u7b54 Body \u7684\u6267\u884c\u9636\u6bb5\\n\\n      \u4f20\u5165\u7684\u4e09\u4e2a\u53c2\u6570\u5206\u522b\u662f\uff1a\\n\\n   - ctx\uff1a\u7528\u4e8e\u83b7\u53d6\u8bf7\u6c42\u4e0a\u4e0b\u6587\uff0c\u5982 scheme/method/path \u7b49\uff0c\u901a\u8fc7 ctx \u53ef\u4ee5\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u4e0a\u4e0b\u6587\uff0c\u80fd\u8de8\u6267\u884c\u9636\u6bb5\u8bbf\u95ee\\n   - config\uff1a\u63d0\u4f9b parseConfig \u89e3\u6790\u597d\u7684\u81ea\u5b9a\u4e49\u914d\u7f6e\\n   - log\uff1a\u63d0\u4f9b\u65e5\u5fd7\u8f93\u51fa\u63a5\u53e3\\n\\n\u8fd9\u4e2a 30 \u884c\u4ee3\u7801\u5b9e\u73b0\u7684\u63d2\u4ef6\u529f\u80fd\u6bd4\u8f83\u7b80\u5355\uff0c\u8fd9\u91cc\u6709\u4e00\u4e9b\u529f\u80fd\u76f8\u5bf9\u590d\u6742\u7684\u4f8b\u5b50\uff1a[https://github.com/alibaba/higress/tree/main/plugins/wasm-go/extensions](https://github.com/alibaba/higress/tree/main/plugins/wasm-go/extensions)\\n\u8fd9\u91cc\u6709\u63d2\u4ef6 sdk \u7684\u8be6\u7ec6\u4f7f\u7528\u6587\u6863\uff1a\\n[https://higress.io/zh-cn/docs/user/wasm-go.html](https://higress.io/zh-cn/docs/user/wasm-go.html)\\n\u8fd9\u4e2a\u63d2\u4ef6 sdk \u662f\u57fa\u4e8e Tetrate \u793e\u533a\u7684 proxy-wasm-go-sdk \u5b9e\u73b0\u7684\uff0c\u5982\u679c\u5173\u6ce8\u66f4\u5e95\u5c42\u7684\u7ec6\u8282\uff0c\u53ef\u4ee5\u67e5\u770b\uff1a\\n[https://github.com/tetratelabs/proxy-wasm-go-sdk](https://github.com/tetratelabs/proxy-wasm-go-sdk)\\n[https://github.com/alibaba/higress/blob/main/plugins/wasm-go/pkg/wrapper](https://github.com/alibaba/higress/blob/main/plugins/wasm-go/pkg/wrapper/plugin_wrapper.go)\\n\u53ef\u4ee5\u770b\u5230\uff0cHigress \u7684 wasm-go sdk \u662f\u901a\u8fc7 Go 1.18 \u5f15\u5165\u7684\u6cdb\u578b\u7279\u6027\u5c01\u88c5\u4e86\u63d2\u4ef6\u4e0a\u4e0b\u6587\u5904\u7406\u7ec6\u8282\uff0c\u4ece\u800c\u964d\u4f4e\u63d2\u4ef6\u5f00\u53d1\u6240\u9700\u4ee3\u7801\u91cf\uff0c\u5f00\u53d1\u8005\u53ea\u7528\u5173\u5fc3\u914d\u7f6e\u89e3\u6790\u548c\u8bf7\u6c42\u5e94\u7b54\u5904\u7406\u7684\u903b\u8f91\u3002\\n## \u751f\u6548\u63d2\u4ef6\\n\u7f16\u5199\u5b8c\u6210\u4ee3\u7801\u540e\uff0c\u4e00\u5171\u6709\u4e09\u4e2a\u6b65\u9aa4\uff0c\u5b9e\u73b0\u63d2\u4ef6\u903b\u8f91\u7684\u751f\u6548\uff1a\\n\\n1. \u7f16\u8bd1\uff1a\u5c06 go \u4ee3\u7801\u7f16\u8bd1\u6210 Wasm \u683c\u5f0f\u6587\u4ef6\\n2. \u955c\u50cf\u63a8\u9001\uff1a\u5c06 Wasm \u6587\u4ef6\u6253\u5305\u6210 docker \u955c\u50cf\uff0c\u5e76\u63a8\u9001\u81f3\u955c\u50cf\u4ed3\u5e93\\n3. \u4e0b\u53d1\u914d\u7f6e\uff1a\u5728 K8s \u4e0a\u521b\u5efa WasmPlugin \u8d44\u6e90\\n### \u7f16\u8bd1\\n\u5c06\u4e0a\u9762\u7684 Go \u6587\u4ef6 main.go \u7f16\u8bd1\u6210 plugin.wasm\\n```bash\\ntinygo build -o plugin.wasm -scheduler=none -target=wasi main.go\\n```\\n### \u955c\u50cf\u63a8\u9001\\n\u7f16\u5199 Dockerfile\\n```dockerfile\\nFROM scratch\\nCOPY plugin.wasm ./\\n```\\n\u6784\u5efa\u5e76\u63a8\u9001 Docker \u955c\u50cf \uff08\u8fd9\u91cc\u793a\u4f8b\u7528\u7684\u662f Higress \u7684\u5b98\u65b9\u955c\u50cf\u4ed3\u5e93\uff09\\n```bash\\ndocker build -t higress-registry.cn-hangzhou.cr.aliyuncs.com/plugins/demo:1.0.0 .\\ndocker push higress-registry.cn-hangzhou.cr.aliyuncs.com/plugins/demo:1.0.0\\n```\\n### \u4e0b\u53d1\u914d\u7f6e\\n\u7f16\u5199 wasmplugin.yaml\uff0c\u914d\u7f6e\u8bf4\u660e\uff1a\\n\\n- selector\uff1a \u9009\u4e2d\u4e86\u9ed8\u8ba4\u5b89\u88c5\u5728 higress-system \u547d\u540d\u7a7a\u95f4\u4e0b\u7684 higress-gateway \u751f\u6548\u8fd9\u4efd\u63d2\u4ef6\\n- pluginConfig\uff1a\u63d2\u4ef6\u914d\u7f6e\uff0c\u6700\u7ec8\u4f1a\u88ab\u8f6c\u6362\u6210\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684 MyConfig \u5bf9\u8c61\\n- url\uff1a\u586b\u5199\u955c\u50cf\u5730\u5740\uff0c\u9700\u8981\u4ee5\\"oci://\\"\u5f00\u5934\\n\\n\u9664\u4e86\u8fd9\u4e9b\u914d\u7f6e\u5916\uff0c\u8fd8\u53ef\u4ee5\u5b9a\u4e49\u63d2\u4ef6\u7684\u6267\u884c\u9636\u6bb5\u548c\u4f18\u5148\u7ea7\u7b49\u8fdb\u9636\u914d\u7f6e\uff0c\u53ef\u4ee5\u53c2\u8003 Istio API \u5b98\u65b9\u6587\u6863\uff1a[https://istio.io/latest/docs/reference/config/proxy_extensions/wasm-plugin/](https://istio.io/latest/docs/reference/config/proxy_extensions/wasm-plugin/)\\n```yaml\\n# wasmplugin.yaml\\napiVersion: extensions.higress.io/v1alpha1\\nkind: WasmPlugin\\nmetadata:\\n  name: request-block\\n  namespace: higress-system\\nspec:\\n  defaultConfig:\\n    block_urls:\\n    - \\"swagger.html\\"\\n  url: oci://higress-registry.cn-hangzhou.cr.aliyuncs.com/plugins/demo:1.0.0\\n```\\n\u901a\u8fc7 kubectl \u521b\u5efa\u8fd9\u4e2a\u8d44\u6e90\\n```bash\\nkubectl apply -f wasmplugin.yaml\\n```\\n## \u6d4b\u8bd5\u63d2\u4ef6\u529f\u80fd\\n\u57fa\u4e8e\u4e4b\u524d\u751f\u6548\u7684 quickstart.yaml\uff0c\u76ee\u524d\u96c6\u7fa4\u4e2d\u7684 Ingress \u8bbf\u95ee\u62d3\u6251\u5982\u4e0b\u6240\u793a\uff1a\\n### ![ing-topo.png](https://img.alicdn.com/imgextra/i3/O1CN0178hYAV1sBTSczmfAf_!!6000000005728-2-tps-646-605.png)\\n\u672a\u751f\u6548\u63d2\u4ef6\u7684\u60c5\u51b5\u4e0b\uff1a\\n\\n- \u8bf7\u6c42`/foo` \u5c06\u8fd4\u56de HTTP \u5e94\u7b54 `\\"foo\\"`\\n- \u8bf7\u6c42`/bar` \u5c06\u8fd4\u56de HTTP \u5e94\u7b54 `\\"bar\\"`\\n### \u5168\u5c40\u751f\u6548\\n\u57fa\u4e8e\u4e0a\u6587\u751f\u6548\u63d2\u4ef6\u9636\u6bb5\uff0c\u4e0b\u53d1\u7684 wasmplugin.yaml\uff0c\u751f\u6548\u63d2\u4ef6\u540e\u6548\u679c\u5982\u4e0b\uff1a\\n\\n- \u8bf7\u6c42`/foo` \u5c06\u8fd4\u56de HTTP \u5e94\u7b54 `\\"hello higress\\"`\\n- \u8bf7\u6c42`/bar` \u5c06\u8fd4\u56de HTTP \u5e94\u7b54 `\\"hello higress\\"`\\n### \u57df\u540d&\u8def\u7531\u7ea7\u751f\u6548\\n\u5c06 wasmplugin.yaml \u914d\u7f6e\u4fee\u6539\u5982\u4e0b\uff1a\\n```yaml\\n# wasmplugin.yaml\\napiVersion: extensions.higress.io/v1alpha1\\nkind: WasmPlugin\\nmetadata:\\n  name: request-block\\n  namespace: higress-system\\nspec:\\n  defaultConfig:\\n   # \u8ddf\u4e0a\u9762\u4f8b\u5b50\u4e00\u6837\uff0c\u8fd9\u4e2a\u914d\u7f6e\u4f1a\u5168\u5c40\u751f\u6548\uff0c\u4f46\u5982\u679c\u88ab\u4e0b\u9762\u89c4\u5219\u5339\u914d\u5230\uff0c\u5219\u4f1a\u6539\u4e3a\u6267\u884c\u547d\u4e2d\u89c4\u5219\u7684\u914d\u7f6e\\n   block_urls:\\n   - \\"swagger.html\\"\\n   matchRules:\\n   # \u8def\u7531\u7ea7\u751f\u6548\u914d\u7f6e\\n  - ingress:\\n    - default/foo\\n     # default \u547d\u540d\u7a7a\u95f4\u4e0b\u540d\u4e3a foo \u7684 ingress \u4f1a\u6267\u884c\u4e0b\u9762\u8fd9\u4e2a\u914d\u7f6e\\n    config:\\n      block_bodies:\\n      - \\"foo\\"\\n  - ingress:\\n    - default/bar\\n    # default \u547d\u540d\u7a7a\u95f4\u4e0b\u540d\u4e3a bar \u7684 ingress \u4f1a\u6267\u884c\u4e0b\u9762\u8fd9\u4e2a\u914d\u7f6e\\n    config:\\n      block_bodies:\\n      - \\"bar\\"\\n   # \u57df\u540d\u7ea7\u751f\u6548\u914d\u7f6e\\n  - domain:\\n    - \\"*.example.com\\"\\n    # \u82e5\u8bf7\u6c42\u5339\u914d\u4e86\u4e0a\u9762\u7684\u57df\u540d, \u4f1a\u6267\u884c\u4e0b\u9762\u8fd9\u4e2a\u914d\u7f6e\\n    config:\\n      block_bodies:\\n      - \\"foo\\"\\n      - \\"bar\\"\\n  url: oci://higress-registry.cn-hangzhou.cr.aliyuncs.com/plugins/demo:1.0.0\\n```\\n\u5728 pluginConfig \u4e2d\u589e\u52a0\u4e86 `_rules_`  \u89c4\u5219\u5217\u8868\uff0c\u89c4\u5219\u4e2d\u53ef\u4ee5\u6307\u5b9a\u5339\u914d\u65b9\u5f0f\uff0c\u5e76\u586b\u5199\u5bf9\u5e94\u751f\u6548\u7684\u914d\u7f6e:\\n\\n- _match_route_\uff1a\u5339\u914d Ingress \u751f\u6548\uff0c\u5339\u914d\u683c\u5f0f\u4e3a\uff1aIngress \u6240\u5728\u547d\u540d\u7a7a\u95f4 + \\"/\\" + Ingress \u540d\u79f0\\n- _match_domain_\uff1a\u5339\u914d\u57df\u540d\u751f\u6548\uff0c\u586b\u5199\u57df\u540d\u5373\u53ef\uff0c\u652f\u6301\u901a\u914d\u7b26\\n\\n\u751f\u6548\u8fd9\u4efd\u4fee\u6539\u540e\u7684\u914d\u7f6e\uff1a\\n```yaml\\nkubectl apply -f wasmplugin.yaml\\n```\\n\u53ef\u4ee5\u770b\u5230\u6548\u679c\u5982\u4e0b\uff1a\\n\\n- \u8bf7\u6c42`/foo` \u5c06\u8fd4\u56de HTTP \u5e94\u7b54 `\\"hello foo\\"` (\u5339\u914d\u5230\u7b2c\u4e00\u6761 rule)\\n- \u8bf7\u6c42`/bar` \u5c06\u8fd4\u56de HTTP \u5e94\u7b54 `\\"hello bar\\"` (\u5339\u914d\u5230\u7b2c\u4e8c\u6761 rule)\\n- \u8bf7\u6c42`www.example.com` \u5c06\u8fd4\u56de HTTP \u5e94\u7b54 `\\"hello world\\"` \uff08\u5339\u914d\u5230\u7b2c\u4e09\u6761 rule\uff09\\n- \u8bf7\u6c42`www.abc.com` \u5c06\u8fd4\u56de HTTP \u5e94\u7b54 `\\"hello higress\\"` \uff08\u6ca1\u6709\u5339\u914d\u7684 rule\uff0c\u4f7f\u7528\u5168\u5c40\u914d\u7f6e\uff09\\n## \u63d2\u4ef6\u751f\u6548\u539f\u7406\\n![wasm.png](https://img.alicdn.com/imgextra/i4/O1CN01PO4HYC1h7qYHonHHZ_!!6000000004231-2-tps-1100-537.png)\\n\\n\u8fd9\u91cc\u5bf9\u63d2\u4ef6\u7684\u751f\u6548\u673a\u5236\u7b80\u5355\u505a\u4e2a\u8bf4\u660e\uff1a\\n\\n1. \u7528\u6237\u5c06\u4ee3\u7801\u7f16\u8bd1\u6210 wasm \u6587\u4ef6\\n2. \u7528\u6237\u5c06 wasm \u6587\u4ef6\u6784\u5efa\u6210 docker \u955c\u50cf\\n3. \u7528\u6237\u5c06 docker \u955c\u50cf\u63a8\u9001\u81f3\u955c\u50cf\u4ed3\u5e93\\n4. \u7528\u6237\u521b\u5efa WasmPlugin \u8d44\u6e90\\n5. Istio watch \u5230 WasmPlugin \u8d44\u6e90\u7684\u53d8\u5316\\n6. Higress Gateway \u4e2d\u7684 xDS proxy \u8fdb\u7a0b\u4ece Istio \u83b7\u53d6\u5230\u914d\u7f6e\uff0c\u53d1\u73b0\u63d2\u4ef6\u7684\u955c\u50cf\u5730\u5740\\n7. xDS proxy \u4ece\u955c\u50cf\u4ed3\u5e93\u62c9\u53d6\u955c\u50cf\\n8. xDS proxy \u4ece\u955c\u50cf\u4e2d\u63d0\u53d6\u51fa wasm \u6587\u4ef6\\n9. Higress Gateway \u4e2d\u7684 envoy \u8fdb\u7a0b\u4ece xDS proxy \u83b7\u53d6\u5230\u914d\u7f6e\uff0c\u53d1\u73b0 wasm \u6587\u4ef6\u7684\u672c\u5730\u8def\u5f84\\n10. envoy \u4ece\u672c\u5730\u6587\u4ef6\u4e2d\u52a0\u8f7d wasm \u6587\u4ef6\\n\\n\u8fd9\u91cc envoy \u83b7\u53d6\u914d\u7f6e\u5e76\u52a0\u8f7d wasm \u6587\u4ef6\u4f7f\u7528\u5230\u4e86 ECDS (Extension Config Discovery Service)\u7684\u673a\u5236\uff0c\u5b9e\u73b0\u4e86 wasm \u6587\u4ef6\u66f4\u65b0\uff0c\u76f4\u63a5\u70ed\u52a0\u8f7d\uff0c\u4e0d\u4f1a\u5bfc\u81f4\u4efb\u4f55\u8fde\u63a5\u4e2d\u65ad\uff0c\u4e1a\u52a1\u6d41\u91cf\u5b8c\u5168\u65e0\u635f\u3002\\n## \u4e09\u4e2a\u9769\u547d\u6027\u7684\u7279\u6027\\n\u4e0a\u9762\u7684 Wasm \u63d2\u4ef6\u673a\u5236\u4e3a\u7f51\u5173\u81ea\u5b9a\u4e49\u63d2\u4ef6\u5f00\u53d1\u5e26\u6765\u4e86\u4e09\u4e2a\u9769\u547d\u6027\u7684\u7279\u6027\u3002\\n### \u7279\u6027\u4e00\uff1a\u63d2\u4ef6\u751f\u547d\u5468\u671f\u548c\u7f51\u5173\u89e3\u8026\\n\u8fd9\u4e2a\u7279\u6027\u4e3b\u8981\u5f97\u76ca\u4e8e Istio \u7684 WasmPlugin \u673a\u5236\u8bbe\u8ba1\u3002\u53ef\u4ee5\u548c K8s Nginx Ingress \u7684\u63d2\u4ef6\u673a\u5236\u505a\u4e2a\u5bf9\u6bd4\uff1a\\n> reference: [https://github.com/kubernetes/ingress-nginx/blob/main/rootfs/etc/nginx/lua/plugins/README.md](https://github.com/kubernetes/ingress-nginx/blob/main/rootfs/etc/nginx/lua/plugins/README.md)\\n> ### Installing a plugin\\n> There are two options:\\n> - mount your plugin into /etc/nginx/lua/plugins/<your plugin name /> in the ingress-nginx pod\\n> - build your own ingress-nginx image like it is done in the [example](https://github.com/ElvinEfendi/ingress-nginx-openidc/tree/master/rootfs/etc/nginx/lua/plugins/openidc) and install your plugin during image build\\n\\n\u53ef\u4ee5\u770b\u5230 Nginx Ingress \u52a0\u8f7d\u81ea\u5b9a\u4e49\u63d2\u4ef6\uff0c\u9700\u8981\u5c06 lua \u6587\u4ef6\u6302\u8f7d\u8fdb pod\uff0c\u6216\u8005\u5728\u6784\u5efa\u955c\u50cf\u65f6\u88c5\u5165\u3002\u8fd9\u6837\u5c31\u5c06\u63d2\u4ef6\u7684\u751f\u547d\u5468\u671f\u8ddf\u7f51\u5173\u7ed1\u5b9a\u5728\u4e00\u8d77\uff0c\u63d2\u4ef6\u903b\u8f91\u66f4\u65b0\uff0c\u9700\u8981\u53d1\u5e03\u65b0\u7248\u672c\uff0c\u7f51\u5173\u4e5f\u9700\u8981\u53d1\u5e03\u65b0\u7248\u672c\u6216\u8005\u91cd\u65b0\u90e8\u7f72\u3002\\n\u4f7f\u7528 WasmPlugin \u7684\u673a\u5236\uff0c\u63d2\u4ef6\u9700\u8981\u53d1\u5e03\u65b0\u7248\u672c\uff0c\u53ea\u9700\u6784\u5efa\u63d2\u4ef6\u81ea\u8eab\u7684\u955c\u50cf\u5e76\u8fdb\u884c\u4e0b\u53d1\u751f\u6548\uff0c\u800c\u4e14\u53ef\u4ee5\u57fa\u4e8e\u955c\u50cf\u7684 tag \u8fdb\u884c\u63d2\u4ef6\u7684\u7248\u672c\u7ba1\u7406\u3002\u8fd9\u6837\u63d2\u4ef6\u53d8\u66f4\uff0c\u4e0d\u4ec5\u65e0\u9700\u91cd\u65b0\u90e8\u7f72\u7f51\u5173\uff0c\u7ed3\u5408 Envoy \u7684 ECDS \u673a\u5236\u5bf9\u6d41\u91cf\u4e5f\u662f\u5b8c\u5168\u65e0\u635f\u3002\\n### \u7279\u6027\u4e8c\uff1a\u9ad8\u6027\u80fd\u7684\u591a\u8bed\u8a00\u652f\u6301\\n\u57fa\u4e8e Wasm \u7684\u80fd\u529b\uff0c\u53ef\u4ee5\u7528\u591a\u79cd\u8bed\u8a00\u7f16\u5199\u63d2\u4ef6\uff0c\u5bf9\u5f00\u53d1\u4eba\u5458\u66f4\u52a0\u53cb\u597d\u3002\u5b9e\u73b0\u591a\u8bed\u8a00\u5f00\u53d1\u63d2\u4ef6\u7684\u53e6\u4e00\u79cd\u65b9\u5f0f\u662f\u57fa\u4e8e RPC \u548c\u7f51\u5173\u8fdb\u7a0b\u901a\u4fe1\u7684\u5916\u7f6e\u8fdb\u7a0b/\u670d\u52a1\u63d2\u4ef6\uff0c\u8fd9\u79cd\u6a21\u5f0f\u4f1a\u6709\u989d\u5916\u7684 IO \u5f00\u9500\uff0c\u5e76\u4e14\u9644\u52a0\u7684\u8fdb\u7a0b/\u670d\u52a1\u4e5f\u5e26\u6765\u989d\u5916\u7684\u8fd0\u7ef4\u590d\u6742\u5ea6\u3002\u76ee\u524d\u5927\u5bb6\u5bf9 Wasm \u63d2\u4ef6\u7684\u6027\u80fd\u6bd4\u8f83\u5173\u5fc3\uff0c\u4ece\u6211\u4eec\u7684\u6d4b\u8bd5\u6570\u636e\u6765\u770b\uff0c\u6307\u4ee4\u6267\u884c\u6027\u80fd\u76f8\u6bd4\u539f\u751f\u7684 C++ \u8bed\u8a00\u786e\u5b9e\u6709\u5dee\u8ddd\uff0c\u4f46\u6027\u80fd\u548c Lua \u6301\u5e73\uff0c\u4e14\u8fdc\u597d\u4e8e\u5916\u7f6e\u63d2\u4ef6\u3002\\n\u5bf9\u4e8e\u4e00\u6bb5\u903b\u8f91\uff1a`\u5faa\u73af\u6267\u884c20\u6b21\u8bf7\u6c42\u5934\u8bbe\u7f6e\uff0c\u5faa\u73af\u6267\u884c20\u6b21\u8bf7\u6c42\u5934\u83b7\u53d6\uff0c\u5faa\u73af\u6267\u884c20\u6b21\u8bf7\u6c42\u5934\u79fb\u9664\u3002`\u6211\u4eec\u5bf9\u6bd4\u4e86\u5206\u522b\u7528 Lua \u548c\u4e0d\u540c\u8bed\u8a00\u5b9e\u73b0\u7684 Wasm \u7684\u5904\u7406\u6027\u80fd\uff0c\u4e0b\u9762\u662f\u5bf9\u5355\u4e2a\u8bf7\u6c42\u5ef6\u65f6\u7684\u5f71\u54cd\u5bf9\u6bd4\uff1a\\n\\n| **\u5b9e\u73b0\u8bed\u8a00** | **\u8bf7\u6c42\u5ef6\u65f6\u589e\u52a0** |\\n| --- | --- |\\n| Lua | 0.20\u6beb\u79d2 |\\n| Wasm (C++) | 0.19\u6beb\u79d2 |\\n| Wasm (Go) | 0.20\u6beb\u79d2 |\\n| Wasm (Rust) | 0.21\u6beb\u79d2 |\\n| Wasm (AssemblyScript) | 0.21\u6beb\u79d2 |\\n\\n### \u7279\u6027\u4e09\uff1a\u5b89\u5168\u6c99\u7bb1\\nEnvoy \u76ee\u524d\u652f\u6301\u591a\u79cd Wasm \u7684\u8fd0\u884c\u65f6\uff0c\u4f8b\u5982 V8\uff0cWAMR\uff0cwasmtime \u7b49\u7b49\uff0c\u8fd9\u4e9b\u8fd0\u884c\u65f6\u5747\u63d0\u4f9b\u4e86\u5b89\u5168\u6c99\u7bb1\u80fd\u529b\uff0c\u5373 Wasm \u63d2\u4ef6\u4e2d\u51fa\u73b0\u4e86\u8bbf\u95ee\u7a7a\u6307\u9488\u3001\u5f02\u5e38\u672a\u6355\u83b7\u7b49\u903b\u8f91\uff0c\u4e5f\u4e0d\u4f1a\u4ee4 Envoy \u5bbf\u4e3b\u8fdb\u7a0b Crash\u3002\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\uff0c\u5728\u63d2\u4ef6\u903b\u8f91\u51fa\u73b0\u5f02\u5e38\u540e\u8fdb\u884c Fail Open \u5904\u7406\uff0c\u8df3\u8fc7\u63d2\u4ef6\u7684\u6267\u884c\u903b\u8f91\uff0c\u5c06\u5bf9\u4e1a\u52a1\u7684\u5f71\u54cd\u964d\u81f3\u6700\u4f4e\u3002\\n## \u5f00\u6e90\u793e\u533a\\n\u7279\u522b\u611f\u8c22 Istio/Envoy \u793e\u533a\u7684\u524d\u7f6e\u5de5\u4f5c\uff0c\u8ba9 Higress \u53ef\u4ee5\u5b9e\u73b0\u5bf9 Ingress \u8d44\u6e90\u542f\u7528 WasmPlugin \uff0c\u589e\u5f3a\u4e86 Ingress Controller \u7684\u81ea\u5b9a\u4e49\u6269\u5c55\u80fd\u529b\u3002\\n\u7279\u522b\u611f\u8c22 Tetrate \u793e\u533a\u5b9e\u73b0\u7684 proxy-wasm-go-sdk\uff0cHigress \u5728\u8fd9\u4e2a\u57fa\u7840\u4e0a\u5c01\u88c5\u4e86 wasm-go sdk\uff0c\u964d\u4f4e\u4e86\u5f00\u53d1\u63d2\u4ef6\u7684\u4e0a\u624b\u95e8\u69db\u3002\\nHigress \u5bf9 Istio/Envoy \u7684 Wasm \u80fd\u529b\u505a\u4e86\u4e00\u4e9b Bugfix \u7684\u5de5\u4f5c\uff0c\u76ee\u524d\u5df2\u7ecf\u90fd\u5408\u5e76\u8fdb\u4e86\u4e0a\u6e38\u793e\u533a\u3002\u540e\u7eed\u7684\u4e00\u4e9b Feature \u80fd\u529b\uff0c\u4e5f\u4f1a\u6301\u7eed\u53cd\u54fa\u4e0a\u6e38\u793e\u533a\u3002\\n\u540c\u65f6\u6b22\u8fce\u5927\u5bb6\u4e00\u8d77\u4e3a Higress \u7684\u63d2\u4ef6\u4ee5\u53ca\u5176\u4ed6\u793e\u533a\u751f\u6001\u6dfb\u7816\u52a0\u74e6\uff0c\u4e3a Higress \u8d21\u732e\u8bf7\u53c2\u8003\u6587\u6863\uff1a\\n[https://higress.io/zh-cn/docs/developers/guide_dev.html](https://higress.io/zh-cn/docs/developers/guide_dev.html)"},{"id":"/first-meetup","metadata":{"permalink":"/zh-cn/blog/first-meetup","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/first-meetup.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/first-meetup.md","title":"\u6b22\u8fce\u62a5\u540dHigress\u9996\u6b21\u7ebf\u4e0bMeetup","description":"\u7ebf\u4e0bMeetup\u62a5\u540d","date":"2022-11-22T00:00:00.000Z","formattedDate":"2022\u5e7411\u670822\u65e5","tags":[],"readingTime":0.01,"hasTruncateMarker":true,"authors":[{"name":"\u6f84\u6f6d"}],"frontMatter":{"title":"\u6b22\u8fce\u62a5\u540dHigress\u9996\u6b21\u7ebf\u4e0bMeetup","keywords":["higress","meetup"],"description":"\u7ebf\u4e0bMeetup\u62a5\u540d","author":"\u6f84\u6f6d","date":"2022-11-22T00:00:00.000Z","custom_edit_url":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/first-meetup.md"},"prevItem":{"title":"30\u884c\u4ee3\u7801\u5199\u4e00\u4e2aWasm Go\u63d2\u4ef6","permalink":"/zh-cn/blog/30-line-wasm"},"nextItem":{"title":"\u963f\u91cc\u5df4\u5df4\u91cd\u78c5\u5f00\u6e90\u4e91\u539f\u751f\u7f51\u5173","permalink":"/zh-cn/blog/higress"}},"content":"\x3c!--truncate--\x3e\\n![](https://img.alicdn.com/imgextra/i4/O1CN013pqDug1iTf1wdYIat_!!6000000004414-2-tps-800-8358.png)"},{"id":"/higress","metadata":{"permalink":"/zh-cn/blog/higress","editUrl":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/higress.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/higress.md","title":"\u963f\u91cc\u5df4\u5df4\u91cd\u78c5\u5f00\u6e90\u4e91\u539f\u751f\u7f51\u5173","description":"\u4ecb\u7ecdHigress\u7684\u8bde\u751f\u80cc\u666f\u4e0e\u53d1\u5c55\u5386\u7a0b","date":"2022-11-04T00:00:00.000Z","formattedDate":"2022\u5e7411\u67084\u65e5","tags":[],"readingTime":15.93,"hasTruncateMarker":true,"authors":[{"name":"gengleilei"}],"frontMatter":{"title":"\u963f\u91cc\u5df4\u5df4\u91cd\u78c5\u5f00\u6e90\u4e91\u539f\u751f\u7f51\u5173","keywords":["higress"],"description":"\u4ecb\u7ecdHigress\u7684\u8bde\u751f\u80cc\u666f\u4e0e\u53d1\u5c55\u5386\u7a0b","author":"gengleilei","date":"2022-11-04T00:00:00.000Z","custom_edit_url":"https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/higress.md"},"prevItem":{"title":"\u6b22\u8fce\u62a5\u540dHigress\u9996\u6b21\u7ebf\u4e0bMeetup","permalink":"/zh-cn/blog/first-meetup"}},"content":"Higress \u662f\u4e00\u6b3e\u6807\u51c6\u5316\u3001\u9ad8\u96c6\u6210\u3001\u6613\u6269\u5c55\u3001\u70ed\u66f4\u65b0\u7684\u4e91\u539f\u751f\u7f51\u5173\u3002\\n\\n\x3c!--truncate--\x3e\\n\\nHigress \u6e90\u81ea\u963f\u91cc\u5df4\u5df4\u5185\u90e8\u7535\u5546\u3001\u4ea4\u6613\u7b49\u6838\u5fc3\u751f\u4ea7\u573a\u666f\u7684\u5b9e\u8df5\u6c89\u6dc0\uff0c\u9075\u5faa Ingress/Gateway API \u6807\u51c6\uff0c\u5c06\u6d41\u91cf\u7f51\u5173\u3001\u5fae\u670d\u52a1\u7f51\u5173\u3001\u5b89\u5168\u7f51\u5173\u4e09\u5408\u4e00\uff0c\u5e76\u5728\u6b64\u57fa\u7840\u4e0a\u6269\u5c55\u4e86\u670d\u52a1\u7ba1\u7406\u63d2\u4ef6\u3001\u5b89\u5168\u7c7b\u63d2\u4ef6\u548c\u81ea\u5b9a\u4e49\u63d2\u4ef6\uff0c\u9ad8\u5ea6\u96c6\u6210 K8s \u548c\u5fae\u670d\u52a1\u751f\u6001\uff0c\u5305\u62ec Nacos \u6ce8\u518c\u548c\u914d\u7f6e\u3001Sentinel \u9650\u6d41\u964d\u7ea7\u7b49\u80fd\u529b\uff0c\u5e76\u652f\u6301\u89c4\u5219\u53d8\u66f4\u6beb\u79d2\u7ea7\u751f\u6548\u7b49\u70ed\u66f4\u65b0\u80fd\u529b\u3002\\n\\n![image.png](https://img.alicdn.com/imgextra/i1/O1CN01VYKTu922ZsiibaCml_!!6000000007135-2-tps-2178-1198.png)\\n## Higress\u7684\u524d\u4e16\u4eca\u751f\\n\\n### \u8bde\u751f\u80cc\u666f\\nHigress \u7684\u521b\u5efa\u6e90\u4e8e\u963f\u91cc\u5185\u90e8\u7684\u201c\u672c\u5730\u751f\u6d3b\u6218\u5f79\u201d\uff0c\u8be5\u6218\u5f79\u59cb\u4e8e\u201c\u652f\u4ed8\u5b9d2020\u5408\u4f5c\u4f19\u4f34\u5927\u4f1a\u201d\uff0c\u5728\u6b64\u5927\u4f1a\u4e0a\u652f\u4ed8\u5b9d\u5ba3\u5e03\u5347\u7ea7\u4e3a\u6570\u5b57\u751f\u6d3b\u5f00\u653e\u5e73\u53f0\u3002\u8be5\u6218\u5f79\u7684\u6838\u5fc3\u6280\u672f\u76ee\u6807\uff0c\u662f\u5b9e\u73b0\u963f\u91cc\u5df4\u5df4\u4e1a\u52a1\u57df\u4e0e\u8682\u8681\u4e1a\u52a1\u57df\u4e4b\u95f4 RPC \u76f4\u63a5\u8c03\u7528\uff0c\u4f46\u56e0\u963f\u91cc\u5df4\u5df4\u4e0e\u8682\u8681\u4e1a\u52a1\u57df\u7f51\u7edc\u662f\u9694\u79bb\u7684\uff0c\u5373\u7f51\u7edc\u662f\u4e0d\u901a\u7684\uff0c\u5f88\u81ea\u7136\u60f3\u5230\u5229\u7528\u7f51\u5173\u6765\u89e3\u51b3\u6b64\u95ee\u9898\u3002\\n\\n### \u6280\u672f\u9009\u578b\\n\u5229\u7528\u7f51\u5173\u6765\u89e3\u51b3\u963f\u91cc\u5df4\u5df4\u4e0e\u8682\u8681\u8de8\u4e1a\u52a1\u57df RPC \u4e92\u901a\u95ee\u9898\uff0c\u9996\u5148\u8981\u5bf9\u7f51\u5173\u505a\u6280\u672f\u9009\u578b\u3002\\n\\n\u76f8\u4fe1\u5927\u5bb6\u4e5f\u90fd\u6216\u591a\u6216\u5c11\u77e5\u9053\uff0c\u963f\u91cc\u5df4\u5df4\u5f00\u6e90\u7684\u53cd\u5411\u4ee3\u7406\u7a0b\u5e8f Tengine\u3002Tengine \u5728\u963f\u91cc\u5185\u90e8\u7edf\u4e00\u63a5\u5165\u7f51\u5173 AServer \u4e2d\u88ab\u4f7f\u7528\uff0c\u6211\u4eec\u56e2\u961f\u5c31\u662f\u8d1f\u8d23\u5176\u5f00\u53d1\u8fd0\u7ef4\uff0c\u540c\u65f6\u6211\u4eec\u56e2\u961f\u4e5f\u5728\u8d1f\u8d23\u963f\u91cc\u5df4\u5df4 Service Mesh \u7684\u843d\u5730\uff0c\u4e0d\u7ba1\u662f\u5bf9 Tengine \u8fd8\u662f\u5bf9 Istio + Envoy \u8fd9\u5957\u67b6\u6784\u90fd\u6bd4\u8f83\u719f\u6089\u3002\\n\\n\u5728\u9009\u578b\u65f6\uff0c\u867d\u7136\u4e5f\u8c03\u7814\u8fc7\u4e00\u4e9b\u5176\u4ed6\u7684\u8f6f\u4ef6\uff0c\u4f46\u8003\u8651\u5230\u7f51\u5173\u5bf9\u6027\u80fd\u3001\u53ef\u9760\u6027\u7684\u9ad8\u8981\u6c42\uff0c\u5728\u7ed3\u5408\u6211\u4eec\u81ea\u8eab\u7684\u7f51\u5173\u8fd0\u7ef4\u7ecf\u9a8c\uff0c\u51b3\u5b9a\u770b\u770b Tengine \u4e0e Envoy \u662f\u5426\u53ef\u4ee5\u6ee1\u8db3\u6211\u4eec\u7684\u4e1a\u52a1\u9700\u6c42\uff0c\u5728\u5bf9\u6bd4\u65f6\u6211\u4eec\u7f57\u5217\u4e86\u56db\u4e2a\u5173\u952e\u8981\u70b9\uff0c\u5176\u5bf9\u6bd4\u5982\u4e0b\uff1a\\n\\n![image.png](https://img.alicdn.com/imgextra/i3/O1CN0154SFHA1geXCJT8KIm_!!6000000004167-2-tps-2568-888.png)\\n\u8fd9\u91cc\u63d0\u4e00\u4e0b\u201c\u4e3a\u4ec0\u4e48\u6211\u4eec\u8ba4\u4e3a\u914d\u7f6e\u7684\u70ed\u66f4\u65b0\uff0c\u662f\u975e\u5e38\u91cd\u8981\u7684\u201d\uff1f\\n\\nTengine/Nginx \u7684\u914d\u7f6e\u66f4\u65b0\u9700\u8981 reload\uff0creload \u9700\u8981\u91cd\u542f worker \u8fdb\u7a0b\uff0c\u91cd\u542f\u65f6\u4f1a\u5f15\u8d77\u6d41\u91cf\u6296\u52a8\uff0c\u5bf9\u957f\u8fde\u63a5\u5f71\u54cd\u5c24\u4e3a\u660e\u663e\u3002\u5728\u7f51\u5173\u7684\u96c6\u7fa4\u89c4\u6a21\u975e\u5e38\u5927\u65f6\uff0c\u66f4\u662f\u4e0d\u80fd\u968f\u610f\u7684\u505a reload\uff0c\u8fd9\u65f6\u5c31\u4f1a\u5f15\u53d1\u4e00\u4e2a\u77db\u76fe\u70b9\uff1a\u4e1a\u52a1\u5411\u7f51\u5173\u63d0\u4ea4\u914d\u7f6e\u540e\uff0c\u5e0c\u671b\u80fd\u5feb\u901f\u9a8c\u8bc1\uff0c\u4f46\u53d7\u9650\u4e8e reload \u673a\u5236\u548c\u7a33\u5b9a\u6027\u8981\u6c42\uff0c\u65e0\u6cd5\u6ee1\u8db3\u4e1a\u52a1\u5feb\u901f\u9a8c\u8bc1\u4e0e\u5feb\u901f\u8bd5\u9519\u7684\u8bc9\u6c42\u3002\\n\\n\u73b0\u5728\u5df2\u7ecf\u6709\u5f88\u591a\u4e3b\u6d41\u5e94\u7528\u9009\u62e9\u91c7\u7528\u957f\u8fde\u63a5\uff0cHTTP 1.1\u4e00\u822c\u9ed8\u8ba4\u4f1a\u4f7f\u7528Keep-Alive\u53bb\u4fdd\u6301\u957f\u8fde\u63a5\uff0c\u540e\u7eedHTTP 2\u4ee5\u53caHTTP 3\u4e5f\u662f\u5982\u6b64\uff0c\u968f\u7740\u7f51\u7edc\u534f\u8bae\u7684\u53d1\u5c55\uff0c\u672a\u6765\u4f7f\u7528\u957f\u8fde\u63a5\u4f1a\u53d8\u5f97\u66f4\u52a0\u666e\u904d\u3002\u800c\u914d\u7f6e\u70ed\u66f4\u65b0\u5929\u7136\u5bf9\u957f\u8fde\u63a5\u975e\u5e38\u53cb\u597d\u3002\\n\\n\u5982\u4f55\u89e3\u51b3\u8fd9\u70b9\u5462\uff1f\\n\\n\u4e00\u662f\u91c7\u7528\u4e24\u5c42\u7f51\u5173\uff0c\u5373\u6d41\u91cf\u7f51\u5173 + \u4e1a\u52a1\u7f51\u5173\uff1b\u4e8c\u662f\u5b9e\u73b0\u7f51\u5173\u539f\u751f\u652f\u6301\u914d\u7f6e\u70ed\u66f4\u65b0\u3002\u9664\u4e86\u5bf9\u6bd4\u4e0d\u540c\u65b9\u6848\u7684\u4f18\u52a3\u52bf\uff0c\u6211\u4eec\u4e5f\u8c03\u7814\u4e86 Envoy \u4f5c\u4e3a\u7f51\u5173\u5728\u4e1a\u754c\u7684\u8d8b\u52bf\uff0c\u7ed3\u8bba\u662f\u76ee\u524d Envoy \u4f5c\u4e3a K8s \u4e2d\u7684 Ingress Provider \u589e\u957f\u6700\u5feb\u7684\u4e8b\u5b9e\uff08Ingress Provider \u6307 K8s Ingress \u89c4\u8303\u5177\u4f53\u5b9e\u73b0\uff0c\u56e0 K8s Ingress \u81ea\u8eab\u53ea\u662f\u89c4\u8303\u5b9a\u4e49\uff0c\u662f K8s \u4e0b\u5916\u90e8\u6d41\u91cf\u8fdb\u5165\u96c6\u7fa4\u5185\u90e8\u7684\u7f51\u5173\u89c4\u8303\u5b9a\u4e49\uff09\uff0c\u6211\u4eec\u6700\u7ec8\u9009\u62e9\u4e86 Envoy \u6765\u5b9e\u73b0\u4e24\u5c42\u7f51\u5173\u3002\\n\\n![image.png](https://img.alicdn.com/imgextra/i1/O1CN01noxgsq1izikgjVavA_!!6000000004484-2-tps-2948-1054.png)\\n\\n### \u53d1\u5c55\u5386\u7a0b\\nHigress\u4ece\u6700\u521d\u793e\u533a\u7684 Istio + Envoy\uff0c\u5230\u7ecf\u5386\u963f\u91cc\u5df4\u5df4\u5185\u90e8\u7684\u81ea\u7814\u6269\u5c55\uff0c\u518d\u5230\u5927\u89c4\u6a21\u751f\u6210\u9a8c\u8bc1\uff0c\u6700\u540e\u5b8c\u6210\u5546\u4e1a\u5316\u4ea7\u54c1\u7684\u53d1\u5e03\uff0c\u5176\u6574\u4e2a\u8fc7\u7a0b\u4ecb\u7ecd\u5982\u4e0b\uff1a\\n\\n![image.png](https://img.alicdn.com/imgextra/i1/O1CN01ZzyYWg1mJoyzwgeoC_!!6000000004934-2-tps-2296-908.png)\\n\u4e0b\u9762\u7684\u7ae0\u8282\u4f1a\u5bf9Higress\u7684\u5404\u4e2a\u9636\u6bb5\u505a\u8fdb\u4e00\u6b65\u7684\u8be6\u7ec6\u8bf4\u660e\u3002\\n# Higress (2020.05~2020.11)\\n\u6b64\u9636\u6bb5\u7684\u5927\u76ee\u6807\u662f\u4e3a\u4e86\u6ee1\u8db3\u96c6\u56e2\u4e0e\u8682\u8681RPC\u4e92\u901a\uff0c\u964d\u4f4e\u5168\u94fe\u8def\u7684RT\uff0c\u89e3\u51b3\u539fs2s\u94fe\u8def\u56e0RT\u8fc7\u9ad8\u5e26\u6765\u7684\u7528\u6237\u4f53\u9a8c\u5dee\u53ca\u65e0\u6cd5\u6ee1\u8db3\u66f4\u591a\u96c6\u56e2\u4e0e\u8682\u8681\u534f\u540c\u573a\u666f\u8981\u6c42\u3002s2s\u94fe\u8def\u662f\u8d70\u516c\u7f51\u94fe\u8def\uff0c\u534f\u8bae\u91c7\u7528HTTP\u3002\u4e0e\u8682\u8681\u4e92\u901a\u7f51\u5173\u7684\u67b6\u6784\u56fe\u5982\u4e0b\uff0c\u8fd9\u91cc\u4ee5\u4e0a\u6d77\u4e91\u5355\u5143\u4e3a\u80cc\u666f\u8bf4\u660e\u3002\\n\\n![image.png](https://img.alicdn.com/imgextra/i2/O1CN01uEUUkR1Er4nkwYiOW_!!6000000000404-2-tps-2036-1088.png)\\n\\n\u4e0a\u56fe\u4e3b\u8981\u5c55\u793a\u7684\u662f\u96c6\u56e2\u4fa7\u7684\u67b6\u6784\uff0c\u6700\u7ec8\u91c7\u7528\u4e86Istio+Envoy\u7684\u65b9\u6848\uff0c\u5728\u90e8\u7f72\u7684\u65f6\u5019\u53c8\u5206\u6210\u4e86\u51fa\u53e3\u96c6\u7fa4\u548c\u5165\u53e3\u96c6\u7fa4\u3002\u4e4b\u6240\u4ee5\u62c6\u6210\u4e24\u4e2a\u96c6\u7fa4\uff0c\u4e00\u65b9\u9762\u662f\u5f53\u65f6\u4e24\u8fb9\u4e92\u8bbf\uff0c\u8682\u8681\u8c03\u96c6\u56e2\u7684\u6d41\u91cf\u8981\u8fdc\u8fdc\u5927\u4e8e\u96c6\u56e2\u8c03\u8682\u8681\u7684\u6d41\u91cf\uff0c\u4e0a\u4e0b\u884c\u7279\u522b\u4e0d\u5747\u7b49\uff1b\u53e6\u4e00\u65b9\u9762\u662f\u5206\u5f00\u4e4b\u540e\u4e24\u4e2a\u96c6\u7fa4\u53ef\u4ee5\u5404\u81ea\u7ef4\u62a4\uff0c\u7a33\u5b9a\u6027\u4f1a\u66f4\u597d\u3002\\n\\nHigress \u4ece\u5f00\u59cb\u7acb\u9879\u5230\u5b8c\u6210\u7b2c\u4e00\u671f\u7814\u53d1\uff0c\u7f51\u5173\u6539\u9020\u7684\u6838\u5fc3\u5de5\u4f5c\u5dee\u4e0d\u591a\u4e24\u4e2a\u4eba\u6295\u5165\u4e86\u4e00\u4e2a\u534a\u6708\u5de6\u53f3\uff0c\u5176\u4e2d\u8fd8\u6d89\u53ca\u5230\u5927\u91cf\u7f51\u7edc\u3001\u5b89\u5168\u7b49\u534f\u8c03\u90e8\u95e8\u7684\u5de5\u4f5c\u3002Higress\u67b6\u6784\u5e76\u6ca1\u6709\u5b8c\u5168\u6309\u7167\u793e\u533a\u65b9\u6848\u6765\u8bbe\u8ba1\uff0c\u793e\u533a\u7248\u672c\u4e2d\u914d\u7f6e\u53d8\u66f4\u548c\u670d\u52a1\u53d1\u73b0\u4f7f\u7528\u7684\u662fK8s\uff0c\u5728\u963f\u91cc\u5185\u90e8\u5e9e\u5927\u7684\u670d\u52a1\u89c4\u6a21\u53ca\u914d\u7f6e\u91cf\u4e0b\u793e\u533a\u539f\u751f\u65b9\u6848\u4e0d\u7ba1\u5728\u7a33\u5b9a\u6027\u53ca\u6027\u80fd\u4e0a\u90fd\u65e0\u6cd5\u6ee1\u8db3\u8981\u6c42\uff0c\u56e0\u6b64\u963f\u91cc\u8fd9\u5957\u65b9\u6848\u91cd\u70b9\u5bf9\u670d\u52a1\u53d1\u73b0\u3001\u914d\u7f6e\u5b58\u50a8\u7ec4\u4ef6\u505a\u4e86\u66ff\u6362\uff0c\u53ca\u4f18\u5316xDS\u63a8\u9001\u6027\u80fd\u3002\\n\\nHigress \u4e0a\u7ebf\u540e\uff0c\u987a\u5229\u8fbe\u6210\u4e86\u6700\u521d\u7684\u4e1a\u52a1\u8bc9\u6c42\uff0c\u76ee\u524d\u8682\u8681\u4e92\u901a\u7f51\u5173\u94fe\u8def\u5df2\u7ecf\u6210\u4e3a\u96c6\u56e2\u4e0e\u8682\u8681\u4e92\u901a\u7684\u9996\u9009\u65b9\u6848\uff0c\u4e00\u4e9b\u652f\u4ed8\u94fe\u8def\u4e5f\u8fc1\u79fb\u5230\u4e86\u8be5\u65b9\u6848\uff0c\u4f8b\u5982\u5145\u503c\u4e2d\u5fc3\u7b49\uff0c\u5177\u4f53\u8fbe\u5230\u7684\u6210\u679c\u7b80\u8ff0\u5982\u4e0b\uff1a\\n\\n- \u8682\u8681\u8c03\u7528\u96c6\u56e2\u94fe\u8def\u76f8\u6bd4\u539f\u94fe\u8defRT\u964d\u4f4e50%\uff0c\u7f51\u5173\u81ea\u8eabRT 0.3ms\u3002\\n- Higress\u6210\u529f\u590d\u5236\u5230\u96c6\u56e2\u4e0e\u8682\u8681\u7684\u6d88\u606f\u4e92\u901a\uff0c\u76ee\u524d\u96c6\u56e2\u4e0e\u8682\u8681\u7684\u6d88\u606f\u4e92\u901a\u4e5f\u662f\u8d70\u7684Higress Triple\u94fe\u8def\u3002\\n- \u5fae\u670d\u52a1\u7f51\u5173\u4ece5\u6708\u4efd\u4e0a\u7ebf\uff0c\u76ee\u524d\u5df2\u7ecf\u6210\u4e3a\u96c6\u56e2\u4e0e\u8682\u8681\u4e1c\u897f\u5411\u6d41\u91cf\u7684\u6838\u5fc3\u94fe\u8def\uff0c\u98de\u732a\u3001\u624b\u6dd8\u3001\u53e3\u7891\u3001\u997f\u4e86\u4e48\u30011688\u3001\u90e8\u5206\u5bfc\u8d2d\u5e94\u7528\u3001\u5546\u54c1\u5e93\u3001\u8bc4\u4ef7\u7b49\u4e1a\u52a1\u5df2\u6210\u529f\u4e0a\u7ebf\uff0c\u800c\u4e14\u5706\u6ee1\u652f\u6491\u4e86618\u5927\u4fc3\u3001\u652f\u4ed8\u5b9d717\u590f\u81f3\u5927\u4fc3\u3002\\n- \u57282020\u53cc11\u5927\u4fc3\u6bcf\u79d2 \u6570\u5341\u4e07 \u7684\u8bf7\u6c42\u6d41\u91cf\uff0c\u5706\u6ee1\u652f\u6491\u4e86\u53cc11\u57ce\u5e02\u751f\u6d3b\u72c2\u6b22\u8282\u7684\u4e92\u52a8\u4f1a\u573a\u3002\\n- \u5728\u6280\u672f\u4fa7\u5b8c\u6210\u4e86Higress\u5728\u4e1c\u897f\u5411\u6d41\u91cf\u5206\u53d1\u7684\u63a2\u7d22\u3002\\n# Higress (2020.12~2021.10)\\n\u968f\u7740\u963f\u91cc\u5df4\u5df4\u4e0a\u4e91\u6218\u5f79\u7684\u63a8\u8fdb\uff0c\u8d8a\u6765\u8d8a\u591a\u7684\u573a\u666f\u627e\u5230\u6211\u4eec\u3002\u6bd4\u5982\u4e91\u4e0a\u4e91\u4e0b\u4e1a\u52a1\u4e92\u901a\uff0c\u7531\u4e8e Tengine \u670d\u52a1\u7ba1\u7406\u5f31\u5bfc\u81f4\u963f\u91cc\u5185\u90e8\u5927\u91cf\u4e8c\u5c42\u5fae\u670d\u52a1\u7f51\u5173\u9700\u8981\u6536\u655b\uff0c\u8fd9\u5c31\u9700\u8981\u4ece\u4e1a\u52a1\u4e0a\u505a Tengine+Envoy \u4e24\u5c42\u7f51\u5173\u7684\u6f14\u8fdb\uff0c\u627f\u62c5\u5357\u5317\u5411\u7f51\u5173\u6d41\u91cf\u3002\u5728 2020 \u5e74 12 \u6708\u4efd\uff0c\u56e2\u961f\u5f00\u59cb\u4e86Higress \u67b6\u6784\u7684\u7ee7\u7eed\u6f14\u8fdb\uff0c\u4ee5\u4f18\u9177\u573a\u666f\u4e3a\u4f8b\u7684\u6f14\u8fdb\u8fc7\u7a0b\u5982\u4e0b\u56fe\uff1a\\n\\n![image.png](https://img.alicdn.com/imgextra/i1/O1CN01t1RGjj1RpKIIm5zQU_!!6000000002160-2-tps-1614-1194.png)\\n\\nHigress  \u5357\u5317\u5411\u7684\u67b6\u6784\u56fe\u5982\u4e0b\uff1a\\n\\n![image.png](https://img.alicdn.com/imgextra/i1/O1CN01B2guUL1Q8RauU7pCo_!!6000000001931-2-tps-2390-1242.png)\\n\\n\u5728\u4e24\u5c42\u67b6\u6784\u4e2d\uff0cHigress \u7f51\u5173\u66f4\u591a\u627f\u62c5\u4e86\u5fae\u670d\u52a1\u7f51\u5173\u548c\u5fae\u670d\u52a1\u6cbb\u7406\u7684\u9700\u6c42\uff0c\u548c Tengine \u6d41\u91cf\u7f51\u5173\u5b8c\u6210\u4e86\u6574\u5408\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u91cc\uff0c\u56e2\u961f\u652f\u6491\u4f18\u9177\u5185\u90e8\u591a\u4e2a\u4e8c\u5c42\u5fae\u670d\u52a1\u7f51\u5173\u7edf\u4e00\u7684\u5de5\u4f5c\uff0c\u5927\u5e45\u63d0\u5347\u4e86\u6027\u80fd\u548c\u8fd0\u7ef4\u6548\u7387\u3002\\n\\n\u5728\u8fd9\u4e00\u9636\u6bb5\uff0cHigress Gateway \u5b9e\u73b0\u4e86\u4e1c\u897f\u5411\u3001\u5357\u5317\u5411\u5168\u57df\u6d41\u91cf\u7684\u8c03\u5ea6\u5206\u53d1\uff0c\u4e1c\u897f\u5411\u4e0a\u4e0d\u4ec5\u652f\u6301\u8de8\u4e1a\u52a1\u57df\u7684\u8682\u8681 RPC \u4e92\u901a\uff0c\u4e5f\u6269\u5c55\u5230\u4e86\u6df7\u5408\u4e91\u7684\u4e91\u4e0a\u4e91\u4e0b RPC \u4e92\u901a\u573a\u666f\uff0c\u8986\u76d6\u9489\u9489\u6587\u6863\u3001\u963f\u91cc\u89c6\u9891\u4e91\u3001\u8fbe\u6469\u9662\u7684\u5e97\u5c0f\u871c\u3001\u667a\u6167\u6570\u5b57\u4eba\u7b49\u3002\u8be5\u9636\u6bb5\u7684\u4e1a\u52a1\u5927\u56fe\u5982\u4e0b\uff08\u4e91\u4e0a\u4e91\u4e0b\u4e92\u901a\u573a\u666f\uff0c\u4ee5\u9489\u9489\u4e3a\u4f8b\u8bf4\u660e\uff09\uff1a\\n\\n![image.png](https://img.alicdn.com/imgextra/i4/O1CN01VQ51BO2A5D7oqbLG6_!!6000000008151-2-tps-2370-1200.png)\\n\\n\u968f\u7740 Higress Gateway \u8986\u76d6\u7684\u4e1a\u52a1\u573a\u666f\u8d8a\u6765\u591a\uff0c\u5728\u8ddf\u4f18\u9177\u6301\u7eed\u5408\u4f5c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53cc\u65b9\u56e2\u961f\u4e0d\u7ea6\u800c\u540c\u63d0\u51fa\u4e86\u4e00\u4e2a\u8bbe\u60f3\uff1aTengine Gateway\uff08\u627f\u62c5\u6d41\u91cf\u7f51\u5173\u89d2\u8272\uff09 + Higress Gateway\uff08\u627f\u62c5\u5fae\u670d\u52a1\u7f51\u5173\u89d2\u8272\uff09\u7684\u4e24\u5c42\u7f51\u5173\u662f\u5426\u53ef\u4ee5\u5408\u5e76\u4e3a\u4e00\u5c42 Higress Gateway\uff1f\\n\\n\u6211\u4eec\u5bf9\u8fd9\u4e00\u60f3\u6cd5\u505a\u4e86\u8c03\u7814\uff0c\u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0c\u5e76\u4e14\u5f53\u65f6\u5927\u5bb6\u4e5f\u5408\u4f5c\u8bbe\u8ba1\u4e86\u65b0\u7684\u67b6\u6784\u65b9\u6848\uff0c\u5982\u4e0b\u56fe\uff1a\\n\\n![image.png](https://img.alicdn.com/imgextra/i2/O1CN01DMqpay1COYubY2QrN_!!6000000000071-2-tps-2394-1250.png)\\n\\n\u867d\u7136\u7531\u4e8e\u5404\u79cd\u5404\u6837\u7684\u539f\u56e0\uff0c\u8fd9\u4e2a\u65b9\u6848\u6700\u7ec8\u6ca1\u6709\u8ddf\u4f18\u9177\u7ee7\u7eed\u5f80\u4e0b\u63a8\u8fdb\u3002\u4f46\u8fd9\u4e2a\u6f14\u8fdb\u65b9\u5411\u8ba9\u56e2\u961f\u660e\u786e\u4e86\u7f51\u5173\u65b0\u7684\u53d1\u5c55\u8d8b\u52bf\uff1a**\u5728\u4ee5 K8s \u4e3b\u5bfc\u7684\u5bb9\u5668\u5316\u80cc\u666f\u4e0b\uff0c\u7531\u4e8eK8s \u96c6\u7fa4\u5185\u5916\u7f51\u7edc\u7684\u5929\u7136\u9694\u79bb\u6027\uff0c\u7528\u6237\u9700\u8981\u4e00\u6b3e\u517c\u987e\u9ad8\u6027\u80fd\u4e0e\u5b89\u5168\u6027\uff0c\u4ee5\u53ca\u5f3a\u5927\u670d\u52a1\u6cbb\u7406\u80fd\u529b\u7684\u5165\u53e3\u7f51\u5173\u3002\u8fd9\u4e5f\u4e3a\u540e\u7eed\u56e2\u961f\u5c06\u6280\u672f\u6c89\u6dc0\u53d8\u6210\u4e91\u4ea7\u54c1\u3001\u63a8\u8fdbHigress\u7684\u8bde\u751f\u6253\u4e0b\u4e86\u57fa\u7840\u3002**\\n\\n2021 \u5e74\uff0c\u963f\u91cc\u5df4\u5df4\u5f00\u542f\u4e86\u4e2d\u95f4\u4ef6\u4e09\u4f4d\u4e00\u4f53\u6218\u5f79\uff0c\u76ee\u6807\u662f\u7528\u4e91\u4ea7\u54c1\u652f\u6491\u96c6\u56e2\u4e1a\u52a1\u3002**\u6211\u4eec\u5f00\u59cb\u5c06\u5b75\u5316\u6210\u719f\u7684Higress\u6280\u672f\u6c89\u6dc0\u4e3a\u4e91\u4ea7\u54c1\uff0c\u5373\u76ee\u524d\u963f\u91cc\u4e91\u4e0a\u63d0\u4f9b\u7684 MSE \u4e91\u539f\u751f\u7f51\u5173**\uff0c\u4e00\u65b9\u9762\u9762\u5411\u5e7f\u5927\u7684\u516c\u6709\u4e91\u7528\u6237\u63d0\u4f9b\u6258\u7ba1\u7684\u7f51\u5173\u670d\u52a1\uff0c\u53e6\u4e00\u65b9\u9762\u4e5f\u5bf9\u5185\u670d\u52a1\u96c6\u56e2\u3002MSE \u4e91\u539f\u751f\u7f51\u5173\u7684\u6280\u672f\u67b6\u6784\u7b80\u56fe\u5982\u4e0b\uff1a\\n\\n![image.png](https://img.alicdn.com/imgextra/i1/O1CN01jCUMA11It93SO68gE_!!6000000000950-2-tps-1570-1262.png)\\n# Higress (2021.11~2022.11)\\n\u968f\u7740Higress\u6210\u4e3a\u4e91\u4ea7\u54c1\u670d\u52a1\u4e8e\u66f4\u591a\u5916\u90e8\u7528\u6237\uff0c\u6211\u4eec\u9010\u6b65\u53d1\u73b0\u7528\u6237\u5bf9Higress\u63d0\u51fa\u4e86\u66f4\u9ad8\u7684\u8981\u6c42\uff0c\u5176\u4e2d\u53cd\u9988\u8f83\u591a\u7684\u5927\u7684\u9700\u6c42\u70b9\u662f\u63d2\u4ef6\u6269\u5c55\u3001Waf\u9632\u62a4\u3001\u591a\u6ce8\u518c\u4e2d\u5fc3\u3001Nginx Ingress\u6ce8\u89e3\u517c\u5bb9\u4ee5\u53caHTTP\u8f6cDubbo\u534f\u8bae\uff0c\u5f53\u7136\u4e5f\u6709\u5f88\u591a\u5c0f\u7684\u9700\u6c42\u70b9\u5728\u6b64\u5c31\u4e0d\u4e00\u4e00\u5217\u51fa\uff0c\u56e0\u6b64\u8be5\u9636\u6bb5\u6211\u4eec\u91cd\u70b9\u53d1\u529b\u5728\u4e0a\u8ff0\u7528\u6237\u53cd\u9988\u7684\u9ad8\u9891\u9700\u6c42\u3002\\n\\nHigress \u63d0\u4f9b\u7684\u63d2\u4ef6\u5e02\u573a\uff0c\u5176\u4e00\u9636\u6bb5\u652f\u6301Wasm\u63d2\u4ef6\uff0c\u6ee1\u8db3\u8ffd\u6c42\u9ad8\u6027\u80fd\u3001\u9ad8\u5b89\u5168\u7684\u7528\u6237\u5bf9\u7f51\u5173\u7684\u6269\u5c55\u8bc9\u6c42\uff0c\u4e8c\u9636\u6bb5\u4f1a\u652f\u6301Lua\u63d2\u4ef6\uff0c\u6ee1\u8db3\u4f20\u7edf\u7528\u6237\u4f7f\u7528Lua\u7684\u6269\u5c55\u7684\u8bc9\u6c42\uff0c\u5982Nginx\u7528\u6237\uff0c\u4e09\u9636\u6bb5\u4f1a\u652f\u6301\u8fdb\u7a0b\u5916\u63d2\u4ef6\uff0c\u6ee1\u8db3\u591a\u8bed\u8a00\u7528\u6237\u8bc9\u6c42\uff0c\u5c24\u5176\u662fJava\u7528\u6237\u56e0\u73b0\u9636\u6bb5Java\u793e\u533a\u5bf9WebAssembly\u652f\u6301\u5c1a\u4e0d\u5b8c\u5584\u4f46\u53c8\u5e0c\u671b\u5bf9\u7f51\u5173\u8fdb\u884c\u6269\u5c55\u7684\u8bc9\u6c42\u3002\\n\\n![image.png](https://img.alicdn.com/imgextra/i3/O1CN01j4BOm725DO7A6PdWS_!!6000000007492-2-tps-1424-1282.png)\\n\\nHigress \u4e5f\u652f\u6301\u4e86Nginx Ingress\u6ce8\u89e3\u5e73\u6ed1\u8fc1\u79fb\u7684\u80fd\u529b\uff0c\u6ee1\u8db3\u90e8\u5206\u7528\u6237\u671f\u671b\u8fc1\u79fb\u5230Higress\u4f46\u53c8\u4e0d\u5e0c\u671b\u91cd\u65b0\u914d\u7f6e\u7f51\u5173\u7684\u8bc9\u6c42\uff0c\u540c\u65f6**Higress\u6253\u7834\u4e86Nginx Ingress\u53ea\u80fd\u5173\u8054\u5355\u4e2aK8s\u96c6\u7fa4\u7684\u9650\u5236\uff0c\u652f\u6301\u5173\u8054\u591a\u4e2aK8s\u96c6\u7fa4\uff0c\u5373\u53ef\u4ee5\u5c06Higress\u4f5c\u4e3a\u7edf\u4e00\u63a5\u5165\u7f51\u5173\u4f7f\u7528\uff0c\u540c\u65f6\u53c8\u53ef\u4ee5\u4eab\u53d7Ingress\u7684\u7ea2\u5229**\u3002\\n\\n![image.png](https://img.alicdn.com/imgextra/i2/O1CN01M65eMf1PZB6HdQsOt_!!6000000001854-2-tps-2480-1126.png)\\n\\n\u5bf9\u4e8e\u4f20\u7edf\u4f7f\u7528Dubbo\u7684\u5fae\u670d\u52a1\u7528\u6237\u5e0c\u671b\u4f7f\u7528\u539f\u751fRPC\u65b9\u5f0f\u66b4\u9732\u5bf9\u5916\u670d\u52a1\uff0c\u4f46\u901a\u5e38\u63d0\u4f9b\u5916\u90e8\u8bbf\u95ee\u7684\u670d\u52a1\u4ee5\u4f7f\u7528HTTP\u4e3a\u4e3b\uff0c\u4e3a\u4e86\u5e2e\u52a9Dubbo\u7528\u6237\u964d\u4f4e\u670d\u52a1\u66b4\u9732\u7684\u5f00\u53d1\u6210\u672c\uff0cHigress\u63d0\u4f9b\u4e86HTTP\u8f6cDubbo\u534f\u8bae\u529f\u80fd\uff0c\u4e14\u901a\u8fc7Console\u4e3a\u7528\u6237\u63d0\u4f9b\u767d\u5c4f\u5316\u7684\u914d\u7f6e\u65b9\u5f0f\uff0c**\u67d0\u5ba2\u6237\u4f7f\u7528\u540e\u53cd\u9988\u201c\u8fd9\u662f\u4e1a\u754c\u5b8c\u6210\u5ea6\u6700\u9ad8\u7684HTTP\u8f6cDubbo\u534f\u8bae\u201d\u529f\u80fd**\u3002\\n\\n![image.png](https://img.alicdn.com/imgextra/i3/O1CN013yp9rz202KTX6AkAa_!!6000000006791-2-tps-2356-1280.png)\\n\\n\u5728\u4e91\u539f\u751f\u7684\u6d6a\u6f6e\u4e0b\uff0c\u5f00\u6e90\u5df2\u7ecf\u6210\u4e3a\u8f6f\u4ef6\u53d1\u5c55\u7684\u5fc5\u7136\u8d8b\u52bf\u4e0e\u5feb\u901f\u8def\u5f84\uff0c\u56e0\u4e3a\u793e\u533a\u7684\u529b\u91cf\u662f\u975e\u5e38\u5f3a\u5927\u7684\u3002\u56e0\u6b64\u6211\u4eec\u5c06\\n\u8fd9\u5957\u7ecf\u8fc7\u5185\u90e8\u5b9e\u8df5\u6c89\u6dc0\u4e0b\u6765\u7684\u7f51\u5173\u65b9\u6848Higress\u6b63\u5f0f\u5bf9\u5916\u5f00\u6e90\uff0c\u4ee5Kubernetes Ingress\u7f51\u5173\u4e3a\u5951\u673a\u5e26\u6765\u4e86\u6d41\u91cf\u7f51\u5173\u4e0e\u5fae\u670d\u52a1\u7f51\u5173\u878d\u5408\u7684\u53ef\u80fd\u6027\uff0c\u7ed3\u5408\u963f\u91cc\u5185\u90e8\u5b9e\u8df5\u6c89\u6dc0Higress\u5b9e\u73b0\u4e86\u6d41\u91cf\u7f51\u5173 + \u5fae\u670d\u52a1\u7f51\u5173 + \u5b89\u5168\u7f51\u5173\u4e09\u5408\u4e00\u7684\u9ad8\u96c6\u6210\u80fd\u529b\uff0c\u540c\u65f6\u6df1\u5ea6\u96c6\u6210\u4e86Dubbo\u3001Nacos\u3001Sentinel\u7b49\uff0c\u80fd\u591f\u5e2e\u52a9\u7528\u6237\u6781\u5927\u7684\u964d\u4f4e\u7f51\u5173\u7684\u90e8\u7f72\u53ca\u8fd0\u7ef4\u6210\u672c\uff0c\u800c\u4e14\u80fd\u529b\u4e0d\u6253\u6298\u3002\\n\\n![image.png](https://img.alicdn.com/imgextra/i2/O1CN01ad1fKt1toEafyw0GN_!!6000000005948-2-tps-1734-1360.png)\\n# Higress \u672a\u6765\u5c55\u671b\\n\\n\u867d\u7136\u76ee\u524d\u4e91\u539f\u751f\u5df2\u7ecf\u6210\u4e3a\u5fc5\u7136\u8d8b\u52bf\uff0c\u4f46\u73b0\u5b9e\u662f\u6709\u5f88\u5927\u4e00\u90e8\u5206\u7528\u6237\u5904\u4e8e\u8fc1\u79fb\u4e0a\u4e91\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5728\u4ece\u4f20\u7edf\u67b6\u6784\u5411\u4ee5Kubernetes \u4e3a\u4ee3\u8868\u7684\u5bb9\u5668\u5316\u4e91\u539f\u751f\u67b6\u6784\u8fc1\u79fb\uff0c\u53ef\u9884\u89c1\u8fd9\u5728\u672a\u6765\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\u4f1a\u4e00\u76f4\u6301\u7eed\uff0c\u56e0\u6b64 Higress \u540e\u7eed\u4f1a\u91cd\u70b9\u652f\u6301\u975e Kubernetes \u90e8\u7f72\u67b6\u6784\uff0c\u4ee5 Higress + Nacos \u7684\u7ec4\u5408\u5f62\u5f0f\u4e3a\u7528\u6237\u63d0\u4f9b\u6700\u5c0f\u96c6\u8fd0\u884c\u73af\u5883\uff0c\u540c\u65f6\u6ee1\u8db3\u7528\u6237\u670d\u52a1\u6ce8\u518c\u3001\u914d\u7f6e\u7ba1\u7406\u3001\u5fae\u670d\u52a1\u6cbb\u7406\u7684\u8bc9\u6c42\u3002\\n\\n\u5728\u4ee5 Kubernetes \u4e3a\u4ee3\u8868\u7684\u5bb9\u5668\u5316\u4e91\u539f\u751f\u65b9\u5411\uff0c\u6211\u4eec\u5728\u517c\u5bb9\u597d\u73b0\u6709 Ingress \u6807\u51c6\u7684\u57fa\u7840\u4e0a\uff0c\u4f1a\u91cd\u70b9\u53d1\u529b\u4e0b\u4e00\u4ee3\u7684Ingress \u6807\u51c6 Gateway API\uff0c\u5229\u7528 Gateway API \u5e26\u6765\u7684\u5951\u673a\u6253\u901a\u5357\u5317\u5411\u4e0e\u4e1c\u897f\u5411\u7684\u5168\u57df\u6d41\u91cf\u8c03\u5ea6\uff0c\u5e2e\u52a9\u7528\u6237\u4f7f\u7528\u4e00\u5957\u67b6\u6784\u67b6\u6784\u540c\u65f6\u7ba1\u7406\u5916\u90e8\u4e0e\u5185\u90e8\u6d41\u91cf\uff0c\u964d\u4f4e\u90e8\u7f72\u8fd0\u7ef4\u6210\u672c\u3001\u63d0\u5347\u5f00\u53d1\u53ca\u8fd0\u7ef4\u6548\u7387\u3002"}]}')}}]);